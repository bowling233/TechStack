---
tags:
  - ä¸ªäººç¬”è®°
---

# ğŸ“’ æ•°æ®åº“ç¼–ç¨‹

## Java JDBC

### åŸºç¡€

SQL ç¨‹åºè®¾è®¡åº”å½“å…³æ³¨ API çš„ä»¥ä¸‹å‡ ç‚¹ï¼š

- è¿æ¥åˆ°æœåŠ¡å™¨ï¼Œé€‰æ‹©æ•°æ®åº“ï¼Œæ–­å¼€è¿æ¥

ä¸¤æ­¥ï¼Œåˆ†åˆ«æŒ‡å®š driverã€åˆå§‹åŒ–è¿æ¥å¹¶è·å¾— `Connection` å¯¹è±¡ã€‚

```java
Class.forName();
DriverManager.getConnection();
```

- æ£€æŸ¥é”™è¯¯

å‘ç”Ÿé”™è¯¯æ—¶ï¼ŒMySQL æä¾›ä¸‰ä¸ªå€¼ï¼šé”™è¯¯ç ã€æè¿°æ€§ä¿¡æ¯ã€äº”ä¸ªå­—ç¬¦çš„ SQLSTATEï¼ˆANSI ODBC æ ‡å‡†ï¼‰ã€‚

Java çš„å¼‚å¸¸å¤„ç†æ˜¯é€šè¿‡æ•è·å¼‚å¸¸å®ç°çš„ï¼Œæœ€åŸºæœ¬åœ°ä¼šæ‰“å° `printStackTrace()` æŒ‡æ˜é”™è¯¯çš„åœ°æ–¹ã€‚

`Exception` å¯¹è±¡å…·æœ‰ `getMessage()` æ–¹æ³•ã€‚JDBC æ–¹æ³•å¸¸æŠ›å‡º `SQLException` å¯¹è±¡ï¼Œæ”¯æŒ `getErrorCode()` å’Œ `getSQLState()` æ–¹æ³•ã€‚æŸäº›æ–¹æ³•äº§ç”Ÿ `SQLWarning` å¯¹è±¡ï¼Œç§¯ç´¯åœ¨ä¸€ä¸ªåˆ—è¡¨ä¸­ä¸ä¼šç«‹å³æŠ›å‡ºï¼Œå¯ä»¥é—²æ—¶æ‰“å°ã€‚

```java
try{

}
catch (Exception e)
{
    e.printStackTrace();
    catch (Exception e)
    {
      System.err.println ("Cannot connect to server");
      System.err.println (e);
      if (e instanceof SQLException)
      {
        printException ((SQLException) e);
      }
    }
}
public static void printException (SQLException e)
{
    System.err.println ("SQLException: " + e.getMessage ());
    System.err.println ("SQLState: " + e.getSQLState ());
    System.err.println ("Vendor code: " + e.getErrorCode ());
}
```

- æ‰§è¡Œ SQL è¯­å¥ï¼Œè·å¾—ç»“æœ

SQL è¯­å¥åˆ†ä¸ºä¸¤ç±»ï¼ŒJDBC ä½¿ç”¨ä¸åŒçš„è°ƒç”¨æ‰§è¡Œå®ƒä»¬ã€‚ä¸€ç±»è¿”å›å½±å“çš„è¡Œæ•° `int`ï¼Œä½¿ç”¨ `executeUpdate()`ï¼Œä¸€ç±»è¿”å›ç»“æœé›† `ResultSet`ï¼Œä½¿ç”¨ `executeQuery()`ã€‚ä½¿ç”¨åè®°å¾—å…³é—­è¯­å¥å’Œç»“æœé›†ã€‚

ç»“æœé›†ä¸€å¼€å§‹æŒ‡å‘ç¬¬ä¸€è¡Œçš„å‰ä¸€è¡Œï¼Œä½¿ç”¨ `next()` æ–¹æ³•ç›´åˆ°è¿”å›å‡ã€‚`getXXX()` æ¥å—åˆ—æŒ‡æ ‡æˆ–åˆ—åã€‚ä¹Ÿå¯ä»¥ç›´æ¥è·å–æ³›å‹çš„ `getObject()`ï¼Œåç»­å†è½¬æ¢ã€‚

ç»“æœé›†å…ƒæ•°æ® `ResultSetMetaData` ç±»å‹é€šè¿‡ `.getMetaData` è·å–ï¼Œå†ä½¿ç”¨ `.getColumnCount()` è·å¾—åˆ—æ•°ã€‚

```java
Statement s = conn.createStatment();
int count = s.executeUpdate();
s.close();
Statement s = conn.createStatment();
s.executeQuery();
ResultSet rs = s.getResultSet();
ResultSetMetaData md = rs.getMetaData();
int ncols = md.getColumnCount();
int count = 0;
while(rs.next())
{
    int id = rs.getInt(1); // column1
    String name = rs.getString(2); // column2
    //...
    ++count;
}
rs.close();
s.close();
```

- **å¤„ç†è¯­å¥ä¸­çš„ç‰¹æ®Šå­—ç¬¦å’Œ NULL å€¼**ï¼ˆå®‰å…¨é—®é¢˜ï¼‰
- è¾¨åˆ«ç»“æœä¸­çš„ç©ºå€¼

## Go
