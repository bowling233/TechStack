# 协议

不同的计算机**网络体系结构**使用不同的协议。如：TCP/IP体系使用：IP, ICMP, TCP, UDP, HTTP, TELNET 等协议。

* 计算机网络中最重要的一个协议是**分组交换协议**。它是什么？是如何工作的？
  * 包 Packet
  * 报文首部

## 协议分层

* 每一层接收**下一层提供的服务**
* 上下层交互的约定叫**接口**，相同层交互的约定叫**协议**

以下是 OSI 参考模型对协议的分层：

| 层级 | 名称       | 功能                                               |
| ---- | ---------- | -------------------------------------------------- |
| 7    | 应用层     | 具体应用                                           |
| 6    | 表示层     | 设备固有数据格式和**网络标准数据格式**的转换       |
| 5    | 会话层     | 管理通信，负责建立和断开通信连接                   |
| 4    | 传输层     | 管理传输，负责可靠传输                             |
| 3    | 网络层     | 管理地址，负责路由选择                             |
| 2    | 数据链路层 | 传送和识别数据帧，负责数据帧和比特流转换           |
| 1    | 物理层     | 界定连接器和网线的规格，负责比特流与电子信号的转换 |

### 7 层通信

* 一个数据包如何从一个计算机传输到一个计算机？
* 经过每个分层时数据发生了什么？

以下是几个数据单位：

* 包：全能性述语
* 帧：数据链路层
* 数据报：网络层（IP/UDP）以上
* 段：TCP流中的消息
* 消息：应用协议

### 传输方式

是否连接

* 面向有连接型
  * 需要建立通信线路
* 面向无连接型

交换类型

* 电路交换
  * 传输速度会变化吗？为什么？
* 分组交换、

接收端数量

* 单播 Unicast
* 广播（多播）：同一数据链路内
  * 实例：电视广播
* 组播 Multicast：特定组
  * 实例：电视会议
* 任播 Anycast：特定组任一台
  * 实例：DNS

### 地址

地址分层

* 分层地址：IP
  * 路由控制表
* 无分层地址：MAC
  * 地址转发表
* 



## TCP/IP 协议族

### 协议概览

**上面的层次由应用程序掌控**

路由控制协议

* RIP
* OSPF
* BGP

应用协议：会话层及以上

* HTTP
* SMTP
* FTP
* TELNET
* SNMP

**上面的层次由操作系统掌控**

传输协议

* TCP
* UDP

网际协议：互联网层

* [[IP]]
* ICMP
* ARP

**上面的层次由设备驱动程序和网络接口掌控**



### 发送一个数据包

数据|TCP首部|IP首部|以太网首部

每一层首部都包含：

* 发送端接收端地址
* **下一层**的协议类型

回忆一下

* 数据包发送过程
* 数据包接收过程
  * 网络接口处理
  * IP处理
  * TCP处理
  * 应用程序处理

## 协议的标准化

* OSI (Open Systems Interconnection 开放式通信系统互联参考模型) 由 ISO 指定
* TCP/IP 协议由 IETF (Internet Engineering Task Force)  推进标准化
* RFC（Request For Comment 征求意见表）
  * RFC 编码是既定的。如果要扩展已有协议规范，必须建立新的编号。如果修改现有规范，必须废除原文档，并发布新文档。



