---
tags:
  - ä¸ªäººç¬”è®°
---

# ğŸ“’ å¼€å‘å·¥å…·

## æ„å»ºç³»ç»Ÿ

### CMake

!!! quote

    - [Modern CMake](https://cliutils.gitlab.io/modern-cmake/README.html)

#### CMake å‘½ä»¤è¡Œ

ä½¿ç”¨ï¼š

```shell
cmake -S . -B build
cmake --build build -j -v
cmake --install build
```

æŒ‡å®šç¼–è¯‘å™¨å’Œæ„å»ºç³»ç»Ÿï¼š

```shell
cmake --help
CC=clang CXX=clang++ ...
cmake -G"Ninja"
```

é€‰é¡¹ï¼š

```shell
# -L æ˜¾ç¤ºæ‰€æœ‰å˜é‡ï¼Œ-H æ˜¾ç¤ºå¸®åŠ©
cmake -LH
cmake -D...
# æ ‡å‡†é€‰é¡¹
-DCMAKE_BUILD_TYPE=Release|Debug|RelWithDebInfo
-DCMAKE_INSTALL_PREFIX=...
-DBUILD_SHARED_LIBS=ON|OFF
-DBUILD_TESTING=
```

#### CMake é¡¹ç›®ç»“æ„

```text
project
â”œâ”€â”€ CMakeLists.txt
â”œâ”€â”€ cmake
â”‚   â””â”€â”€ FindXXX.cmake
â”œâ”€â”€ include
â”‚   â””â”€â”€ project
â”‚       â””â”€â”€ lib.hpp
â”œâ”€â”€ src
â”‚   â”œâ”€â”€ lib.cpp
â”‚   â””â”€â”€ CMakeLists.txt
â”œâ”€â”€ apps
â”‚   â”œâ”€â”€ app.cpp
â”‚   â””â”€â”€ CMakeLists.txt
â”œâ”€â”€ docs
â”‚   â””â”€â”€ CMakeLists.txt
â”œâ”€â”€ extern
â””â”€â”€ tests
    â”œâ”€â”€ testlib.cpp
    â””â”€â”€ CMakeLists.txt
```

- ä¸ºäº†èƒ½å°† `include` æ‹·è´è‡³ `/usr/include` ç­‰å®‰è£…ç›®å½•ï¼Œå…¶ä¸­ä¸åº”å½“å«æœ‰ `CMakeLists.txt`ï¼Œä¸”åº”å½“åˆ›å»ºä¸€å±‚é¡¹ç›®çš„å­ç›®å½• `project`ã€‚
- `CMakeLists.txt` åˆ†æ•£åˆ°å„ä¸ªå­ç›®å½•ï¼Œä½¿ç”¨ `add_subdirectory` å¼•å…¥ã€‚
- ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤å¼•å…¥ `cmake` ç›®å½•ä¸‹çš„ç»„ä»¶ï¼š

```cmake
set(CMAKE_MODULE_PATH "${PROJECT_SOURCE_DIR}/cmake" ${CMAKE_MODULE_PATH})
```

#### CMake åŸºæœ¬è¯­æ³•

```cmake
cmake_minimum_required(VERSION 4.0.0)

project(MyProject VERSION 1.0
                  DESCRIPTION "Very nice project"
                  LANGUAGES CXX)
# è¯­è¨€åŒ…æ‹¬ Cã€CXXã€Fortranã€ASMã€CUDA

add_executable(one two.cpp three.h)
# æ™ºèƒ½è¯†åˆ«æºæ–‡ä»¶ï¼Œå¤´æ–‡ä»¶ä¸€èˆ¬ç”¨äº IDE æç¤º

add_library(one STATIC two.cpp three.h)
# ä¸æŒ‡å®šåˆ™ç”± BUILD_SHARED_LIBS å†³å®š
# åªæœ‰å¤´æ–‡ä»¶çš„åº“ï¼šINTERFACE

target_include_directories(one PUBLIC include)
# PUBLICï¼šé“¾æ¥åˆ°å½“å‰ target çš„
# PRIVATEï¼šä»…å½“å‰ target
# INTERFACEï¼šä¾èµ–å½“å‰ target çš„

add_library(another STATIC another.cpp another.h)
target_link_libraries(another PUBLIC one)
# æ·»åŠ ä¾èµ– target æˆ–ç³»ç»Ÿä¸­çš„åº“ï¼Œå¯ä½¿ç”¨ç»å¯¹è·¯å¾„ã€é“¾æ¥å™¨é€‰é¡¹

set(MY_VARIABLE "value")
${MY_VARIABLE}
# æœ¬åœ°å˜é‡å…·æœ‰ä½œç”¨åŸŸï¼Œé™„åŠ  PARENT_SCOPE å¯ä»¥ä¼ é€’åˆ°çˆ¶ä½œç”¨åŸŸ
$ENV{MY_ENV_VARIABLE}
# ç¯å¢ƒå˜é‡
set(MY_CACHE_VARIABLE "VALUE" CACHE STRING "Description")
set(MY_CACHE_VARIABLE "VALUE" CACHE STRING "" FORCE)
# ç¼“å­˜å˜é‡ï¼Œä¸è¦†ç›–ä¸è¦†ç›–
set(MY_LIST "one" "two")
# åˆ—è¡¨æ“ä½œ
option(MY_OPTION "This is settable from the command line" OFF)
# å¸ƒå°”é€‰é¡¹

mark_as_advanced(MY_CACHE_VARIABLE)
# é«˜çº§é€‰é¡¹ï¼Œåœ¨ cmake -L ä¸­éšè—

set_property(TARGET TargetName
             PROPERTY CXX_STANDARD 11)
set_target_properties(TargetName PROPERTIES
                      CXX_STANDARD 11)
get_property(ResultVariable TARGET TargetName PROPERTY CXX_STANDARD)

if(variable)
else()
endif()
```

Targetï¼š

- åœ¨ IDE ä¸­ Target ä¸€èˆ¬æ˜¾ç¤ºä¸ºæ–‡ä»¶å¤¹ã€‚
- **åŒ…å«ä¸‹åˆ—å†…å®¹ï¼š**include directories, linked libraries (or linked targets), compile options, compile definitions, compile features, and more.

å˜é‡ï¼š

- æœ¬åœ°å˜é‡
- ç¼“å­˜å˜é‡ï¼šä¼šåœ¨ `CMakeCache.txt` ä¸­ä¿å­˜ï¼Œä¸ç”¨æ¯æ¬¡éƒ½é‡æ–°è®¾ç½®
- ç¯å¢ƒå˜é‡

å±æ€§ï¼šä¸å˜é‡ç±»ä¼¼ï¼Œä½†æ˜¯é™„åŠ åˆ°æŸäº›å¯¹è±¡ä¸Šï¼Œå¦‚ target æˆ–ç›®å½•ã€‚å¾ˆå¤šå±æ€§ä»å¯¹åº”çš„ `CMAKE_` å˜é‡åˆå§‹åŒ–è€Œæ¥ï¼Œæ¯”å¦‚ï¼š`CMAKE_CXX_STANDARD` -> `CXX_STANDARD`ã€‚

#### `CMAKE_BUILD_TYPE`

!!! quote

    - [cmake-buildsystem(7)](https://cmake.org/cmake/help/latest/manual/cmake-buildsystem.7.html#build-configurations)
    - [cmake - What are CMAKE_BUILD_TYPE: Debug, Release, RelWithDebInfo and MinSizeRel? - Stack Overflow](https://stackoverflow.com/questions/48754619/what-are-cmake-build-type-debug-release-relwithdebinfo-and-minsizerel)

è¯¥å˜é‡æœ‰å¯èƒ½å½±å“ç¨‹åºè¡Œä¸ºã€‚æˆ‘å¤šæ¬¡é‡åˆ° `Release` å’Œ `Debug` ä¸¤ç§æ¨¡å¼ä¸‹ç¨‹åºè¡Œä¸ºä¸ä¸€è‡´çš„æƒ…å†µã€‚

CMake æ–‡æ¡£å¹¶æ²¡æœ‰å¯¹ `CMAKE_BUILD_TYPE` çš„è¡Œä¸ºè¿›è¡Œæ˜ç¡®è¯´æ˜ï¼Œå› ä¸ºè¿™æ˜¯ç”±ç¼–è¯‘å™¨å’Œæ„å»ºç³»ç»Ÿå†³å®šçš„ã€‚åœ¨ `CMakeCache.txt` ä¸­å¯ä»¥æ‰¾åˆ°å¯¹äºä¸åŒ `CMAKE_BUILD_TYPE` çš„ç¼–è¯‘å™¨é€‰é¡¹ `CMAKE_<LANG>_FLAGS_<CONFIG>`ã€‚

```shell
grep '_FLAGS' CMakeCache.txt | grep -v -E '/|INTERNAL'
```

## æ€§èƒ½

HPC ä¸­çš„æ€§èƒ½åˆ†æå·¥å…·è§ï¼š[HPC Wiki](https://hpcwiki.io/)ï¼ŒåŒ…æ‹¬ï¼šIntelã€AMDã€NVIDIA çš„ Profilersã€‚

## [Valgrind](https://valgrind.org/)

## AI è¾…åŠ©å¼€å‘

ç»¼è¿°ï¼š[The 70% problem: Hard truths about AI-assisted coding](https://addyo.substack.com/p/the-70-problem-hard-truths-about)
