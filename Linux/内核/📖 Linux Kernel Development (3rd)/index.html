
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Bowling çš„ç¬”è®°æœ¬">
      
      
        <meta name="author" content="Bowling">
      
      
        <link rel="canonical" href="https://note.bowling233.top/Linux/%E5%86%85%E6%A0%B8/%F0%9F%93%96%20Linux%20Kernel%20Development%20%283rd%29/">
      
      
        <link rel="prev" href="../%F0%9F%93%96%20Linux%20Device%20Drivers%20%283rd%29/">
      
      
        <link rel="next" href="../../%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/">
      
      
      <link rel="icon" href="../../../assets/bowling.svg">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.17">
    
    
      
        <title>ğŸ“– Linux Kernel Development (3rd) - Bowling's TechStack</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.bcfcd587.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../../stylesheets/flink.css">
    
      <link rel="stylesheet" href="../../../stylesheets/neoteroi-mkdocs.css">
    
      <link rel="stylesheet" href="../../../stylesheets/custom.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-webfont@1.1.0/style.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-lite-webfont@1.1.0/style.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-tc-webfont@1.0.0/style.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-screen-webfont@1.1.0/style.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#linux-kernel-development-3rd" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Bowling&#39;s TechStack" class="md-header__button md-logo" aria-label="Bowling's TechStack" data-md-component="logo">
      
  <img src="../../../assets/bowling.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Bowling's TechStack
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ğŸ“– Linux Kernel Development (3rd)
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/bowling233/TechStack" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    TechStack
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  é¦–é¡µ

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../links/" class="md-tabs__link">
        
  
    
  
  å‹é“¾

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
    
  
  Linux

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E5%85%B6%E4%BB%96/%E6%94%B6%E8%97%8F%E5%A4%B9/" class="md-tabs__link">
          
  
    
  
  å…¶ä»–

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/LLM%20Infra/" class="md-tabs__link">
          
  
    
  
  åº”ç”¨é¢†åŸŸ

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E7%A7%91%E7%A0%94/%E8%8D%89%E7%A8%BF/" class="md-tabs__link">
          
  
    
  
  ç§‘ç ”

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E7%AE%97%E6%B3%95/%F0%9F%8F%AB%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%9F%BA%E7%A1%80/" class="md-tabs__link">
          
  
    
  
  ç®—æ³•

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/" class="md-tabs__link">
          
  
    
  
  ç³»ç»Ÿå’Œä½“ç³»ç»“æ„

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E7%BD%91%E7%BB%9C/%F0%9F%93%92%20%E4%BB%A3%E7%90%86%E4%B8%8E%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E7%BD%91/" class="md-tabs__link">
          
  
    
  
  ç½‘ç»œ

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E8%8D%89%E7%A8%BF/" class="md-tabs__link">
          
  
    
  
  è‰ç¨¿

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E8%AF%AD%E8%A8%80/go/" class="md-tabs__link">
          
  
    
  
  è¯­è¨€

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E9%AB%98%E6%80%A7%E8%83%BD/%E5%B9%B6%E8%A1%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/C%2B%2B%20%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" class="md-tabs__link">
          
  
    
  
  é«˜æ€§èƒ½

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Bowling&#39;s TechStack" class="md-nav__button md-logo" aria-label="Bowling's TechStack" data-md-component="logo">
      
  <img src="../../../assets/bowling.svg" alt="logo">

    </a>
    Bowling's TechStack
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/bowling233/TechStack" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    TechStack
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    é¦–é¡µ
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../links/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å‹é“¾
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Linux
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Linux
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%8F%91%E8%A1%8C%E7%89%88%E4%B8%8E%E5%8C%85%E7%AE%A1%E7%90%86/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å‘è¡Œç‰ˆä¸åŒ…ç®¡ç†
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%90%AF%E5%8A%A8%E8%BF%87%E7%A8%8B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å¯åŠ¨è¿‡ç¨‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" checked>
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    å†…æ ¸
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            å†…æ ¸
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%F0%9F%93%96%20Linux%20Device%20Drivers%20%283rd%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– Linux Device Drivers (3rd)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    ğŸ“– Linux Kernel Development (3rd)
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    ğŸ“– Linux Kernel Development (3rd)
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬ 3 ç« ï¼šè¿›ç¨‹ç®¡ç†
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬ 3 ç« ï¼šè¿›ç¨‹ç®¡ç†">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#task" class="md-nav__link">
    <span class="md-ellipsis">
      è¿›ç¨‹æè¿°ç¬¦å’Œ task ç»“æ„
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      è¿›ç¨‹åˆ›å»º
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux" class="md-nav__link">
    <span class="md-ellipsis">
      Linux çš„çº¿ç¨‹å®ç°
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      è¿›ç¨‹ç»ˆæ­¢
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬ 4 ç« ï¼šè¿›ç¨‹è°ƒåº¦
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬ 4 ç« ï¼šè¿›ç¨‹è°ƒåº¦">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      å¤šä»»åŠ¡
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux_1" class="md-nav__link">
    <span class="md-ellipsis">
      Linux è¿›ç¨‹è°ƒåº¦å™¨
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      ç­–ç•¥
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux_2" class="md-nav__link">
    <span class="md-ellipsis">
      Linux è°ƒåº¦ç®—æ³•
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Linux è°ƒåº¦ç®—æ³•">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fair-scheduling" class="md-nav__link">
    <span class="md-ellipsis">
      Fair Scheduling
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux_3" class="md-nav__link">
    <span class="md-ellipsis">
      Linux è°ƒåº¦å®ç°
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preemption-and-context-switching" class="md-nav__link">
    <span class="md-ellipsis">
      Preemption and Context Switching
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#real-time-scheduling-policies" class="md-nav__link">
    <span class="md-ellipsis">
      Real-Time Scheduling Policies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scheduler-related-system-calls" class="md-nav__link">
    <span class="md-ellipsis">
      Scheduler-Related System Calls
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬ 7 ç« ï¼šä¸­æ–­å’Œä¸­æ–­å¤„ç†
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬ 7 ç« ï¼šä¸­æ–­å’Œä¸­æ–­å¤„ç†">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      åŸºæœ¬æ¦‚å¿µ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      å†™ä¸€ä¸ªä¸­æ–­å¤„ç†ç¨‹åº
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rtc" class="md-nav__link">
    <span class="md-ellipsis">
      ä¾‹å­ï¼šRTC ä¸­æ–­ç¨‹åº
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      ä¸­æ–­ä¸Šä¸‹æ–‡
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      å®ç°ä¸­æ–­å¤„ç†ç¨‹åº
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      ä¸­æ–­æ§åˆ¶
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      æ‚é¡¹
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬ 8 ç« ï¼šä¸‹åŠå’Œå»¶è¿Ÿå·¥ä½œ
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#undone-chapter-11-timers-and-time-management" class="md-nav__link">
    <span class="md-ellipsis">
      [undone] Chapter 11: Timers and Time Management
    </span>
  </a>
  
    <nav class="md-nav" aria-label="[undone] Chapter 11: Timers and Time Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kernel-notino-of-time" class="md-nav__link">
    <span class="md-ellipsis">
      Kernel Notino of Time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-tick-rate-hz" class="md-nav__link">
    <span class="md-ellipsis">
      The Tick Rate: HZ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jiffies" class="md-nav__link">
    <span class="md-ellipsis">
      Jiffies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hardware-clocks-and-timers" class="md-nav__link">
    <span class="md-ellipsis">
      Hardware Clocks and Timers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-timer-interrupt-handler" class="md-nav__link">
    <span class="md-ellipsis">
      The Timer Interrupt Handler
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-time-of-day" class="md-nav__link">
    <span class="md-ellipsis">
      The Time of Day
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timers" class="md-nav__link">
    <span class="md-ellipsis">
      Timers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delaying-execution" class="md-nav__link">
    <span class="md-ellipsis">
      Delaying Execution
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬ 12 ç« ï¼šå†…å­˜ç®¡ç†
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬ 12 ç« ï¼šå†…å­˜ç®¡ç†">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      å†…å­˜åŸºæœ¬æ¦‚å¿µ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slab" class="md-nav__link">
    <span class="md-ellipsis">
      Slab å±‚
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      æ ˆä¸Šçš„é™æ€åˆ†é…
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      é«˜å†…å­˜æ˜ å°„
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cpu" class="md-nav__link">
    <span class="md-ellipsis">
      é€ CPU åˆ†é…
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      å†…å­˜åˆ†é…æ€»ç»“
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#15" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬ 15 ç« ï¼šè¿›ç¨‹åœ°å€ç©ºé—´
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬ 15 ç« ï¼šè¿›ç¨‹åœ°å€ç©ºé—´">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      åœ°å€ç©ºé—´
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      å†…å­˜æè¿°ç¬¦
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vma" class="md-nav__link">
    <span class="md-ellipsis">
      VMA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      å†…å­˜åŒºåŸŸåˆ—è¡¨å’Œæ ‘
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      æ“ä½œå†…å­˜åŒºåŸŸ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      é¡µè¡¨
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#16" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬ 16 ç« ï¼šé¡µç¼“å­˜å’Œé¡µå†™å›
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    æ–‡ä»¶ç³»ç»Ÿ
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_5" id="__nav_3_5_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            æ–‡ä»¶ç³»ç»Ÿ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/%F0%9F%93%92%20%E5%86%85%E6%A0%B8%E6%BA%90%E7%A0%81%EF%BC%9ANFS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ å†…æ ¸æºç ï¼šNFS
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    æºç ç¬”è®°
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            æºç ç¬”è®°
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%BA%90%E7%A0%81%E7%AC%94%E8%AE%B0/bonding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    drivers/net/bonding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%BA%90%E7%A0%81%E7%AC%94%E8%AE%B0/systemd-networkd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    systemd-networkd
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    å…¶ä»–
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            å…¶ä»–
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%E6%94%B6%E8%97%8F%E5%A4%B9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ”¶è—å¤¹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%E8%87%AA%E5%8A%A8%E5%8C%96/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    è‡ªåŠ¨åŒ–
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%F0%9F%93%92%20%E5%BF%AB%E6%8D%B7%E9%94%AE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ å¿«æ·é”®
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%F0%9F%93%92%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%BD%BF%E7%94%A8%E7%BB%8F%E9%AA%8C%E5%92%8C%E6%8A%80%E5%B7%A7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ æ“ä½œç³»ç»Ÿä½¿ç”¨ç»éªŒå’ŒæŠ€å·§
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%F0%9F%93%92%20%E8%BD%AF%E4%BB%B6%E4%BD%BF%E7%94%A8%E7%BB%8F%E9%AA%8C%E5%92%8C%E6%8A%80%E5%B7%A7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ è½¯ä»¶ä½¿ç”¨ç»éªŒå’ŒæŠ€å·§
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%F0%9F%93%92%20%E9%9D%A2%E7%BB%8F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ é¢ç»
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%F0%9F%93%96%20Vim%20%E5%AE%9E%E7%94%A8%E6%8A%80%E5%B7%A7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– Vim å®ç”¨æŠ€å·§
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%F0%9F%93%96%20%E4%BA%BA%E6%9C%88%E7%A5%9E%E8%AF%9D/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– äººæœˆç¥è¯
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%F0%9F%94%97%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B1%BB%E7%A7%91%E6%99%AE%E8%A7%86%E9%A2%91/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ”— è®¡ç®—æœºç±»ç§‘æ™®è§†é¢‘
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_10" >
        
          
          <label class="md-nav__link" for="__nav_4_10" id="__nav_4_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ç”Ÿæ´»
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_10">
            <span class="md-nav__icon md-icon"></span>
            ç”Ÿæ´»
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%E7%94%9F%E6%B4%BB/%E4%B8%AA%E4%BA%BA%E5%8F%91%E5%B1%95/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä¸ªäººå‘å±•
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%E7%94%9F%E6%B4%BB/%E6%81%8B%E7%88%B1%E3%80%81%E5%A9%9A%E5%A7%BB%E4%B8%8E%E5%AE%B6%E5%BA%AD/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ‹çˆ±ã€å©šå§»ä¸å®¶åº­
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%E7%94%9F%E6%B4%BB/%E6%9D%82%E4%BA%8B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ‚äº‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%E7%94%9F%E6%B4%BB/%E7%A4%BE%E4%BC%9A/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç¤¾ä¼š
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%E7%94%9F%E6%B4%BB/%F0%9F%93%96%20%E4%BA%B2%E5%AF%86%E5%85%B3%E7%B3%BB%EF%BC%88%E7%AC%AC%208%20%E7%89%88%EF%BC%89/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– äº²å¯†å…³ç³»ï¼ˆç¬¬ 8 ç‰ˆï¼‰
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%E7%94%9F%E6%B4%BB/%F0%9F%93%96%20%E4%BA%B2%E5%AF%86%E5%85%B3%E7%B3%BB%EF%BC%9A%E9%80%9A%E5%BE%80%E7%81%B5%E9%AD%82%E7%9A%84%E6%A1%A5%E6%A2%81/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– äº²å¯†å…³ç³»ï¼šé€šå¾€çµé­‚çš„æ¡¥æ¢
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%E7%94%9F%E6%B4%BB/%F0%9F%93%96%20%E5%88%BB%E6%84%8F%E7%BB%83%E4%B9%A0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– åˆ»æ„ç»ƒä¹ 
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%E7%94%9F%E6%B4%BB/%F0%9F%93%96%20%E5%8E%9F%E7%94%9F%E5%AE%B6%E5%BA%AD%C2%B7%E5%A9%9A%E6%81%8B%E7%89%88/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– åŸç”Ÿå®¶åº­Â·å©šæ‹ç‰ˆ
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_11" >
        
          
          <label class="md-nav__link" for="__nav_4_11" id="__nav_4_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    è¯¾ç¨‹ç¬”è®°
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_11">
            <span class="md-nav__icon md-icon"></span>
            è¯¾ç¨‹ç¬”è®°
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/%F0%9F%8F%AB%20%E9%A9%AC%E5%85%8B%E6%80%9D%E4%B8%BB%E4%B9%89%E5%8E%9F%E7%90%86%EF%BC%88H%EF%BC%89/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ« é©¬å…‹æ€ä¸»ä¹‰åŸç†ï¼ˆHï¼‰
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    åº”ç”¨é¢†åŸŸ
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            åº”ç”¨é¢†åŸŸ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    äººå·¥æ™ºèƒ½
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            äººå·¥æ™ºèƒ½
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/LLM%20Infra/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LLM Infra
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/%E4%B8%AA%E4%BA%BA%E7%AC%94%E8%AE%B0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ äººå·¥æ™ºèƒ½
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/%F0%9F%93%96%20Dive%20into%20Deep%20Learning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– Dive into Deep Learning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/%F0%9F%93%96%20PyTorch%20%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%AE%9E%E6%88%98/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– PyTorch æ·±åº¦å­¦ä¹ å®æˆ˜
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/%F0%9F%93%96%20%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– æ·±åº¦å­¦ä¹ 
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E6%95%B0%E6%8D%AE%E5%BA%93/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    æ•°æ®åº“
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            æ•°æ®åº“
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E6%95%B0%E6%8D%AE%E5%BA%93/%F0%9F%93%92%20ClickHouse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ClickHouse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E6%95%B0%E6%8D%AE%E5%BA%93/%F0%9F%93%92%20ElasticSearch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ ElasticSearch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E6%95%B0%E6%8D%AE%E5%BA%93/%F0%9F%93%92%20%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ æ•°æ®åº“ç¼–ç¨‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E6%95%B0%E6%8D%AE%E5%BA%93/%F0%9F%93%92%20%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%90%E7%BB%B4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ æ•°æ®åº“è¿ç»´
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E6%95%B0%E6%8D%AE%E5%BA%93/%F0%9F%93%96%20%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– æ•°æ®åº“ç³»ç»Ÿæ¦‚å¿µ
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ç§‘ç ”
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            ç§‘ç ”
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%A7%91%E7%A0%94/%E8%8D%89%E7%A8%BF/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    è‰ç¨¿
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%A7%91%E7%A0%94/%F0%9F%93%92%20%E7%A7%91%E7%A0%94%E5%86%99%E4%BD%9C/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ ç§‘ç ”å†™ä½œ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%A7%91%E7%A0%94/%F0%9F%93%92%20%E9%AB%98%E6%80%A7%E8%83%BD%E7%BD%91%E7%BB%9C/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ é«˜æ€§èƒ½ç½‘ç»œ
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ç®—æ³•
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            ç®—æ³•
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%AE%97%E6%B3%95/%F0%9F%8F%AB%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%9F%BA%E7%A1%80/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ« æ•°æ®ç»“æ„åŸºç¡€
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    ç³»ç»Ÿå’Œä½“ç³»ç»“æ„
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8" id="__nav_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            ç³»ç»Ÿå’Œä½“ç³»ç»“æ„
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/ISA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ISA
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/%E6%95%B0%E5%AD%97%E7%94%B5%E8%B7%AF/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ•°å­—ç”µè·¯
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/%F0%9F%93%92%20%E5%AE%B9%E5%99%A8%E5%92%8C%E8%99%9A%E6%8B%9F%E5%8C%96%E6%8A%80%E6%9C%AF/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ å®¹å™¨å’Œè™šæ‹ŸåŒ–æŠ€æœ¯
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/%F0%9F%93%96%20%E6%80%BB%E7%BA%BF/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– æ€»çº¿
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/%F0%9F%93%96%20%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ç½‘ç»œ
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            ç½‘ç»œ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%BD%91%E7%BB%9C/%F0%9F%93%92%20%E4%BB%A3%E7%90%86%E4%B8%8E%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E7%BD%91/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ ä»£ç†ä¸è™šæ‹Ÿä¸“ç”¨ç½‘
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%BD%91%E7%BB%9C/%F0%9F%93%92%20%E7%89%A9%E7%90%86%E5%92%8C%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ ç‰©ç†å’Œæ•°æ®é“¾è·¯å±‚
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%BD%91%E7%BB%9C/%F0%9F%93%92%20%E7%BD%91%E7%BB%9C%E7%AC%94%E8%AE%B0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ ç½‘ç»œç¬”è®°
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%BD%91%E7%BB%9C/%F0%9F%93%96%20Head%20First%20HTML/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– Head First HTML
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%BD%91%E7%BB%9C/%F0%9F%93%96%20%E5%9B%BE%E8%A7%A3%20HTTP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– å›¾è§£ HTTP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%BD%91%E7%BB%9C/%F0%9F%93%96%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%EF%BC%9A%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B%E6%96%B9%E6%B3%95/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– è®¡ç®—æœºç½‘ç»œï¼šè‡ªé¡¶å‘ä¸‹æ–¹æ³•
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_10" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../%E8%8D%89%E7%A8%BF/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    è‰ç¨¿
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_10" id="__nav_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            è‰ç¨¿
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%8D%89%E7%A8%BF/ZFS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ZFS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%8D%89%E7%A8%BF/draft/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    é›¶æ•£ç¬”è®°
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%8D%89%E7%A8%BF/lvm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logical Volume Manager
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%8D%89%E7%A8%BF/%E5%88%86%E5%B8%83%E5%BC%8F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%8D%89%E7%A8%BF/%F0%9F%93%92%20%E4%B8%B4%E6%97%B6%E7%AC%94%E8%AE%B0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ ä¸´æ—¶ç¬”è®°
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_10_7" >
        
          
          <label class="md-nav__link" for="__nav_10_7" id="__nav_10_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    HPC
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_7">
            <span class="md-nav__icon md-icon"></span>
            HPC
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%8D%89%E7%A8%BF/HPC/%F0%9F%93%92%20%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ æ€§èƒ½åˆ†æ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%8D%89%E7%A8%BF/HPC/%F0%9F%93%92%20%E8%AE%BF%E5%AD%98%E4%BC%98%E5%8C%96/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ è®¿å­˜ä¼˜åŒ–
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_10_7_3" >
        
          
          <label class="md-nav__link" for="__nav_10_7_3" id="__nav_10_7_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    å·¥å…·
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_10_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_7_3">
            <span class="md-nav__icon md-icon"></span>
            å·¥å…·
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%8D%89%E7%A8%BF/HPC/%E5%B7%A5%E5%85%B7/spack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%8D%89%E7%A8%BF/HPC/%E5%B7%A5%E5%85%B7/%E7%BC%96%E8%AF%91%E5%A5%97%E4%BB%B6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç¼–è¯‘å¥—ä»¶
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_10_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../%E8%8D%89%E7%A8%BF/RFC/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    RFC
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_10_8" id="__nav_10_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_8">
            <span class="md-nav__icon md-icon"></span>
            RFC
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%8D%89%E7%A8%BF/RFC/4506%20XDR/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RFC 4506 - XDR: External Data Representation Standard
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%8D%89%E7%A8%BF/RFC/5531%20RPC/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RFC 5531 - RPC: Remote Procedure Call Protocol Specification Version 2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%8D%89%E7%A8%BF/RFC/5661%20NFSv4.1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RFC 5661 - Network File System (NFS) Version 4 Minor Version 1 Protocol
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%8D%89%E7%A8%BF/RFC/7530%20NFSv4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RFC 7530 - Network File System (NFS) Version 4 Protocol
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    è¯­è¨€
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            è¯­è¨€
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%AF%AD%E8%A8%80/go/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Go
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%AF%AD%E8%A8%80/%F0%9F%93%92%20C%20%E5%92%8C%20C%2B%2B%20%E9%AB%98%E7%BA%A7%E8%AF%9D%E9%A2%98/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ C å’Œ C++ é«˜çº§è¯é¢˜
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%AF%AD%E8%A8%80/%F0%9F%93%92%20%E4%BB%A3%E7%A0%81%E9%A3%8E%E6%A0%BC/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ ä»£ç é£æ ¼
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%AF%AD%E8%A8%80/%F0%9F%93%92%20%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ å¼€å‘å·¥å…·
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%AF%AD%E8%A8%80/%F0%9F%93%96%20C%2B%2B%20Primer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– C++ Primer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%AF%AD%E8%A8%80/%F0%9F%93%96%20%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– ç¼–è¯‘åŸç†
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    é«˜æ€§èƒ½
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            é«˜æ€§èƒ½
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_12_1" >
        
          
          <label class="md-nav__link" for="__nav_12_1" id="__nav_12_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    å¹¶è¡Œç¨‹åºè®¾è®¡
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_12_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12_1">
            <span class="md-nav__icon md-icon"></span>
            å¹¶è¡Œç¨‹åºè®¾è®¡
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%AB%98%E6%80%A7%E8%83%BD/%E5%B9%B6%E8%A1%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/C%2B%2B%20%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    C++ å¹¶å‘ç¼–ç¨‹
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬ 3 ç« ï¼šè¿›ç¨‹ç®¡ç†
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬ 3 ç« ï¼šè¿›ç¨‹ç®¡ç†">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#task" class="md-nav__link">
    <span class="md-ellipsis">
      è¿›ç¨‹æè¿°ç¬¦å’Œ task ç»“æ„
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      è¿›ç¨‹åˆ›å»º
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux" class="md-nav__link">
    <span class="md-ellipsis">
      Linux çš„çº¿ç¨‹å®ç°
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      è¿›ç¨‹ç»ˆæ­¢
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬ 4 ç« ï¼šè¿›ç¨‹è°ƒåº¦
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬ 4 ç« ï¼šè¿›ç¨‹è°ƒåº¦">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      å¤šä»»åŠ¡
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux_1" class="md-nav__link">
    <span class="md-ellipsis">
      Linux è¿›ç¨‹è°ƒåº¦å™¨
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      ç­–ç•¥
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux_2" class="md-nav__link">
    <span class="md-ellipsis">
      Linux è°ƒåº¦ç®—æ³•
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Linux è°ƒåº¦ç®—æ³•">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fair-scheduling" class="md-nav__link">
    <span class="md-ellipsis">
      Fair Scheduling
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux_3" class="md-nav__link">
    <span class="md-ellipsis">
      Linux è°ƒåº¦å®ç°
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preemption-and-context-switching" class="md-nav__link">
    <span class="md-ellipsis">
      Preemption and Context Switching
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#real-time-scheduling-policies" class="md-nav__link">
    <span class="md-ellipsis">
      Real-Time Scheduling Policies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scheduler-related-system-calls" class="md-nav__link">
    <span class="md-ellipsis">
      Scheduler-Related System Calls
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬ 7 ç« ï¼šä¸­æ–­å’Œä¸­æ–­å¤„ç†
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬ 7 ç« ï¼šä¸­æ–­å’Œä¸­æ–­å¤„ç†">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      åŸºæœ¬æ¦‚å¿µ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      å†™ä¸€ä¸ªä¸­æ–­å¤„ç†ç¨‹åº
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rtc" class="md-nav__link">
    <span class="md-ellipsis">
      ä¾‹å­ï¼šRTC ä¸­æ–­ç¨‹åº
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      ä¸­æ–­ä¸Šä¸‹æ–‡
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      å®ç°ä¸­æ–­å¤„ç†ç¨‹åº
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      ä¸­æ–­æ§åˆ¶
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      æ‚é¡¹
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬ 8 ç« ï¼šä¸‹åŠå’Œå»¶è¿Ÿå·¥ä½œ
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#undone-chapter-11-timers-and-time-management" class="md-nav__link">
    <span class="md-ellipsis">
      [undone] Chapter 11: Timers and Time Management
    </span>
  </a>
  
    <nav class="md-nav" aria-label="[undone] Chapter 11: Timers and Time Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kernel-notino-of-time" class="md-nav__link">
    <span class="md-ellipsis">
      Kernel Notino of Time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-tick-rate-hz" class="md-nav__link">
    <span class="md-ellipsis">
      The Tick Rate: HZ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jiffies" class="md-nav__link">
    <span class="md-ellipsis">
      Jiffies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hardware-clocks-and-timers" class="md-nav__link">
    <span class="md-ellipsis">
      Hardware Clocks and Timers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-timer-interrupt-handler" class="md-nav__link">
    <span class="md-ellipsis">
      The Timer Interrupt Handler
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-time-of-day" class="md-nav__link">
    <span class="md-ellipsis">
      The Time of Day
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timers" class="md-nav__link">
    <span class="md-ellipsis">
      Timers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delaying-execution" class="md-nav__link">
    <span class="md-ellipsis">
      Delaying Execution
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬ 12 ç« ï¼šå†…å­˜ç®¡ç†
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬ 12 ç« ï¼šå†…å­˜ç®¡ç†">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      å†…å­˜åŸºæœ¬æ¦‚å¿µ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slab" class="md-nav__link">
    <span class="md-ellipsis">
      Slab å±‚
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      æ ˆä¸Šçš„é™æ€åˆ†é…
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      é«˜å†…å­˜æ˜ å°„
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cpu" class="md-nav__link">
    <span class="md-ellipsis">
      é€ CPU åˆ†é…
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      å†…å­˜åˆ†é…æ€»ç»“
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#15" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬ 15 ç« ï¼šè¿›ç¨‹åœ°å€ç©ºé—´
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬ 15 ç« ï¼šè¿›ç¨‹åœ°å€ç©ºé—´">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      åœ°å€ç©ºé—´
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      å†…å­˜æè¿°ç¬¦
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vma" class="md-nav__link">
    <span class="md-ellipsis">
      VMA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      å†…å­˜åŒºåŸŸåˆ—è¡¨å’Œæ ‘
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      æ“ä½œå†…å­˜åŒºåŸŸ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      é¡µè¡¨
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#16" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬ 16 ç« ï¼šé¡µç¼“å­˜å’Œé¡µå†™å›
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  
  
<nav class="md-tags" >
  
    
    
    
      <a href="../../../#" class="md-tag">è¯»ä¹¦ç¬”è®°</a>
    
  
    
    
    
      <a href="../../../#" class="md-tag">å®Œæˆ</a>
    
  
</nav>


  
    <a href="https://github.com/bowling233/TechStack/blob/master/docs/Linux/å†…æ ¸/ğŸ“– Linux Kernel Development (3rd).md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  


<h1 id="linux-kernel-development-3rd">ğŸ“– Linux Kernel Development (3rd)<a class="headerlink" href="#linux-kernel-development-3rd" title="Permanent link">&para;</a></h1>
<div class="admonition abstract">
<p class="admonition-title">Abstract</p>
<ul>
<li><strong>ä¸­æ–‡ç‰ˆï¼š</strong><a href="https://book.douban.com/subject/6097773/">Linux å†…æ ¸è®¾è®¡ä¸å®ç° (åŸä¹¦ç¬¬ 3 ç‰ˆ)</a></li>
<li><strong>è‹±æ–‡ç‰ˆï¼š</strong><a href="https://www.amazon.com/Linux-Kernel-Development-Robert-Love/dp/0672329468">Linux Kernel Development (3rd)</a></li>
</ul>
<p>æœ¬ä¹¦å‡ºç‰ˆäº 2010 å¹´ï¼ˆLinux 2 ç‰ˆæœ¬æ—¶æœŸï¼‰ï¼Œå…¶ä¸­è®¸å¤š<strong>ç»†èŠ‚</strong>åœ¨ç°åœ¨çš„ Linux å†…æ ¸ä¸­<strong>å·²ç»å‘ç”Ÿäº†å˜åŒ–</strong>ï¼Œä½†<strong>æ€»ä½“æ¶æ„å’Œè®¾è®¡æ€æƒ³ä»ç„¶é€‚ç”¨</strong>ã€‚</p>
</div>
<h2 id="3">ç¬¬ 3 ç« ï¼šè¿›ç¨‹ç®¡ç†<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<p>å‡ ä¸ªåŸºæœ¬æ¦‚å¿µï¼š</p>
<ul>
<li>è¿›ç¨‹ï¼šæ­£åœ¨è¿è¡Œçš„ç¨‹åºåŠå…¶èµ„æºã€‚Linux å†…éƒ¨å°†è¿›ç¨‹ç§°ä¸º taskã€‚</li>
<li>çº¿ç¨‹ï¼š<ul>
<li>Linux è°ƒåº¦çš„æœ€å°å•ä½ã€‚ä½†ä¸è¿›ç¨‹æ²¡æœ‰ä»€ä¹ˆä¸åŒï¼Œåœ¨ Linux ä¸­çº¿ç¨‹åªæ˜¯ä¸€ç§ç‰¹æ®Šçš„è¿›ç¨‹ã€‚</li>
<li>å…·æœ‰è‡ªå·±çš„ PCã€å¯„å­˜å™¨ã€æ ˆã€‚</li>
<li>åŒä¸€è¿›ç¨‹çš„çº¿ç¨‹é—´å…±äº«è™šæ‹Ÿå†…å­˜ã€‚</li>
</ul>
</li>
<li>ç”Ÿå‘½å‘¨æœŸï¼š</li>
</ul>
<pre class="mermaid"><code>graph TD
    A["fork(), create new process by duplicating"]
    B["exec(), create new address space and load new pogram"]
    C["exit(), terminate process and free resources"]
    D["wait4(), wait for child process to exit"]
    E["Parent"]
    F["Child"]

    E --&gt; A
    A --&gt; F
    F --&gt; B
    B --&gt; C
    A --&gt; D</code></pre>
<h3 id="task">è¿›ç¨‹æè¿°ç¬¦å’Œ task ç»“æ„<a class="headerlink" href="#task" title="Permanent link">&para;</a></h3>
<ul>
<li><code>struct task_struct</code><ul>
<li>åœ¨ 32 ä½ç³»ç»Ÿä¸Šçº¦å  1.7KBã€‚ç»„æˆä¸€ä¸ªç¯å½¢é“¾è¡¨ã€‚</li>
<li>2.6 ä»¥åä½¿ç”¨ slab allocator åŠ¨æ€åˆ†é…ã€‚</li>
</ul>
</li>
<li><code>struct thread_info</code><ul>
<li>2.6 ä»¥åï¼Œå–ä»£ <code>task_struct</code> æ”¾ç½®åœ¨æ ˆå°¾éƒ¨ã€‚</li>
<li><code>task</code> æˆå‘˜æŒ‡å‘ <code>task_struct</code>ã€‚</li>
</ul>
</li>
<li><code>pid_t</code> è¿›ç¨‹æè¿°ç¬¦ï¼Œé»˜è®¤å€¼ä¸º 32768ã€‚è§ <code>/proc/sys/kernel/pid_max</code>ã€‚</li>
<li><code>current</code> æŒ‡å‘å½“å‰è¿›ç¨‹çš„ <code>task_struct</code>ã€‚</li>
<li>äº”ç§è¿›ç¨‹çŠ¶æ€ï¼š<ul>
<li><code>TASK_RUNNING</code></li>
<li><code>TASK_INTERRUPTIBLE</code> ç¡çœ çŠ¶æ€ã€‚</li>
<li><code>TASK_UNINTERRUPTIBLE</code> ä¸å“åº”ä¿¡å·ã€‚è¯¥çŠ¶æ€æ˜¯ <code>ps</code> ä¸­ dread ä¸”æ— æ³•æ€æ­»çš„è¿›ç¨‹çš„æ¥æºã€‚å¸¸ç”¨äºä¸ä¸­æ–­çš„ç­‰å¾…ã€‚</li>
<li><code>__TASK_STOPPED</code></li>
<li><code>__TASK_TRACED</code></li>
</ul>
</li>
<li>
<p>è¿›ç¨‹çŠ¶æ€æ§åˆ¶ï¼š</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">set_task_state</span><span class="p">(</span><span class="n">task</span><span class="p">,</span><span class="w"> </span><span class="n">state</span><span class="p">);</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">set_current_state</span><span class="p">(</span><span class="n">state</span><span class="p">);</span>
</span></code></pre></div>
</li>
<li>
<p>è¿›ç¨‹æ ‘</p>
<ul>
<li><code>init_task</code> å­˜æ”¾ <code>init</code> è¿›ç¨‹çš„æè¿°ç¬¦ã€‚</li>
<li>
<p>ç›´æ¥è®¿é—®æˆå‘˜ï¼š</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">task_struct</span><span class="w"> </span><span class="o">*</span><span class="n">task</span><span class="p">;</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">task</span><span class="o">-&gt;</span><span class="n">parent</span><span class="p">;</span>
</span></code></pre></div>
</li>
<li>
<p>åŒ…è£…çš„å®ï¼š</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">next_task</span><span class="p">(</span><span class="n">task</span><span class="p">);</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">prev_task</span><span class="p">(</span><span class="n">task</span><span class="p">);</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="n">for_each_process</span><span class="p">(</span><span class="n">task</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
</span></code></pre></div>
</li>
</ul>
</li>
</ul>
<h3 id="_1">è¿›ç¨‹åˆ›å»º<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<p>å…¶ä»–æ“ä½œç³»ç»Ÿä¸€èˆ¬å®ç° spawn æœºåˆ¶åœ¨æ–°åœ°å€ç©ºé—´ä¸­åˆ›å»ºæ–°è¿›ç¨‹ï¼Œè€Œ Linux å°†å…¶æ‹†åˆ†ä¸ºä¸¤æ­¥ï¼š<code>fork()</code> å’Œ <code>exec()</code>ã€‚</p>
<ul>
<li>åœ¨ <code>fork()</code> åï¼Œæ•°æ®é‡‡ç”¨ copy-on-write æœºåˆ¶ã€‚å”¯ä¸€çš„å¼€é”€å°±æ˜¯é¡µè¡¨å’Œè¿›ç¨‹æè¿°ç¬¦ã€‚</li>
<li>å¦‚æœåœ¨ <code>fork()</code> åç«‹å³è°ƒç”¨ <code>exec()</code>ï¼Œåˆ™ä¸ä¼šå‘ç”Ÿæ•°æ®å¤åˆ¶ã€‚å› æ­¤ï¼Œ<code>do_fork()</code> ä¸­ï¼Œå¦‚æœ <code>copy_process()</code> æˆåŠŸè¿”å›ï¼Œå­è¿›ç¨‹ä¼˜å…ˆè¢«å”¤é†’è¿è¡Œã€‚</li>
</ul>
<p><code>fork()</code> çš„è°ƒç”¨é“¾ï¼š</p>
<pre class="mermaid"><code>graph TD
    A["fork()"]
    B["clone() system call"]
    C["do_fork()"]
    D["copy_process()"]
    E["dup_task_struct()"]
    F["copy_flags()"]
    G["alloc_pid()"]

    A --&gt; B
    B --&gt; C
    C --&gt; D
    D --&gt; E
    D --&gt; F
    D --&gt; G</code></pre>
<h3 id="linux">Linux çš„çº¿ç¨‹å®ç°<a class="headerlink" href="#linux" title="Permanent link">&para;</a></h3>
<p>å‘ <code>clone()</code> ä¼ é€’ç‰¹å®šçš„æ ‡å¿—å¯ä»¥åˆ›å»ºçº¿ç¨‹ï¼š</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">clone</span><span class="p">(</span><span class="n">CLONE_VM</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">CLONE_FS</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">CLONE_FILES</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">CLONE_SIGHAND</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</span></code></pre></div>
<p>åœ¨ <code>fork()</code> çš„é»˜è®¤è¡Œä¸ºï¼ˆ<code>clone(SIGCHLD, 0)</code>ï¼‰ä¹‹å¤–ï¼Œå…±äº«äº†åœ°å€ç©ºé—´ã€æ–‡ä»¶ç³»ç»Ÿèµ„æºã€æ–‡ä»¶æè¿°ç¬¦å’Œä¿¡å·å¤„ç†ã€‚</p>
<p>å†…æ ¸æœ‰äº›æ“ä½œéœ€è¦åœ¨åå°è¿›è¡Œï¼Œä½¿ç”¨<strong>å†…æ ¸çº¿ç¨‹</strong>ï¼Œè¿™ä¸æ™®é€šçš„è¿›ç¨‹çº¿ç¨‹ä¸åŒã€‚</p>
<ul>
<li>å®ƒè¿è¡Œåœ¨å†…æ ¸ç©ºé—´ï¼Œæ²¡æœ‰ä¸€ä¸ªåœ°å€ç©ºé—´ï¼ˆ<code>mm</code> æŒ‡é’ˆä¸º <code>NULL</code>ï¼‰ã€‚</li>
<li>ä½†æ˜¯å¯ä»¥è°ƒåº¦ï¼Œå¯ä»¥æŠ¢å ã€‚</li>
<li>ä½¿ç”¨ <code>ps -ef</code> å¯ä»¥çœ‹åˆ°å†…æ ¸çº¿ç¨‹ã€‚</li>
<li>å†…æ ¸çº¿ç¨‹éƒ½ä» <code>kthreadd</code> æ´¾ç”Ÿã€‚ä½¿ç”¨ <code>kthread_create()</code> åˆ›å»ºå†…æ ¸çº¿ç¨‹ã€‚</li>
</ul>
<h3 id="_2">è¿›ç¨‹ç»ˆæ­¢<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<p>ç¨‹åºé€šè¿‡ <code>exit()</code> ç³»ç»Ÿè°ƒç”¨ç»“æŸã€‚C ç¼–è¯‘å™¨åœ¨ <code>main()</code> ç»“æŸæ—¶è‡ªåŠ¨è°ƒç”¨ <code>exit()</code>ã€‚ç¨‹åºä¹Ÿå¯èƒ½å› ä¸ºæ— æ³•å¤„ç†ä¿¡å·è€Œç»ˆæ­¢ã€‚</p>
<p>ä¸è®ºä½•ç§å½¢å¼ï¼Œè¿›ç¨‹ç»“æŸçš„ä»»åŠ¡éƒ½é€šè¿‡ <code>do_exit()</code> å®Œæˆã€‚</p>
<p>è°ƒç”¨é“¾è§ä¹¦æœ¬ã€‚</p>
<ul>
<li>è¿›ç¨‹ç»“æŸçš„<strong>æ¸…é™¤å·¥ä½œ</strong>å’Œç§»é™¤è¿›ç¨‹æè¿°ç¬¦çš„å·¥ä½œæ˜¯åˆ†å¼€çš„ã€‚<code>do_exit()</code> åè¿›ç¨‹æè¿°ç¬¦è¿˜ä¿ç•™ï¼Œç”¨äºç»™çˆ¶è¿›ç¨‹è¿”å›é€€å‡ºçŠ¶æ€ç­‰ã€‚çˆ¶è¿›ç¨‹å¯ä»¥é€šçŸ¥å†…æ ¸ç§»é™¤è¿›ç¨‹æè¿°ç¬¦ã€‚<code>wait4()</code> ç³»ç»Ÿè°ƒç”¨é€šè¿‡ <code>release_task()</code> ç§»é™¤è¿›ç¨‹æè¿°ç¬¦ã€‚</li>
<li><code>do_exit()</code> è¿˜é€šè¿‡ <code>exit_notify()</code> è°ƒç”¨ <code>find_new_reaper()</code> ä¸ºå­è¿›ç¨‹å¯»æ‰¾æ–°çš„çˆ¶è¿›ç¨‹ã€‚é¦–å…ˆåœ¨ thread group ä¸­æ‰¾ï¼Œæ‰¾ä¸åˆ°å°±ç”¨ <code>init</code>ã€‚åœ¨å¯»æ‰¾æ–°çš„çˆ¶è¿›ç¨‹è¿™ä¸€æ–¹é¢ï¼Œ<code>exit_ptrace()</code> çš„å¤„ç†æ–¹å¼æœ‰ä¸€äº›ä¸åŒã€‚</li>
</ul>
<h2 id="4">ç¬¬ 4 ç« ï¼šè¿›ç¨‹è°ƒåº¦<a class="headerlink" href="#4" title="Permanent link">&para;</a></h2>
<p>æ—¶é—´ç‰‡ï¼ˆtimesliceï¼‰</p>
<h3 id="_3">å¤šä»»åŠ¡<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<ul>
<li>ååŒå¤šä»»åŠ¡ï¼ˆcooperative multitaskingï¼‰ï¼šè¿›ç¨‹ä¸»åŠ¨è®©å‡º CPUï¼Œé€šè¿‡è°ƒç”¨ <code>yield()</code> æˆ– <code>sleep()</code> ç­‰å‡½æ•°ã€‚è¿›ç¨‹ä¸»åŠ¨æš‚åœè‡ªå·±çš„è¡Œä¸ºç§°ä¸º yieldã€‚</li>
<li>æŠ¢å å¼å¤šä»»åŠ¡ï¼ˆpreemptive multitaskingï¼‰ï¼šå†…æ ¸å†³å®šä½•æ—¶åˆ‡æ¢è¿›ç¨‹ï¼Œé€šè¿‡æ—¶é’Ÿä¸­æ–­å®ç°ã€‚</li>
</ul>
<h3 id="linux_1">Linux è¿›ç¨‹è°ƒåº¦å™¨<a class="headerlink" href="#linux_1" title="Permanent link">&para;</a></h3>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<ul>
<li><a href="https://ops-class.org/slides/2017-03-03-schedulingstory">ops-class.org | A Scheduling Story</a></li>
<li><a href="https://ijssst.info/Vol-15/No-3/data/3857a668.pdf">On the Fairness of Linux O(1) Scheduler</a></li>
</ul>
</div>
<ul>
<li>
<p>2.4 åŠä»¥å‰ä½¿ç”¨éå¸¸ç®€å•çš„è°ƒåº¦å™¨ã€‚</p>
<blockquote>
<p>Pre-2.6 Linux systems used a scheduler that scaled poorly, requiring O(n) time to schedule tasks where n is the number of runnable threads.</p>
</blockquote>
</li>
<li>
<p>2.5 å¼•å…¥ <span class="arithmatex">\(O(1)\)</span> è°ƒåº¦å™¨ã€‚å®ƒé€‚åˆå¤§å·¥ä½œè´Ÿè½½ï¼Œä½†å¯¹äºäº¤äº’å¼è¿›ç¨‹è¡¨ç°ä¸ä½³ã€‚</p>
<blockquote>
<p>The O(1) scheduler had limitations like poor interactive performance and low throughput for background jobs and hence was replaced by CFS.</p>
</blockquote>
</li>
<li>
<p>2.6 å¼€å§‹è¿›ä¸€æ­¥æ”¹è¿›ï¼ŒRSDL å¼•å…¥äº†å…¬å¹³è°ƒåº¦çš„æ¦‚å¿µï¼Œè¿›ä¸€æ­¥æ”¹è¿›åæˆä¸º CFSï¼ˆCompletely Fair Schedulerï¼‰ï¼Œä» 2.6.23 å¼€å§‹æˆä¸ºé»˜è®¤è°ƒåº¦å™¨ã€‚</p>
</li>
</ul>
<h3 id="_4">ç­–ç•¥<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<p>è¿›ç¨‹å¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸¤ç±»ï¼š</p>
<ul>
<li>I/O boundï¼šå¾ˆå¤šæ—¶é—´èŠ±åœ¨æäº¤å’Œç­‰å¾… I/O æ“ä½œä¸Šã€‚è¿™æ ·çš„ç¨‹åºåŸºæœ¬ä¸Šåªä¼šè¿è¡Œå¾ˆçŸ­çš„æ—¶é—´ã€‚<ul>
<li>GUI åº”ç”¨ç¨‹åºä¸€èˆ¬éƒ½æ˜¯ I/O boundï¼Œç­‰å¾…ç”¨æˆ·äº¤äº’ã€‚</li>
</ul>
</li>
<li>Processor boundï¼šå¾ˆå¤šæ—¶é—´èŠ±åœ¨è®¡ç®—ä¸Šï¼Œè¿è¡Œç›´åˆ°è¢«æŠ¢å ã€‚å¯¹è¿™æ ·çš„ç¨‹åºä¸€èˆ¬ç­–ç•¥æ˜¯è¿è¡Œæ›´å°‘é¢‘æ¬¡ä½†æ›´é•¿æ—¶é—´ã€‚</li>
</ul>
<p>Unix ç³»ç»Ÿçš„è°ƒåº¦ç­–ç•¥ä¸€èˆ¬åå¥½ I/O bound ä»¥æä¾›æ›´å¥½çš„å“åº”æ—¶é—´ã€‚</p>
<ul>
<li>Linux å…·æœ‰ä¸¤ä¸ªç‹¬ç«‹çš„è¿›ç¨‹ä¼˜å…ˆçº§ï¼š<ul>
<li>nice valueï¼šå…·æœ‰æ›´ä½ nice value çš„äº¬åŸè·å¾—æ›´å¤šå¤„ç†å™¨æ—¶é—´ã€‚</li>
<li>real-time priorityï¼šå…·æœ‰æ›´é«˜ real-time priority çš„è¿›ç¨‹ä¼˜å…ˆçº§æ›´é«˜ã€‚</li>
</ul>
</li>
<li>Timesliceï¼š<ul>
<li>é•¿æ—¶é—´ç‰‡ï¼šinteractive é™ä½ï¼Œæ„Ÿè§‰ä¸å†å¹¶å‘ï¼›é€‚åˆ processor boundã€‚  </li>
<li>çŸ­æ—¶é—´ç‰‡ï¼šä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€å¤§ï¼›é€‚åˆ I/O boundã€‚</li>
<li>Linux CFS åŠ¨æ€åˆ†é…æ—¶é—´ï¼Œæ˜¯ç³»ç»Ÿè´Ÿè½½å’Œ nice value çš„å‡½æ•°ã€‚</li>
</ul>
</li>
</ul>
<p>å…·ä½“ä¾‹å­è§ä¹¦æœ¬å’Œåšå®¢ã€‚</p>
<h3 id="linux_2">Linux è°ƒåº¦ç®—æ³•<a class="headerlink" href="#linux_2" title="Permanent link">&para;</a></h3>
<p>Linux è°ƒåº¦å™¨æ˜¯æ¨¡å—åŒ–çš„ï¼Œå¯ä»¥å¯¹ä¸åŒç§ç±»çš„è¿›ç¨‹ä½¿ç”¨ä¸åŒè°ƒåº¦ç®—æ³•ã€‚</p>
<ul>
<li>Each scheduler <strong>class</strong> has a priority. Iterates over each scheduler class in priority order.</li>
<li>Traditional Unix Scheduling has some pathological problems:<ul>
<li>Mapping nice values onto timeslices <strong>backward</strong> from ideal. High nice value process tend to be background (process bound), but allotted short timeslices. Normal priority process tend to be foreground user task, but allotted long timeslices.</li>
<li>Relative nice value has wildly different effects depending on the starting nice value.</li>
<li>Need the ability to assign an absolute timeslice (must be integer multiple of the timer tick). This introduces serveral problems.</li>
</ul>
</li>
</ul>
<p>Changes can be made to address these problems:</p>
<ul>
<li>make nice values geometric instead of additive.</li>
<li>mapping naice values to timeslices using a measurement decoupled from the timer tick</li>
</ul>
<p>But belie the true problem: assigning absolute timeslices yields a constant switching rate but variable fairness.</p>
<p>CFS <strong>do away with timeslices completely</strong> and assign each process a proportion of the processor. CFS thus yields constant fairness but a variable switching rate.</p>
<h4 id="fair-scheduling">Fair Scheduling<a class="headerlink" href="#fair-scheduling" title="Permanent link">&para;</a></h4>
<p>CFS is based on a simple concept: Model process scheduling as if the system had <strong>an ideal, perfectly multitasking processor</strong>. In such a system, <strong>each process would receive <span class="arithmatex">\(1/n\)</span> of the processorâ€™s time</strong>, where <span class="arithmatex">\(n\)</span> is the number of runnable processes, and weâ€™d schedule them for <strong>infinitely small durations</strong>, so that in any measurable period weâ€™d have run all n processes for the same amount of time.</p>
<p>CFS will run each process for some amount of time, round-robin, selecting next the process that has run the least. Rather than assign each process a timeslice, CFS calculates how long a process should run as <strong>a function of the total number of runnable processes</strong>. Instead of using the nice value to calculate a timeslice, CFS <strong>uses the nice value to weight the proportion of processor</strong> a process is to receive.</p>
<h3 id="linux_3">Linux è°ƒåº¦å®ç°<a class="headerlink" href="#linux_3" title="Permanent link">&para;</a></h3>
<p>CFS ç”±å››ä¸ªéƒ¨åˆ†ç»„æˆï¼š</p>
<ul>
<li>
<p>æ—¶é—´ç°¿è®°</p>
<ul>
<li>ç»™æ¯ä¸ªè¿›ç¨‹åˆ†é…æ—¶é—´ç‰‡ã€‚æ¯æ¬¡æ—¶é’Ÿ tickï¼Œå°†è¿›ç¨‹çš„æ—¶é—´ç‰‡å‡å°‘ã€‚å½“æ—¶é—´ç‰‡ç”¨å®Œï¼Œè¿›ç¨‹è¢«æŠ¢å ã€‚</li>
<li>
<p>ä½¿ç”¨è°ƒåº¦å™¨å®ä½“ç»“æ„ <code>struct sched_entity</code> æ¥è®°å½•ï¼Œå®ƒåµŒåœ¨è¿›ç¨‹æè¿°ç¬¦ <code>struct task_struct</code> ä¸­ã€‚</p>
<div class="language-c highlight"><span class="filename">linux/sched.h</span><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">sched_entity</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">load_weight</span><span class="w"> </span><span class="n">load</span><span class="p">;</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">rb_node</span><span class="w"> </span><span class="n">run_node</span><span class="p">;</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">on_rq</span><span class="p">;</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">    </span><span class="n">u64</span><span class="w"> </span><span class="n">exec_start</span><span class="p">;</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">    </span><span class="n">u64</span><span class="w"> </span><span class="n">sum_exec_runtime</span><span class="p">;</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">    </span><span class="n">u64</span><span class="w"> </span><span class="n">vruntime</span><span class="p">;</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="w">    </span><span class="n">u64</span><span class="w"> </span><span class="n">prev_sum_exec_runtime</span><span class="p">;</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="w">    </span><span class="c1">//...</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="p">};</span>
</span></code></pre></div>
<ul>
<li><code>vruntime</code>: normalized runtime of the process. On an ideal processor, the virtual runtime of all processes of the same priority would be identi- calâ€”all tasks would have received an equal, fair share of the processor. <code>update_curr()</code> manages this field.</li>
<li>è¿›ç¨‹é€‰æ‹©<ul>
<li>When CFS is deciding what process to run next, it picks the process with the <strong>smallest <code>vruntime</code></strong>.</li>
<li>CFS uses a <strong>red-black tree</strong> to manage the list of runnable processes and efficiently find the process with the smallest vruntime.</li>
<li>The <strong>key</strong> for each node is the runnable processâ€™s virtual runtime.</li>
</ul>
</li>
</ul>
<div class="language-c highlight"><span class="filename">kernel/shed_fair.c</span><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="k">static</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">sched_entity</span><span class="w"> </span><span class="o">*</span><span class="n">__pick_next_entity</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">cfs_rq</span><span class="w"> </span><span class="o">*</span><span class="n">cfs_rq</span><span class="p">)</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="p">{</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">rb_node</span><span class="w"> </span><span class="o">*</span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cfs_rq</span><span class="o">-&gt;</span><span class="n">rb_leftmost</span><span class="p">;</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">left</span><span class="p">)</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">rb_entry</span><span class="p">(</span><span class="n">left</span><span class="p">,</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">sched_entity</span><span class="p">,</span><span class="w"> </span><span class="n">run_node</span><span class="p">);</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>Thus CFS is <span class="arithmatex">\(O(\log n)\)</span>, where <span class="arithmatex">\(n\)</span> is the number of runnable processes.</strong></p>
</li>
</ul>
</li>
<li>
<p>è°ƒåº¦å™¨å…¥ç‚¹ <code>schedule()</code></p>
</li>
<li>
<p>ç¡çœ å’Œå”¤é†’</p>
<ul>
<li>
<p>Sleep (wake back is the inverse):</p>
<ul>
<li>marks itself as sleeping</li>
<li>puts itself on a wait queue</li>
<li>removes itself from the red-black tree of runnable</li>
<li>calls <code>schedule()</code> to select a new process to execute</li>
</ul>
<div class="language-c highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">DEFINE_WAIT</span><span class="p">(</span><span class="n">wait</span><span class="p">);</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="n">add_wait_queue</span><span class="p">(</span><span class="o">&amp;</span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">wait</span><span class="p">);</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">condition</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">    </span><span class="n">prepare_to_wait</span><span class="p">(</span><span class="o">&amp;</span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">wait</span><span class="p">,</span><span class="w"> </span><span class="n">TASK_INTERRUPTIBLE</span><span class="p">);</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">signal_pending</span><span class="p">(</span><span class="n">current</span><span class="p">))</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="w">        </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="w">    </span><span class="n">schedule</span><span class="p">();</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="p">}</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="n">finish_wait</span><span class="p">(</span><span class="o">&amp;</span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">wait</span><span class="p">);</span>
</span></code></pre></div>
</li>
<li>
<p>Wake up:</p>
<ul>
<li><code>wake_up()</code> wakes up <strong>all</strong> the tasks waiting on the given wait queue -&gt; <code>try_to_wake_up()</code> sets the taskâ€™s state to <code>TASK_RUNNING</code> -&gt; <code>enqueue_task()</code> to add the task to the red-black tree</li>
<li>spurious wake-up:  a task is awakened <strong>does not mean that the event for which the task is waiting has occurred</strong>. Sleeping should always be handled <strong>in a loop that</strong> ensures that the condition for which the task is waiting has indeed occurred.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="preemption-and-context-switching">Preemption and Context Switching<a class="headerlink" href="#preemption-and-context-switching" title="Permanent link">&para;</a></h3>
<pre class="mermaid"><code>graph TD
    A["schedule()"] --&gt; B["context_switch()"]
    B --&gt; C["switch_mm()"]
    B --&gt; D["switch_to()"]</code></pre>
<ul>
<li><code>switch_mm()</code>: switch <strong>virtual memory mapping</strong>.</li>
<li><code>switch_to()</code>: switch <strong>processor state</strong>.</li>
</ul>
<p><code>need_resched</code> flag signify whether a reschedule should be performed. In many cases kernel checks this flag and calls <code>schedule()</code>.</p>
<p>Linux kernel is <strong>fully</strong> preemptive (unlike most other Unix variants' cooperative kernel). So long as the kernel is in <strong>a state in which it is safe</strong> to reschedule. The safe state is: it does not hold a <strong>lock</strong>. <strong>Locks are used as markers of regions of nonpreemptibility</strong>.</p>
<ul>
<li>User Preemption<ul>
<li>When returning <strong>to user-space</strong> from a system call</li>
<li>When returning <strong>to user-space</strong> from an interrupt handler</li>
</ul>
</li>
<li>Kernel Preemption<ul>
<li>When an interrupt handler exits, before returning <strong>to kernel-space</strong></li>
<li>When kernel code becomes <strong>preemptible</strong> again</li>
<li>If a task in the kernel <strong>explicitly</strong> calls <code>schedule()</code></li>
<li>If a task in the kernel blocks (which results in a call to <code>schedule()</code>)</li>
</ul>
</li>
</ul>
<h3 id="real-time-scheduling-policies">Real-Time Scheduling Policies<a class="headerlink" href="#real-time-scheduling-policies" title="Permanent link">&para;</a></h3>
<div class="admonition todo">
<p class="admonition-title">skipped</p>
</div>
<h3 id="scheduler-related-system-calls">Scheduler-Related System Calls<a class="headerlink" href="#scheduler-related-system-calls" title="Permanent link">&para;</a></h3>
<div class="admonition todo">
<p class="admonition-title">skipped</p>
</div>
<h2 id="7">ç¬¬ 7 ç« ï¼šä¸­æ–­å’Œä¸­æ–­å¤„ç†<a class="headerlink" href="#7" title="Permanent link">&para;</a></h2>
<p>ç›¸æ¯”èµ·ç­‰å¾…å’Œè½®è¯¢ï¼ˆpollingï¼‰ï¼Œä¸­æ–­æ˜¯æœ€å¥½çš„å’Œç¡¬ä»¶åä½œçš„æ–¹å¼ã€‚</p>
<h3 id="_5">åŸºæœ¬æ¦‚å¿µ<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<ul>
<li>ä¸­æ–­æ§åˆ¶å™¨ï¼ˆinterrupt controllerï¼‰ï¼šå°†å¤šä¸ªä¸­æ–­çº¿ mux åˆ°å•çº¿é€šå¾€ CPUã€‚æ”¶åˆ°ä¸­æ–­æ—¶ï¼Œä¸­æ–­æ§åˆ¶å™¨å‘ CPU å‘ä¿¡å·ã€‚</li>
<li>é€šè¿‡åœ¨ä¸­æ–­ä¸­æºå¸¦ä¸€ä¸ªå”¯ä¸€çš„å€¼ï¼Œä¸åŒè®¾å¤‡èƒ½å¤Ÿä¸ä¸åŒçš„ä¸­æ–­å…³è”ã€‚è¿™äº›å€¼è¢«ç§°ä¸ºä¸­æ–­è¡Œï¼ˆIRQ linesï¼‰ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œ<code>0</code> æ˜¯æ—¶é’Ÿä¸­æ–­ï¼Œ<code>1</code> æ˜¯é”®ç›˜ä¸­æ–­ï¼Œæ›´å¤šè®¾å¤‡çš„ IRQ line æ˜¯åŠ¨æ€åˆ†é…çš„ã€‚</li>
<li>ä¸å¼‚æ­¥äº§ç”Ÿçš„ä¸­æ–­ç›¸æ¯”ï¼Œå¼‚å¸¸æ˜¯åŒæ­¥äº§ç”Ÿçš„ï¼ˆç”±äºæŒ‡ä»¤äº§ç”Ÿï¼‰ã€‚</li>
<li>å†…æ ¸ä¸ºç‰¹å®šçš„ä¸­æ–­è¿è¡Œä¸­æ–­å¤„ç†ç¨‹åºï¼ˆinterrupt service routineï¼ŒISRï¼‰ï¼Œæ¯ä¸ªè®¾å¤‡çš„ ISR æ˜¯å…¶é©±åŠ¨çš„ä¸€éƒ¨åˆ†ã€‚å®ƒä»¬æ˜¯æ™®é€šçš„ C å‡½æ•°ï¼Œåªä¸è¿‡éœ€è¦åŒ¹é…ç‰¹å®šçš„å‡½æ•°åŸå‹ï¼Œä»¥ä¾¿å†…æ ¸æŒ‰æ ‡å‡†çš„æ–¹å¼ä¼ é€æ•°æ®ã€‚</li>
<li>ä¸­æ–­å¤„ç†ç¨‹åºè¿è¡Œåœ¨ç‹¬ç«‹çš„ä¸Šä¸‹æ–‡ï¼ˆä¸­æ–­ä¸Šä¸‹æ–‡ï¼Œä¹Ÿç§°ä¸ºåŸå­ä¸Šä¸‹æ–‡ï¼‰ï¼Œåœ¨è¯¥ä¸Šä¸‹æ–‡æ‰§è¡Œæ— æ³•é˜»å¡ã€‚</li>
<li>ä¸­æ–­å¤„ç†ç¨‹åºæœ€å°‘çš„ä»»åŠ¡æ˜¯ï¼šå‘ŠçŸ¥è®¾å¤‡æ”¶åˆ°ä¸­æ–­ã€‚ç„¶è€Œæ¯”å¦‚ç½‘ç»œè®¾å¤‡çš„ä¸­æ–­å¤„ç†ç¨‹åºè¿˜æœ‰å¾ˆå¤šå·¥ä½œè¦åšã€‚å› æ­¤ï¼Œ<strong>ä¸­æ–­å¤„ç†ç¨‹åºåˆ†ä¸ºä¸ŠåŠå’Œä¸‹åŠ</strong>ï¼šä¸ŠåŠç«‹å³æ‰§è¡Œå¿«é€Ÿçš„å“åº”ï¼Œè€Œæ›´å¤šçš„å·¥ä½œæ¨è¿Ÿåˆ°ä¸‹åŠåœ¨æœªæ¥æ‰§è¡Œã€‚ä»¥ç½‘ç»œè®¾å¤‡ä¸ºä¾‹ï¼Œä¸ŠåŠå°†ç½‘ç»œæ•°æ®æ‹·è´åˆ°ä¸»å­˜ï¼Œå¹¶é€šçŸ¥ç½‘å¡æ¥å—æ›´å¤šåŒ…ï¼›ä¸‹åŠå»¶è¿Ÿæ‰§è¡Œï¼Œå°†æ•°æ®åŒ…é€åˆ°ç½‘ç»œæ ˆçš„ä¸åŒå±‚æ¬¡ã€‚</li>
</ul>
<h3 id="_6">å†™ä¸€ä¸ªä¸­æ–­å¤„ç†ç¨‹åº<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<div class="language-c highlight"><span class="filename">linux/interrupt.h</span><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="cm">/* request_irq: allocate a given interrupt line */</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="kt">int</span><span class="w"> </span><span class="nf">request_irq</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">irq</span><span class="p">,</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">    </span><span class="n">irq_handler_t</span><span class="w"> </span><span class="n">handler</span><span class="p">,</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">flags</span><span class="p">,</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="p">,</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">dev</span><span class="p">);</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="k">typedef</span><span class="w"> </span><span class="n">irqreturn_t</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">irq_handler_t</span><span class="p">)(</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="p">);</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="kt">void</span><span class="w"> </span><span class="nf">free_irq</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">irq</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">dev</span><span class="p">);</span>
</span></code></pre></div>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¤§éƒ¨åˆ† IRQ Line æ˜¯å…±äº«çš„ï¼Œé™¤éè®¾å¤‡å¾ˆè€ï¼Œç›´æ¥ä½åœ¨ ISA æ€»çº¿ä¸Šã€‚</p>
<p>æœ‰è¶£çš„æ˜¯ <code>request_irq()</code> ä¼šé˜»å¡ï¼Œæ‰€ä»¥è¦æ³¨æ„ä¸èƒ½åœ¨éé˜»å¡ä¸Šä¸‹æ–‡ä½¿ç”¨ï¼ˆæ¯”å¦‚ä¸­æ–­å¤„ç†ç¨‹åºï¼‰ã€‚å®ƒé˜»å¡åŸå› æ¥è‡ªè°ƒç”¨é“¾ï¼š<code>request_irq()</code> -&gt; <code>proc_mkdir()</code> -&gt; <code>proc_create()</code> -&gt; <code>kmalloc()</code>ï¼Œåœ¨ procfs åˆ›å»ºæ¡ç›®éœ€è¦åˆ†é…å†…å­˜ï¼Œå› æ­¤å¯èƒ½é˜»å¡ã€‚</p>
<p>æ”¶åˆ°ä¸­æ–­æ—¶ï¼Œå†…æ ¸é¡ºåºè°ƒèµ·ç›¸åŒ IRQ Line çš„æ‰€æœ‰ä¸­æ–­å¤„ç†ç¨‹åºã€‚è¿™äº›ä¸­æ–­å¤„ç†ç¨‹åºéœ€è¦åˆ¤æ–­æ˜¯å¦æ˜¯è‡ªå·±çš„è®¾å¤‡å‘å‡ºçš„ä¸­æ–­ï¼Œè¿™éœ€è¦è®¾å¤‡ä¸Šå…·æœ‰ä¸­æ–­å¤„ç†ç¨‹åºå¯ä»¥ç¡®è®¤çš„çŠ¶æ€å¯„å­˜å™¨ã€‚</p>
<h3 id="rtc">ä¾‹å­ï¼šRTC ä¸­æ–­ç¨‹åº<a class="headerlink" href="#rtc" title="Permanent link">&para;</a></h3>
<p>å®æ—¶æ—¶é’Ÿï¼ˆreal-time clockï¼ŒRTCï¼‰ä¸ç³»ç»Ÿæ—¶é’Ÿä¸åŒï¼Œå®ƒæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ç¡¬ä»¶è®¾å¤‡ã€‚RTC è®¾å¤‡é€šå¸¸ä¾é ä¸€ä¸ªçŸ³è‹±æ™¶ä½“æŒ¯è¡å™¨æ¥ç”Ÿæˆç²¾ç¡®çš„æ—¶é—´åŸºå‡†ã€‚æ™¶ä½“æŒ¯è¡å™¨äº§ç”Ÿçš„å›ºå®šé¢‘ç‡è„‰å†²è¢«è®¡æ•°ï¼Œç”¨æ¥è®¡ç®—æ—¶é—´çš„æµé€ã€‚</p>
<p>å…·ä½“ä»£ç è§ä¹¦æœ¬ã€‚</p>
<h3 id="_7">ä¸­æ–­ä¸Šä¸‹æ–‡<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<p>ä¸å†…å­˜ç« èŠ‚å†…å®¹ç›¸åŒï¼Œæ³¨æ„ä¸­æ–­ä¸Šä¸‹æ–‡å¯èƒ½ä¸ºå…±äº«æˆ–å•é¡µã€‚</p>
<p>æ­¤å¤–ä¸è¿›ç¨‹ä¸Šä¸‹æ–‡ä¸åŒï¼Œ<code>current</code> æŒ‡é’ˆæ²¡æœ‰æ„ä¹‰ï¼ˆè™½ç„¶å®ƒæŒ‡å‘è¢«ä¸­æ–­çš„è¿›ç¨‹ï¼‰ï¼Œå› ä¸ºä¸­æ–­ä¸è¿›ç¨‹æ— å…³ã€‚</p>
<h3 id="_8">å®ç°ä¸­æ–­å¤„ç†ç¨‹åº<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>æœ¬èŠ‚çš„ä¸€äº›å†…å®¹å·²ç»è¿‡æ—¶ï¼Œæ¯”å¦‚ <code>do_IRQ()</code> å·²ç»è¢«ç§»é™¤ã€‚è¾ƒæ–°çš„ä¸­æ–­æœºåˆ¶ä¸º flow handlerï¼Œè§ <a href="https://www.kernel.org/doc/html/v4.18/core-api/genericirq.html">Linux generic IRQ handling</a>ã€‚</p>
<p>æœ¬ä¹¦æ‰€æè¿°çš„æ—§ä»£ç è§ <a href="https://github.com/spotify/linux/blob/master/kernel/irq/handle.c">linux/kernel/irq/handle.c</a>ã€‚</p>
</div>
<p><a class="glightbox" href="../lkd3.assets/ch7_interrupt.webp" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="ch7_interrupt" src="../lkd3.assets/ch7_interrupt.webp" /></a></p>
<ul>
<li>å¤„ç†å™¨åœæ­¢æ­£åœ¨åšçš„äº‹æƒ…ï¼Œå…³é—­ä¸­æ–­ç³»ç»Ÿï¼Œè·³åˆ°ä¸å®šä¹‰çš„å†…å­˜ä½ç½®æ‰§è¡Œä»£ç ã€‚è¯¥ä½ç½®ç”±å†…æ ¸è®¾ç½®ï¼Œç§°ä¸ºä¸­æ–­å¤„ç†ç¨‹åºçš„å…¥å£ï¼ˆentry pointï¼‰ã€‚</li>
<li>å¯¹äºæ¯ä¸ªä¸­æ–­è¡Œï¼Œè·³è½¬åˆ°ä¸€ä¸ªå”¯ä¸€çš„ä½ç½®ï¼Œè¿™æ ·å†…æ ¸å°±èƒ½çŸ¥é“ IRQ Lineã€‚</li>
<li>åˆå§‹ä¸­æ–­ç¨‹åºç®€å•åœ°ä¿å­˜ IRQ Line çš„å€¼å’Œå¯„å­˜å™¨ï¼ˆä¸Šä¸‹æ–‡ï¼‰åˆ°æ ˆä¸­ï¼Œç„¶åè°ƒç”¨ <code>do_IRQ()</code>ã€‚</li>
<li><code>do_IRQ()</code> è§£æ IRQ Lineï¼Œåœæ­¢è¯¥ä¸­æ–­è¡Œçš„ä¸­æ–­ï¼Œç¡®è®¤è¯¥ä¸­æ–­è¡Œä¸Šæœ‰åˆæ³•çš„ä¸­æ–­å¤„ç†ç¨‹åºä¸”æ²¡æœ‰åœ¨æ‰§è¡Œï¼Œç„¶åè°ƒç”¨ <code>handle_IRQ_event()</code>ã€‚</li>
<li>è¿è¡Œç»“æŸåè°ƒç”¨ <code>ret_from_intr()</code>ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰ç­‰å¾…çš„ rescheduleï¼Œå¦‚æœæœ‰ï¼Œè°ƒç”¨ <code>schedule()</code>ï¼ˆæ ¹æ®è¿”å›çš„æ˜¯å†…æ ¸ç©ºé—´è¿˜æ˜¯ç”¨æˆ·ç©ºé—´ï¼Œè¿˜æœ‰å…¶ä»–åˆ¤æ–­æ¡ä»¶ï¼‰ã€‚</li>
</ul>
<h3 id="_9">ä¸­æ–­æ§åˆ¶<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<ul>
<li>å†…æ ¸æä¾›ä¸­æ–­æ§åˆ¶æ¥å£ï¼Œä¸»è¦æ˜¯ä¸ºäº†åŒæ­¥çš„éœ€æ±‚ï¼šä¿è¯ä¸­æ–­å¤„ç†ç¨‹åºä¸ä¼šæŠ¢å å½“å‰ä»£ç ã€‚<ul>
<li>ç„¶è€Œï¼Œå…³é—­ä¸­æ–­å’Œå†…æ ¸æŠ¢å å¹¶ä¸èƒ½ä¿è¯æ²¡æœ‰å…¶ä»–è¿›ç¨‹å¹¶å‘è®¿é—®ã€‚è¿™éœ€è¦ä½¿ç”¨é”ã€‚</li>
</ul>
</li>
</ul>
<div class="language-c highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1">// å…¨å±€</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="n">local_irq_disable</span><span class="p">();</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="n">local_irq_enable</span><span class="p">();</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="n">local_irq_save</span><span class="p">(</span><span class="n">flags</span><span class="p">);</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="n">local_irq_restore</span><span class="p">(</span><span class="n">flags</span><span class="p">);</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="c1">// IRQ Line</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="kt">void</span><span class="w"> </span><span class="nf">disable_irq</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">irq</span><span class="p">);</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="kt">void</span><span class="w"> </span><span class="nf">disable_irq_nosync</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">irq</span><span class="p">);</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="kt">void</span><span class="w"> </span><span class="nf">enable_irq</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">irq</span><span class="p">);</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="kt">void</span><span class="w"> </span><span class="nf">synchronize_irq</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">irq</span><span class="p">);</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="c1">// status</span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="n">in_interrupt</span><span class="p">();</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="n">in_irq</span><span class="p">();</span>
</span></code></pre></div>
<h3 id="_10">æ‚é¡¹<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h3>
<ul>
<li>æŸ¥çœ‹ <code>/proc/interrupts</code> å¯ä»¥çœ‹åˆ°ä¸­æ–­æƒ…å†µç»Ÿè®¡ï¼Œæœ‰å„ CPU å’Œä¸­æ–­è¡Œã€‚</li>
<li>PCI è§„èŒƒå¼ºåˆ¶ä¸­æ–­å…±äº«ï¼Œç°ä»£ PCI è®¾å¤‡éƒ½æ”¯æŒä¸­æ–­å…±äº«ã€‚</li>
</ul>
<h2 id="8">ç¬¬ 8 ç« ï¼šä¸‹åŠå’Œå»¶è¿Ÿå·¥ä½œ<a class="headerlink" href="#8" title="Permanent link">&para;</a></h2>
<h2 id="undone-chapter-11-timers-and-time-management">[undone] Chapter 11: Timers and Time Management<a class="headerlink" href="#undone-chapter-11-timers-and-time-management" title="Permanent link">&para;</a></h2>
<ul>
<li>A large number of kernel functions are <strong>time-driven</strong>.</li>
<li>Events occur <strong>periodically</strong> are driven by the <strong>system timer</strong> (hardware). Its timer interrupt is used to update the system time and to drive the kernel's timer facilities.</li>
<li><strong>Dynamic timer</strong> is used to schedule events. Create and destroy timers dynamically.</li>
</ul>
<h3 id="kernel-notino-of-time">Kernel Notino of Time<a class="headerlink" href="#kernel-notino-of-time" title="Permanent link">&para;</a></h3>
<p>The system timer goes off at a <strong>preprogrammed frequency called the tick rate</strong>. Kernel knows the tick rate, and it knows the time between any two successive timer interrupts.</p>
<h3 id="the-tick-rate-hz">The Tick Rate: HZ<a class="headerlink" href="#the-tick-rate-hz" title="Permanent link">&para;</a></h3>
<p>The frequency of the system timer (the tick rate) is <strong>programmed on system boot</strong> based on a static preprocessor define, <code>HZ</code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As of now, <code>HZ</code> is defined in <code>asm-generic/param.h</code> to be <code>100</code> for all architectures.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Rest part of this section discusses the impact of large <code>HZ</code> values on the system. Ignored for now.</p>
</div>
<h3 id="jiffies">Jiffies<a class="headerlink" href="#jiffies" title="Permanent link">&para;</a></h3>
<div class="language-c highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="k">extern</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="k">volatile</span><span class="w"> </span><span class="n">jiffies</span><span class="p">;</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="k">extern</span><span class="w"> </span><span class="n">u64</span><span class="w"> </span><span class="n">jiffies_64</span><span class="p">;</span>
</span></code></pre></div>
<p>The global variable <code>jiffies</code> holds the number of ticks that have occurred since the system booted.</p>
<p>Interstingly, <code>ld</code> script <code>arch/.../kernel/vmlinux.lds</code> overlays the <code>jiffies</code> variable over the start of the <code>jiffies_64</code> variable.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>jiffies = jiffies_64;
</span></code></pre></div>
<p>Because <code>jiffies</code> can wraparound, some macro functions are provided to handle this.</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="cp">#define time_after(unknow, known) ((long)(known) - (long)(unknow) &lt; 0)</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="cp">#define time_before(unknow, known) ((long)(unknow) - (long)(known) &lt; 0)</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="cp">#define time_after_eq(unknow, known) ((long)(unknow) - (long)(known) &gt;= 0)  </span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="cp">#define time_before_eq(unknow, known) ((long)(known) - (long)(unknow) &gt;= 0)</span>
</span></code></pre></div>
<p>From kernel 2.6, there is <code>USER_HZ</code> exported to user space.</p>
<h3 id="hardware-clocks-and-timers">Hardware Clocks and Timers<a class="headerlink" href="#hardware-clocks-and-timers" title="Permanent link">&para;</a></h3>
<ul>
<li>RTC: a nonvolatile device for storing the system time. On boot, the kernel reads the RTC and uses it to initialize the wall time.</li>
<li>System Timer: an electronic clock that oscillates at a programmable frequency. On x86, the primary system timer is the programmable interrupt timer (PIT). Other x86 time sources include the local APIC timer and the processorâ€™s time stamp counter (TSC).</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>TSC is an important metric for performance monitoring and tuning. It is a high-resolution counter that increments with each clock cycle.</p>
</div>
<h3 id="the-timer-interrupt-handler">The Timer Interrupt Handler<a class="headerlink" href="#the-timer-interrupt-handler" title="Permanent link">&para;</a></h3>
<div class="admonition todo">
<p class="admonition-title">skipped</p>
</div>
<h3 id="the-time-of-day">The Time of Day<a class="headerlink" href="#the-time-of-day" title="Permanent link">&para;</a></h3>
<h3 id="timers">Timers<a class="headerlink" href="#timers" title="Permanent link">&para;</a></h3>
<h3 id="delaying-execution">Delaying Execution<a class="headerlink" href="#delaying-execution" title="Permanent link">&para;</a></h3>
<h2 id="12">ç¬¬ 12 ç« ï¼šå†…å­˜ç®¡ç†<a class="headerlink" href="#12" title="Permanent link">&para;</a></h2>
<p>æœ¬ç« ä»‹ç»å†…æ ¸å¦‚ä½•ç®¡ç†<strong>ç‰©ç†å†…å­˜</strong>ã€‚æ­¤å¤–ï¼Œå†…æ ¸è¿˜ç®¡ç†ç”¨æˆ·ç©ºé—´å†…å­˜ï¼Œè§ç¬¬ 15 ç« ã€‚</p>
<h3 id="_11">å†…å­˜åŸºæœ¬æ¦‚å¿µ<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>é¡µé¢ Page</p>
<ul>
<li>å†…å­˜æŒ‰å­—èŠ‚å¯»å€ã€‚</li>
<li>MMU ç®¡ç†å†…å­˜ï¼Œæ‰§è¡Œè™šæ‹Ÿåˆ°ç‰©ç†åœ°å€çš„è½¬æ¢ã€‚å®ƒä»¥é¡µé¢ä¸ºç²’åº¦ç»´æŠ¤ç³»ç»Ÿçš„é¡µè¡¨ã€‚<strong>æ¯ç§ä½“ç³»ç»“æ„éƒ½æœ‰è‡ªå·±çš„é¡µè¡¨å¤§å°å’Œæ ¼å¼</strong>ã€‚å¤§å¤šæ•° 32 ä½æ¶æ„ä½¿ç”¨ 4KB å¤§å°çš„é¡µé¢ã€‚å¯¹äºè™šæ‹Ÿå†…å­˜æ¥è¯´ï¼Œé¡µé¢æ˜¯æœ€å°çš„å¯åˆ†é…å•ä½ã€‚</li>
<li>
<p>å†…æ ¸ä¸­ï¼Œæ¯ä¸ªç‰©ç†é¡µé¢è¡¨ç¤ºä¸º <code>struct page</code>ï¼š</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>struct page {
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>    unsigned long flags;
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>    atomic_t _count;
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>    atomic_t _mapcount;
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>    unsigned long private;
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>    struct address_space *mapping;
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>    pgoff_t index;
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>    struct list_head lru;
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>    void *virtual;
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>};
</span></code></pre></div>
<p><code>struct page</code> æè¿°çš„æ˜¯ç‰©ç†é¡µé¢ï¼Œå› æ­¤æ˜¯<strong>æµåŠ¨</strong>çš„ï¼Œå¹¶ä¸æ€»æ˜¯å…³è”åˆ°ç‰¹å®šçš„ç‰©ç†é¡µé¢ï¼ˆå¯èƒ½è¢«ç½®æ¢ç­‰ï¼‰ã€‚å†…æ ¸ä½¿ç”¨è¯¥æ•°æ®ç»“æ„è·Ÿè¸ªç‰©ç†é¡µé¢çš„æƒ…å†µï¼ŒåŒ…æ‹¬é¡µé¢çš„å¼•ç”¨è®¡æ•°ã€ä½¿ç”¨è€…ï¼ˆå¯èƒ½ä¸ºç”¨æˆ·ç©ºé—´ç¨‹åºã€å†…æ ¸ä»£ç å’Œæ•°æ®ç»“æ„ç­‰ï¼‰ç­‰ã€‚</p>
<p>ç›¸å…³å‡½æ•°ï¼š</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="n">page_count</span><span class="p">()</span>
</span></code></pre></div>
<ul>
<li><code>_count</code>ï¼šå¼•ç”¨è®¡æ•°ã€‚</li>
<li><code>virtual</code>ï¼šè¯¥ç‰©ç†é¡µé¢çš„è™šæ‹Ÿåœ°å€ã€‚</li>
<li>åŒºåŸŸ Zone<ul>
<li>ç”±äºç¡¬ä»¶æ¶æ„çš„é™åˆ¶ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰é¡µé¢éƒ½èƒ½ä»¥ç›¸åŒçš„æ–¹å¼å¯¹å¾…ã€‚ä¾‹å¦‚ï¼šæŸäº› DMA åªèƒ½è®¿é—®ç‰¹å®šçš„å†…å­˜åŒºåŸŸã€‚</li>
<li>Linux å››ç§å†…å­˜åŒºåŸŸï¼š</li>
</ul>
</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>ZONE_DMA ZONE_DMA32 ZONE_NORMAL ZONE_HIGHMEM
</span></code></pre></div>
<p>x86-64 æ”¯æŒ full mapï¼Œå› æ­¤æ²¡æœ‰ <code>ZONE_HIGHMEM</code> åŒºåŸŸã€‚æ‰€æœ‰å†…å­˜åŒºåŸŸéƒ½åŒ…å«åœ¨ <code>ZONE_NORMAL</code> å’Œ <code>ZONE_DMA</code> ä¸­ã€‚</p>
<p>x86 ä»…èƒ½å¯»å€ <span class="arithmatex">\(2^{32}\)</span>ï¼ˆ4 GBï¼‰å†…å­˜ç©ºé—´ã€‚å¦‚æœç‰©ç†å†…å­˜æ›´å¤§ï¼Œè®¿é—®è¿™äº›æ— æ³•ç›´æ¥å¯»å€çš„å†…å­˜å°±éœ€è¦é€šè¿‡ <code>ZONE_HIGHMEM</code> åŒºåŸŸã€‚</p>
</li>
<li>
<p>Linux ä½¿ç”¨ <code>struct zone</code> æè¿°å†…å­˜åŒºåŸŸã€‚</p>
</li>
<li>é¡µé¢ç›¸å…³æ¥å£ï¼š</li>
</ul>
<div class="language-c highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">page</span><span class="w"> </span><span class="o">*</span><span class="n">alloc_pages</span><span class="p">(</span><span class="n">gfp_t</span><span class="w"> </span><span class="n">gfp_mask</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">order</span><span class="p">);</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="k">struct</span><span class="w"> </span><span class="nc">page</span><span class="w"> </span><span class="o">*</span><span class="n">alloc_page</span><span class="p">(</span><span class="n">gfp_t</span><span class="w"> </span><span class="n">gfp_mask</span><span class="p">);</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">page_address</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">page</span><span class="w"> </span><span class="o">*</span><span class="n">page</span><span class="p">);</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="nf">__get_free_pages</span><span class="p">(</span><span class="n">gfp_t</span><span class="w"> </span><span class="n">gfp_mask</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">order</span><span class="p">);</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="n">unsinged</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">__get_free_page</span><span class="p">(</span><span class="n">gfp_t</span><span class="w"> </span><span class="n">gfp_mask</span><span class="p">);</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="nf">get_zeroed_page</span><span class="p">(</span><span class="n">gfp_t</span><span class="w"> </span><span class="n">gfp_mask</span><span class="p">);</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="kt">void</span><span class="w"> </span><span class="nf">__free_pages</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">page</span><span class="w"> </span><span class="o">*</span><span class="n">page</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">order</span><span class="p">);</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="kt">void</span><span class="w"> </span><span class="nf">free_pages</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">addr</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">order</span><span class="p">);</span>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="kt">void</span><span class="w"> </span><span class="nf">free_page</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">addr</span><span class="p">);</span>
</span></code></pre></div>
<p><code>gfp</code> å°±æ˜¯ get free page çš„ç¼©å†™ã€‚</p>
</li>
<li>
<p>å†…æ ¸ä¸­çš„ä¸¤ä¸ªå†…å­˜åˆ†é…å‡½æ•°ï¼š</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">kmalloc</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">gfp_t</span><span class="w"> </span><span class="n">flags</span><span class="p">);</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="kt">void</span><span class="w"> </span><span class="nf">kfree</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">ptr</span><span class="p">);</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">vmalloc</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">size</span><span class="p">);</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="kt">void</span><span class="w"> </span><span class="nf">vfreen</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">addr</span><span class="p">);</span>
</span></code></pre></div>
<p>å…¶ä¸­ï¼Œ<code>gfp_t</code> æ˜¯ <code>unsigned int</code>ï¼Œæ„å‘³ç€è‡³å°‘æœ‰ 32 ä¸ªæ ‡å¿—å¯ä»¥è®¾ç½®ã€‚æ ‡å¿—å¯ä»¥åˆ†ä¸ºä¸‰ç±»ï¼š</p>
<ul>
<li>action modifiersï¼šæ›´æ”¹å†…å­˜åˆ†é…è¡Œä¸ºã€‚ä¾‹å¦‚ interrupt handlers ä¸èƒ½é˜»å¡ï¼Œå› æ­¤éœ€è¦ <code>GFP_ATOMIC</code>ã€‚</li>
<li>zone modifiersï¼šæŒ‡å®šå†…å­˜åˆ†é…çš„åŒºåŸŸã€‚ä¾‹å¦‚ <code>GFP_DMA</code>ã€‚</li>
<li>typesï¼šå¤šä¸ª modifiers çš„ç»“åˆï¼Œæ–¹ä¾¿ç‰¹å®šç§ç±»å†…å­˜åˆ†é…ã€‚æœ€å¸¸ç”¨çš„æ˜¯ <code>GFP_KERNEL</code>ã€‚</li>
</ul>
</li>
</ul>
<h3 id="slab">Slab å±‚<a class="headerlink" href="#slab" title="Permanent link">&para;</a></h3>
<ul>
<li>åœ¨ Understanding Linux Network Internals å¼€ç¯‡è§åˆ°è¿‡è¿™ä¸€å±‚æ¬¡ã€‚</li>
<li>Slab å±‚æ˜¯ä¸€ä¸ª free listï¼Œç”¨äºå†…æ ¸å¯¹è±¡ï¼Œç›¸å½“äºå†…å­˜å¯¹è±¡çš„ cacheã€‚å¸¸ç”¨çš„å¯¹è±¡ç›´æ¥ä»è¡¨ä¸­è·å–ï¼Œé‡Šæ”¾æ—¶å½’è¿˜ï¼Œè€Œçœå»äº†é¢‘ç¹çš„å†…å­˜åˆ†é…å’Œé‡Šæ”¾æ“ä½œã€‚</li>
<li>æœ‰è¶£çš„æ˜¯ï¼Œ<code>kmalloc()</code> ä¹Ÿæ˜¯é€šè¿‡ Slab å±‚å®ç°çš„ï¼Œå®ƒä½¿ç”¨ general purpose cacheã€‚</li>
<li>
<p><code>kmem_cache</code>ã€<code>kmem_list3</code>ã€<code>struct slab</code></p>
<p><a class="glightbox" href="../lkd3.assets/ch12_slab.webp" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="slab" src="../lkd3.assets/ch12_slab.webp" /></a></p>
</li>
<li>
<p>Slab æœ‰ä¸‰ç§çŠ¶æ€ï¼š</p>
<ul>
<li>fullï¼šæ²¡æœ‰ç©ºé—²å¯¹è±¡ã€‚</li>
<li>partialï¼šæœ‰ç©ºé—²å¯¹è±¡ã€‚</li>
<li>emptyï¼šæ²¡æœ‰è¢«åˆ†é…çš„å¯¹è±¡ã€‚</li>
</ul>
<p>åˆ†é…è¯·æ±‚ä¼˜å…ˆç”± partial å¤„ç†ï¼›è‹¥æ— ï¼Œåˆ™ç”± empty åˆ†é…ï¼›è‹¥æ—  empty slabï¼Œåˆ™åˆ›å»ºä¸€ä¸ªã€‚Slab allocator ä¸ <code>__get_free_pages()</code> ç­‰åº•å±‚æ¥å£äº¤äº’ï¼Œè§</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="nf">kmem_getpages</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">kmem_cache</span><span class="w"> </span><span class="o">*</span><span class="n">cachep</span><span class="p">,</span><span class="w"> </span><span class="n">gfp_t</span><span class="w"> </span><span class="n">flags</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">nodeid</span><span class="p">);</span>
</span></code></pre></div>
<p>æœ€åä¸€ä¸ªå‚æ•° <code>nodeid</code> æ˜¯ NUMA æ¶æ„çš„èŠ‚ç‚¹ IDï¼Œä½¿å¾—è¯¥å‡½æ•° NUMA-awareã€‚</p>
</li>
<li>
<p>Slab å±‚å¯¹å¤–çš„æ¥å£ååˆ†ç®€æ´ï¼š</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">kmem_cache</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">kmem_cache_create</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">align</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">flags</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">ctor</span><span class="p">)(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="p">));</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="kt">int</span><span class="w"> </span><span class="nf">kmem_cache_destroy</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">kmem_cache</span><span class="w"> </span><span class="o">*</span><span class="n">cachep</span><span class="p">);</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">kmem_cache_alloc</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">kmem_cache</span><span class="w"> </span><span class="o">*</span><span class="n">cachep</span><span class="p">,</span><span class="w"> </span><span class="n">gfp_t</span><span class="w"> </span><span class="n">flags</span><span class="p">);</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="kt">void</span><span class="w"> </span><span class="nf">kmem_cache_free</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">kmem_cache</span><span class="w"> </span><span class="o">*</span><span class="n">cachep</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">objp</span><span class="p">);</span>
</span></code></pre></div>
<p>ç”¨ä¾‹ï¼š</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">kmem_cache</span><span class="w"> </span><span class="o">*</span><span class="n">task_struct_cachep</span><span class="p">;</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="n">task_struct_cachep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kmem_cache_create</span><span class="p">(</span><span class="s">&quot;task_struct&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">task_struct</span><span class="p">),</span><span class="w"> </span><span class="n">ARCH_MIN_TASKALIGN</span><span class="p">,</span><span class="w"> </span><span class="n">SLAB_PANIC</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">SLAB_NOTRACK</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="k">struct</span><span class="w"> </span><span class="nc">task_struct</span><span class="w"> </span><span class="o">*</span><span class="n">tsk</span><span class="p">;</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="n">tsk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kmem_cache_alloc</span><span class="p">(</span><span class="n">task_struct_cachep</span><span class="p">,</span><span class="w"> </span><span class="n">GFP_KERNEL</span><span class="p">);</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">tsk</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="p">}</span>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="n">kmem_cache_free</span><span class="p">(</span><span class="n">task_struct_cachep</span><span class="p">,</span><span class="w"> </span><span class="n">tsk</span><span class="p">);</span>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="kt">int</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kmem_cache_destroy</span><span class="p">(</span><span class="n">task_struct_cachep</span><span class="p">);</span>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a><span class="k">if</span><span class="p">(</span><span class="n">err</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a><span class="w">    </span><span class="c1">//...</span>
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a><span class="p">}</span>
</span></code></pre></div>
</li>
</ul>
<h3 id="_12">æ ˆä¸Šçš„é™æ€åˆ†é…<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h3>
<p>ä¸ç”¨æˆ·ç©ºé—´ç¨‹åºç›¸æ¯”ï¼Œå†…æ ¸çš„æ ˆå°ä¸”å›ºå®šã€‚å†…æ ¸æ ˆçš„å¤§å°å—æ¶æ„å’Œç¼–è¯‘é€‰é¡¹å½±å“ï¼Œé€šå¸¸æ˜¯ä¸¤é¡µå¤§å°ï¼ˆå³ 32 ä½ 8KBã€64 ä½ 16 KBï¼‰ã€‚</p>
<ul>
<li>
<p>å•é¡µå†…æ ¸æ ˆï¼ˆ2.6 èµ·ï¼‰</p>
<p>è¿›ç¨‹çš„æ•´ä¸ªè°ƒç”¨é“¾éœ€è¦èƒ½å¤Ÿæ”¾å…¥æ ˆä¸­ï¼Œè€Œä¸­æ–­å¤„ç†ç¨‹åºä¹Ÿä¼šä½¿ç”¨è¿›ç¨‹çš„æ ˆã€‚å½“è°ƒæ•´ä¸ºå•é¡µæ—¶ï¼Œä¸­æ–­å¤„ç†ç¨‹åºæ”¾ä¸è¿›å»äº†ã€‚</p>
<p>å†…æ ¸è®¾è®¡è€…çš„æ–¹æ³•æ˜¯ï¼Œç»™æ¯ä¸ªå¤„ç†å™¨æ”¾ä¸€ä¸ªå•é¡µçš„ä¸­æ–­å¤„ç†æ ˆï¼Œä¸­æ–­å¤„ç†ç¨‹åºç”¨è¿™ä¸ªæ ˆï¼Œä¸å†ä¸è¿›ç¨‹å…±äº«ã€‚</p>
</li>
<li>
<p>åœ¨æ ˆä¸Šå·¥ä½œ</p>
<p>å†…æ ¸æ²¡æœ‰æ ˆç®¡ç†ï¼Œå› æ­¤è¦æ³¨æ„æ ˆä¸Šåˆ†é…çš„å†…å®¹ä¸è¦è¶…è¿‡æ•°ç™¾å­—èŠ‚ã€‚å¦‚æœæ ˆæº¢å‡ºï¼Œæœ€å…ˆåå™¬çš„åº”è¯¥æ˜¯ <code>thread_info</code>ï¼Œå®ƒåœ¨æ¯ä¸ªè¿›ç¨‹å†…æ ¸æ ˆçš„æœ€ä½å¤„ã€‚</p>
</li>
</ul>
<h3 id="_13">é«˜å†…å­˜æ˜ å°„<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>æ°¸ä¹…æ˜ å°„ï¼š</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">kmap</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">page</span><span class="w"> </span><span class="o">*</span><span class="n">page</span><span class="p">)</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="kt">void</span><span class="w"> </span><span class="n">kunmap</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">page</span><span class="w"> </span><span class="o">*</span><span class="n">page</span><span class="p">)</span>
</span></code></pre></div>
<p>é«˜ä½å†…å­˜éƒ½èƒ½ç”¨ã€‚</p>
</li>
<li>
<p>ä¸´æ—¶æ˜ å°„ï¼ˆåŸå­æ˜ å°„ï¼‰ï¼šç”¨äºéœ€è¦æ˜ å°„ä½†ä¸Šä¸‹æ–‡ä¸å…è®¸ç¡çœ çš„æƒ…å†µï¼Œæ­¤å¤–è¿™äº›å‡½æ•°è¿˜å…³é—­æŠ¢å </p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">kmap_atomic</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">page</span><span class="o">*</span><span class="w"> </span><span class="n">page</span><span class="p">,</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="n">km_type</span><span class="w"> </span><span class="n">type</span><span class="p">)</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="kt">void</span><span class="w"> </span><span class="n">kunmap_atomic</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">kvaddr</span><span class="p">,</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="n">km_type</span><span class="w"> </span><span class="n">type</span><span class="p">)</span>
</span></code></pre></div>
</li>
</ul>
<h3 id="cpu">é€ CPU åˆ†é…<a class="headerlink" href="#cpu" title="Permanent link">&para;</a></h3>
<div class="language-c highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="kt">int</span><span class="w"> </span><span class="n">cpu</span><span class="p">;</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="n">cpu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_cpu</span><span class="p">();</span><span class="w"> </span><span class="cm">/* get current processor and disable kernel preemption */</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="n">my_percpu</span><span class="p">[</span><span class="n">cpu</span><span class="p">]</span><span class="o">++</span><span class="p">;</span><span class="w"> </span><span class="cm">/* ... or whatever */</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="n">printk</span><span class="p">(</span><span class="err">â€œ</span><span class="n">my_percpu</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">cpu</span><span class="o">=%</span><span class="n">d</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="o">%</span><span class="n">lu</span><span class="err">\</span><span class="n">n</span><span class="err">â€</span><span class="p">,</span><span class="w"> </span><span class="n">cpu</span><span class="p">,</span><span class="w"> </span><span class="n">my_percpu</span><span class="p">[</span><span class="n">cpu</span><span class="p">]);</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="n">put_cpu</span><span class="p">();</span><span class="w"> </span><span class="cm">/* enable kernel preemption */</span>
</span></code></pre></div>
<p>å†…æ ¸æŠ¢å ä¼šé€ æˆè¿™äº›é—®é¢˜ï¼š</p>
<ul>
<li>å¦‚æœä»£ç è¢«å®‰æ’åˆ°å…¶ä»– CPU ä¸Šï¼Œä¸Šé¢çš„ <code>cpu</code> å˜é‡å°†å¤±æ•ˆã€‚</li>
<li>å…¶ä»–ä»£ç å¯èƒ½åŒæ ·è¯»å†™ <code>my_percpu</code> ä¸­çš„æ•°æ®ï¼Œé€ æˆç«äº‰ã€‚</li>
</ul>
<p>2.6 å¼€å§‹æä¾›äº†æ–°çš„é€ CPU æ¥å£ï¼š</p>
<div class="language-c highlight"><span class="filename">linux/percpu.h</span><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="c1">// ç¼–è¯‘æ—¶</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="n">DEFINE_PER_CPU</span><span class="p">(</span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="n">DECLARE_PER_CPU</span><span class="p">(</span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="n">get_cpu_var</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">++</span><span class="p">;</span><span class="w"> </span><span class="cm">/* increment name on this processor */</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="n">put_cpu_var</span><span class="p">(</span><span class="n">name</span><span class="p">);</span><span class="w"> </span><span class="cm">/* done; enable kernel preemption */</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="n">per_cpu</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">cpu</span><span class="p">)</span><span class="o">++</span><span class="p">;</span><span class="w"> </span><span class="cm">/* increment name on the given processor */</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="c1">// è¿è¡Œæ—¶</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="nf">alloc_percpu</span><span class="p">(</span><span class="n">type</span><span class="p">);</span><span class="w"> </span><span class="cm">/* a macro */</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="nf">__alloc_percpu</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">align</span><span class="p">);</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="kt">void</span><span class="w"> </span><span class="nf">free_percpu</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="p">);</span>
</span></code></pre></div>
<p>Per-CPU Data æœ‰ä¸€äº›ç‰¹ç‚¹ï¼š</p>
<ul>
<li>ä¸€å®šè¦æ³¨æ„ä¿è¯åªæœ‰ä¸€ä¸ª CPU è®¿é—®æ•°æ®</li>
<li>æ˜¾è‘—å‡å°‘äº†ç¼“å­˜å¤±æ•ˆï¼šå¦‚æœ CPU æ›´æ”¹å…¶ä»– CPU ç¼“å­˜äº†çš„æ•°æ®ï¼Œå¿…é¡»å°†å®ƒä»¬ flush æ‰ä»¥ä¿æŒä¸€è‡´æ€§ã€‚</li>
<li>Linux æä¾›çš„ Per-CPU æ¥å£å°†æ•°æ®æŒ‰ç¼“å­˜å¯¹é½ï¼ˆcache-alignï¼‰ï¼Œç¡®ä¿è®¿é—®å• CPU çš„æ•°æ®ä¸ä¼šå¸¦å…¥åŒç¼“å­˜è¡Œä¸­å…¶ä»– CPU çš„æ•°æ®ã€‚</li>
<li>å› æ­¤ï¼Œä½¿ç”¨ Per-CPU æ•°æ®æå°‘éœ€è¦é”ã€‚</li>
</ul>
<h3 id="_14">å†…å­˜åˆ†é…æ€»ç»“<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h3>
<ul>
<li>å¦‚æœéœ€è¦è¿ç»­ç‰©ç†é¡µï¼Œä½¿ç”¨åº•å±‚é¡µåˆ†é…å™¨ <code>kmalloc()</code>ã€‚</li>
<li>éœ€è¦ä»é«˜å†…å­˜åˆ†é…ï¼Œç”¨ <code>alloc_pages()</code>ã€‚</li>
<li>åªéœ€è¦è™šæ‹Ÿè¿ç»­ï¼Œç”¨ <code>vmalloc()</code>ã€‚</li>
<li>åˆ›å»ºå¹¶é”€æ¯å¤§é‡å¯¹è±¡æ•°æ®ï¼Œä½¿ç”¨ Slab Cacheã€‚å®ƒç»´æŠ¤ Per-CPU å¯¹è±¡ç¼“å­˜ã€‚</li>
</ul>
<h2 id="15">ç¬¬ 15 ç« ï¼šè¿›ç¨‹åœ°å€ç©ºé—´<a class="headerlink" href="#15" title="Permanent link">&para;</a></h2>
<p>å¯¹äºå•ä¸ªè¿›ç¨‹æ¥è¯´ï¼Œå†…å­˜å°±å¥½åƒå®ƒç‹¬è‡ªæ‹¥æœ‰æ•´ä¸ªç³»ç»Ÿçš„ç‰©ç†å†…å­˜ä¸€æ ·ã€‚å•ä¸ªè¿›ç¨‹çš„åœ°å€ç©ºé—´å¯èƒ½æ¯”ç‰©ç†å†…å­˜å¤§å¾—å¤šã€‚</p>
<h3 id="_15">åœ°å€ç©ºé—´<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h3>
<ul>
<li>å¹³å¦ï¼ˆflatï¼‰ï¼šåœ°å€ç©ºé—´å­˜åœ¨äºä¸€ä¸ªè¿ç»­çš„åœ°å€èŒƒå›´å†…ï¼Œå¦‚ 32 ä½ä¸º <span class="arithmatex">\(0 \sim 2^{32}-1\)</span>ã€‚</li>
<li>åˆ†æ®µï¼ˆsegmentedï¼‰ï¼šåœ°å€ç©ºé—´ç”±å¤šä¸ªæ®µç»„æˆï¼Œæ¯ä¸ªæ®µæœ‰è‡ªå·±çš„åŸºå€å’Œå¤§å°ã€‚</li>
</ul>
<p>ç°ä»£è™šæ‹Ÿå†…å­˜æ“ä½œç³»ç»Ÿéƒ½ä½¿ç”¨å¹³å¦åœ°å€ç©ºé—´ï¼ŒLinux ä¹Ÿä¸ä¾‹å¤–ã€‚</p>
<p>åœ°å€ç©ºé—´å¯¹å•ä¸ªè¿›ç¨‹å”¯ä¸€ï¼Œä¸åŒè¿›ç¨‹ç›¸åŒåœ°å€æ²¡æœ‰ä»»ä½•å…³ç³»ã€‚ä¸è¿‡ï¼Œæˆ‘ä»¬çŸ¥é“çº¿ç¨‹å¯ä»¥å…±äº«åœ°å€ç©ºé—´ã€‚</p>
<p>æˆ‘ä»¬åªå¯¹åœ°å€ç©ºé—´è¿›ç¨‹æœ‰æƒé™è®¿é—®ï¼ˆlegalï¼‰çš„å†…å­˜åŒºåŸŸï¼ˆmemory areaï¼‰æ„Ÿå…´è¶£ã€‚è¿›ç¨‹å¯ä»¥é€šè¿‡å†…æ ¸åŠ¨æ€æ·»åŠ å’Œåˆ é™¤å†…å­˜åŒºåŸŸã€‚è¿›ç¨‹è®¿é—®ä¸åœ¨å†…å­˜åŒºåŸŸä¸­çš„åœ°å€ï¼Œæˆ–ä»¥é”™è¯¯çš„æ–¹å¼è®¿é—®å†…å­˜åŒºåŸŸä¸­çš„åœ°å€æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šç»ˆæ­¢è¿›ç¨‹å¹¶æŠ¥å‘Šæ®µé”™è¯¯ã€‚</p>
<p>å†…å­˜åŒºåŸŸä¸­åŒ…å«çš„ä¸œè¥¿ä¾‹å¦‚ï¼š</p>
<ul>
<li>mmap of text sectionï¼šä»£ç çš„å†…å­˜æ˜ å°„</li>
<li>mmap of data sectionï¼šåˆå§‹åŒ–çš„å…¨å±€å˜é‡çš„å†…å­˜æ˜ å°„</li>
<li>mmap of zero pageï¼šæœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡çš„å†…å­˜æ˜ å°„ï¼Œå¯èƒ½ç”¨äºç”¨æˆ·ç©ºé—´æ ˆæˆ–è€… bss æ®µ</li>
<li>è½½å…¥å†…å­˜çš„åŠ¨æ€é“¾æ¥å™¨å’Œå…±äº«åº“çš„å„ç§æ®µ</li>
<li>mmap çš„æ–‡ä»¶</li>
<li>å…±äº«å†…å­˜æ®µ</li>
<li>åŒ¿åå†…å­˜æ˜ å°„ï¼ˆ<code>malloc()</code>ï¼‰</li>
</ul>
<h3 id="_16">å†…å­˜æè¿°ç¬¦<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h3>
<p>å†…æ ¸ä½¿ç”¨ <code>struct mm_struct</code> æè¿°è¿›ç¨‹çš„åœ°å€ç©ºé—´ã€‚</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">mm_struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">vm_area_struct</span><span class="w">   </span><span class="o">*</span><span class="n">mmap</span><span class="p">;</span><span class="w">          </span><span class="cm">/* list of memory areas */</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">rb_root</span><span class="w">          </span><span class="n">mm_rb</span><span class="p">;</span><span class="w">          </span><span class="cm">/* red-black tree of VMAs */</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">vm_area_struct</span><span class="w">   </span><span class="o">*</span><span class="n">mmap_cache</span><span class="p">;</span><span class="w">    </span><span class="cm">/* last used VMA */</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w">           </span><span class="n">free_area_cache</span><span class="p">;</span><span class="cm">/* 1st addr space hole */</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="w">    </span><span class="n">pgd_t</span><span class="w">                   </span><span class="o">*</span><span class="n">pgd</span><span class="p">;</span><span class="w">           </span><span class="cm">/* page global directory */</span>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="w">    </span><span class="n">atomic_t</span><span class="w">                </span><span class="n">mm_users</span><span class="p">;</span><span class="w">       </span><span class="cm">/* number of users */</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="w">    </span><span class="n">atomic_t</span><span class="w">                </span><span class="n">mm_count</span><span class="p">;</span><span class="w">       </span><span class="cm">/* number of references */</span>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a><span class="w">    </span><span class="kt">int</span><span class="w">                     </span><span class="n">map_count</span><span class="p">;</span><span class="w">      </span><span class="cm">/* number of VMAs */</span>
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">rw_semaphore</span><span class="w">     </span><span class="n">mmap_sem</span><span class="p">;</span><span class="w">       </span><span class="cm">/* VMA semaphore */</span>
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a><span class="w">    </span><span class="n">spinlock_t</span><span class="w">              </span><span class="n">page_table_lock</span><span class="p">;</span><span class="cm">/* page table lock */</span>
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">list_head</span><span class="w">        </span><span class="n">mmlist</span><span class="p">;</span><span class="w">         </span><span class="cm">/* list of all mm_structs */</span>
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a><span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w">           </span><span class="n">start_code</span><span class="p">,</span><span class="w"> </span><span class="n">end_code</span><span class="p">,</span><span class="w">   </span><span class="cm">/* code */</span>
</span><span id="__span-24-14"><a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a><span class="w">                            </span><span class="n">start_data</span><span class="p">,</span><span class="w"> </span><span class="n">end_data</span><span class="p">,</span><span class="w">   </span><span class="cm">/* data */</span>
</span><span id="__span-24-15"><a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a><span class="w">                            </span><span class="n">start_brk</span><span class="p">,</span><span class="w"> </span><span class="n">brk</span><span class="p">,</span><span class="w">         </span><span class="cm">/* heap */</span>
</span><span id="__span-24-16"><a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a><span class="w">                            </span><span class="n">start_stack</span><span class="p">,</span><span class="w">            </span><span class="cm">/* stack */</span>
</span><span id="__span-24-17"><a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a><span class="w">                            </span><span class="n">arg_start</span><span class="p">,</span><span class="w"> </span><span class="n">arg_end</span><span class="p">,</span><span class="w">     </span><span class="cm">/* arguments */</span>
</span><span id="__span-24-18"><a id="__codelineno-24-18" name="__codelineno-24-18" href="#__codelineno-24-18"></a><span class="w">                            </span><span class="n">env_start</span><span class="p">,</span><span class="w"> </span><span class="n">env_end</span><span class="p">;</span><span class="w">     </span><span class="cm">/* environment */</span>
</span><span id="__span-24-19"><a id="__codelineno-24-19" name="__codelineno-24-19" href="#__codelineno-24-19"></a><span class="w">                            </span><span class="n">rss</span><span class="p">,</span><span class="w"> </span><span class="n">total_vm</span><span class="p">,</span><span class="w"> </span><span class="n">locked_vm</span><span class="p">;</span><span class="w">   </span><span class="cm">/* pages */</span>
</span><span id="__span-24-20"><a id="__codelineno-24-20" name="__codelineno-24-20" href="#__codelineno-24-20"></a><span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w">           </span><span class="n">saved_auxv</span><span class="p">[</span><span class="n">AT_VECTOR_SIZE</span><span class="p">];</span><span class="w"> </span><span class="cm">/* for /proc/PID/auxv */</span>
</span><span id="__span-24-21"><a id="__codelineno-24-21" name="__codelineno-24-21" href="#__codelineno-24-21"></a><span class="w">    </span><span class="kt">cpumask_t</span><span class="w">               </span><span class="n">cpu_vm_mask</span><span class="p">;</span><span class="w">    </span><span class="cm">/* lazy TLB switch mask */</span>
</span><span id="__span-24-22"><a id="__codelineno-24-22" name="__codelineno-24-22" href="#__codelineno-24-22"></a><span class="w">    </span><span class="n">mm_context_t</span><span class="w">            </span><span class="n">context</span><span class="p">;</span><span class="w">        </span><span class="cm">/* architecture-specific data */</span>
</span><span id="__span-24-23"><a id="__codelineno-24-23" name="__codelineno-24-23" href="#__codelineno-24-23"></a><span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w">           </span><span class="n">flags</span><span class="p">;</span><span class="w">          </span><span class="cm">/* status flags */</span>
</span><span id="__span-24-24"><a id="__codelineno-24-24" name="__codelineno-24-24" href="#__codelineno-24-24"></a><span class="w">    </span><span class="kt">int</span><span class="w">                     </span><span class="n">core_waiters</span><span class="p">;</span><span class="w">   </span><span class="cm">/* thread core dump waiters */</span>
</span><span id="__span-24-25"><a id="__codelineno-24-25" name="__codelineno-24-25" href="#__codelineno-24-25"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">core_state</span><span class="w">       </span><span class="o">*</span><span class="n">core_state</span><span class="p">;</span><span class="w">    </span><span class="cm">/* core dump info */</span>
</span><span id="__span-24-26"><a id="__codelineno-24-26" name="__codelineno-24-26" href="#__codelineno-24-26"></a><span class="w">    </span><span class="n">spinlock_t</span><span class="w">              </span><span class="n">ioctx_lock</span><span class="p">;</span><span class="w">     </span><span class="cm">/* AIO I/O list lock */</span>
</span><span id="__span-24-27"><a id="__codelineno-24-27" name="__codelineno-24-27" href="#__codelineno-24-27"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">hlist_head</span><span class="w">       </span><span class="n">ioctx_list</span><span class="p">;</span><span class="w">     </span><span class="cm">/* AIO I/O list */</span>
</span><span id="__span-24-28"><a id="__codelineno-24-28" name="__codelineno-24-28" href="#__codelineno-24-28"></a><span class="p">}</span>
</span></code></pre></div>
<p><code>mm_struct</code> é€šè¿‡ <code>mmlist</code> æ„æˆåŒå‘é“¾è¡¨ï¼Œé“¾è¡¨æœ€åˆçš„å…ƒç´ æ˜¯ <code>init_mm</code>ã€‚é“¾è¡¨é€šè¿‡ <code>mmlist_lock</code> ä¿æŠ¤ã€‚</p>
<ul>
<li>åˆ†é…å†…å­˜æè¿°ç¬¦ï¼š<ul>
<li>ç”± <code>allocate_mm()</code> ä» Slab å±‚çš„ <code>mm_cachep</code> åˆ†é…ã€‚</li>
<li><code>task_struct</code> ä¸­æœ‰ä¸€ä¸ª <code>mm</code> æŒ‡é’ˆï¼ŒæŒ‡å‘ <code>mm_struct</code>ã€‚</li>
<li>åœ¨ <code>fork()</code> ä¸­ï¼Œ<code>copy_mm()</code> å°†çˆ¶è¿›ç¨‹çš„ <code>mm_struct</code> å¤åˆ¶ç»™å­è¿›ç¨‹ã€‚</li>
<li><code>clone()</code> ä¼ å…¥ <code>CLONE_VM</code> æ ‡å¿—æ—¶ï¼Œ<code>copy_mm</code> ä½¿å­è¿›ç¨‹çš„ <code>mm</code> <strong>æŒ‡å‘</strong> çˆ¶è¿›ç¨‹çš„ <code>mm</code>ï¼Œè€Œä¸æ˜¯å¤åˆ¶ã€‚</li>
</ul>
</li>
<li>é”€æ¯å†…å­˜æè¿°ç¬¦ï¼š<ul>
<li><code>exit_mm()</code> é‡Šæ”¾å†…å­˜æè¿°ç¬¦ã€‚</li>
<li><code>mmput()</code> å‡å°‘ <code>mm_users</code> è®¡æ•°ï¼Œå¦‚æœä¸º 0ï¼Œåˆ™è°ƒç”¨ <code>mmdrop()</code> å‡å°‘ <code>mm_count</code> è®¡æ•°ï¼Œå¦‚æœä¸º 0ï¼Œåˆ™è°ƒç”¨ <code>free_mm()</code> é€šè¿‡ <code>kmem_cache_free()</code> é‡Šæ”¾å†…å­˜æè¿°ç¬¦ã€‚</li>
</ul>
</li>
</ul>
<p>åœ¨å‰æ–‡æˆ‘ä»¬äº†è§£åˆ°ï¼Œå†…æ ¸çº¿ç¨‹æ²¡æœ‰åœ°å€ç©ºé—´ã€‚ä½†å®ƒéœ€è¦ä½¿ç”¨é¡µè¡¨è®¿é—®å†…æ ¸å†…å­˜ã€‚å› æ­¤ï¼Œå†…æ ¸çº¿ç¨‹ç›´æ¥ä½¿ç”¨ä¸Šä¸€ä¸ªè¿›ç¨‹çš„ <code>mm</code>ï¼Œä½†å®ƒä¸ä¼šè®¿é—®ç”¨æˆ·ç©ºé—´å†…å­˜ï¼Œåªä¼šåˆ©ç”¨åœ°å€ç©ºé—´ä¸­å…³äºå†…æ ¸å†…å­˜çš„ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯åœ¨æ‰€æœ‰è¿›ç¨‹ä¸­éƒ½æ˜¯ç›¸åŒçš„ã€‚</p>
<p>å½“è¿›ç¨‹è¢«è°ƒåº¦æ—¶ï¼Œè¿›ç¨‹æè¿°ç¬¦ä¸­çš„ <code>active_mm</code> æ›´æ–°ä¸º <code>mm</code>ã€‚å†…æ ¸çº¿ç¨‹çš„ <code>mm</code> æ˜¯ <code>NULL</code>ï¼Œåœ¨è°ƒåº¦å†…æ ¸çº¿ç¨‹æ—¶ï¼Œå†…æ ¸ç‰¹åœ°å°†å…¶ <code>active_mm</code> æ›´æ–°ä¸ºä¸Šä¸€ä¸ªè¿›ç¨‹çš„ <code>mm</code>ã€‚</p>
<h3 id="vma">VMA<a class="headerlink" href="#vma" title="Permanent link">&para;</a></h3>
<div class="language-c highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">vm_area_struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">mm_struct</span><span class="w"> </span><span class="o">*</span><span class="n">vm_mm</span><span class="p">;</span><span class="w">    </span><span class="cm">/* associated mm_struct */</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">vm_start</span><span class="p">;</span><span class="w">     </span><span class="cm">/* VMA start, inclusive */</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">vm_end</span><span class="p">;</span><span class="w">       </span><span class="cm">/* VMA end, exclusive */</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">vm_area_struct</span><span class="w"> </span><span class="o">*</span><span class="n">vm_next</span><span class="p">;</span><span class="w"> </span><span class="cm">/* VMA list */</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="w">    </span><span class="n">pgprot_t</span><span class="w"> </span><span class="n">vm_page_prot</span><span class="p">;</span><span class="w">      </span><span class="cm">/* access permissions */</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">vm_flags</span><span class="p">;</span><span class="w">     </span><span class="cm">/* flags */</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">rb_node</span><span class="w"> </span><span class="n">vm_rb</span><span class="p">;</span><span class="w">       </span><span class="cm">/* red-black tree node */</span>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">list_head</span><span class="w"> </span><span class="n">vm_list</span><span class="p">;</span><span class="w">   </span><span class="cm">/* VMA list */</span>
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a><span class="w">    </span><span class="k">union</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="cm">/* links to address_space-&gt;i_mmap or i_mmap_nonlinear */</span>
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a><span class="w">        </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-12"><a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a><span class="w">            </span><span class="k">struct</span><span class="w"> </span><span class="nc">list_head</span><span class="w"> </span><span class="n">list</span><span class="p">;</span>
</span><span id="__span-25-13"><a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a><span class="w">            </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">parent</span><span class="p">;</span>
</span><span id="__span-25-14"><a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a><span class="w">            </span><span class="k">struct</span><span class="w"> </span><span class="nc">vm_area_struct</span><span class="w"> </span><span class="o">*</span><span class="n">head</span><span class="p">;</span>
</span><span id="__span-25-15"><a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="n">vm_set</span><span class="p">;</span>
</span><span id="__span-25-16"><a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a><span class="w">        </span><span class="k">struct</span><span class="w"> </span><span class="nc">prio_tree_node</span><span class="w"> </span><span class="n">prio_tree_node</span><span class="p">;</span>
</span><span id="__span-25-17"><a id="__codelineno-25-17" name="__codelineno-25-17" href="#__codelineno-25-17"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="n">shared</span><span class="p">;</span>
</span><span id="__span-25-18"><a id="__codelineno-25-18" name="__codelineno-25-18" href="#__codelineno-25-18"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">list_head</span><span class="w"> </span><span class="n">anon_vma_node</span><span class="p">;</span><span class="w"> </span><span class="cm">/* anonymous VMA list */</span>
</span><span id="__span-25-19"><a id="__codelineno-25-19" name="__codelineno-25-19" href="#__codelineno-25-19"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">anon_vma</span><span class="w"> </span><span class="o">*</span><span class="n">anon_vma</span><span class="p">;</span><span class="w">      </span><span class="cm">/* anonymous VMA object */</span>
</span><span id="__span-25-20"><a id="__codelineno-25-20" name="__codelineno-25-20" href="#__codelineno-25-20"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">vm_operations_struct</span><span class="w"> </span><span class="o">*</span><span class="n">vm_ops</span><span class="p">;</span><span class="w"> </span><span class="cm">/* VMA operations */</span>
</span><span id="__span-25-21"><a id="__codelineno-25-21" name="__codelineno-25-21" href="#__codelineno-25-21"></a><span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">vm_pgoff</span><span class="p">;</span><span class="w">     </span><span class="cm">/* offset in PAGE_SIZE units */</span>
</span><span id="__span-25-22"><a id="__codelineno-25-22" name="__codelineno-25-22" href="#__codelineno-25-22"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">file</span><span class="w"> </span><span class="o">*</span><span class="n">vm_file</span><span class="p">;</span><span class="w">       </span><span class="cm">/* mapped file, if any */</span>
</span><span id="__span-25-23"><a id="__codelineno-25-23" name="__codelineno-25-23" href="#__codelineno-25-23"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">vm_private_data</span><span class="p">;</span><span class="w">      </span><span class="cm">/* private data */</span>
</span><span id="__span-25-24"><a id="__codelineno-25-24" name="__codelineno-25-24" href="#__codelineno-25-24"></a><span class="p">}</span>
</span></code></pre></div>
<p>VMA flags çš„è¡Œä¸ºç”±å†…æ ¸è´Ÿè´£ã€‚ä¸ä¹‹ç›¸æ¯”ï¼Œç‰©ç†å†…å­˜çš„ flags ç”±ç¡¬ä»¶ MMU è´Ÿè´£ã€‚ä¸€äº›é‡è¦çš„ flagsï¼š</p>
<ul>
<li><code>VM_READ</code>ã€<code>VM_WRITE</code>ã€<code>VM_EXEC</code>ï¼šè¯»ã€å†™ã€æ‰§è¡Œæƒé™ã€‚</li>
<li><code>VM_SHARED</code>ï¼šæ˜¯å¦åŒ…å«ä¸€ä¸ªåœ¨å¤šè¿›ç¨‹é—´å…±äº«çš„æ˜ å°„ã€‚</li>
<li><code>VM_IO</code>ï¼šæ˜ å°„çš„æ˜¯è®¾å¤‡ I/O ç©ºé—´ï¼Œé€šå¸¸ç”±è®¾å¤‡é©±åŠ¨ä½¿ç”¨ <code>mmap()</code> æ˜ å°„ã€‚</li>
<li><code>VM_RESERVED</code>ï¼šä¸å¯äº¤æ¢ã€‚</li>
<li><code>VM_SEQ_READ</code>ï¼šé¡ºåºè¯»ï¼Œå¯ä»¥è¿›è¡Œ read-ahead ä¼˜åŒ–ã€‚</li>
<li><code>VM_RAND_READ</code></li>
</ul>
<p><code>vm_operations_struct</code> æ˜¯ä¸€ç»„å‡½æ•°æŒ‡é’ˆï¼Œç”¨äºå¤„ç† VMA çš„æ“ä½œã€‚</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">vm_operations_struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">open</span><span class="p">)(</span><span class="k">struct</span><span class="w"> </span><span class="nc">vm_area_struct</span><span class="w"> </span><span class="o">*</span><span class="n">vma</span><span class="p">);</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">close</span><span class="p">)(</span><span class="k">struct</span><span class="w"> </span><span class="nc">vm_area_struct</span><span class="w"> </span><span class="o">*</span><span class="n">vma</span><span class="p">);</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">fault</span><span class="p">)(</span><span class="k">struct</span><span class="w"> </span><span class="nc">vm_area_struct</span><span class="w"> </span><span class="o">*</span><span class="n">vma</span><span class="p">,</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">vm_fault</span><span class="w"> </span><span class="o">*</span><span class="n">vmf</span><span class="p">);</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">page_mkwrite</span><span class="p">)(</span><span class="k">struct</span><span class="w"> </span><span class="nc">vm_area_struct</span><span class="w"> </span><span class="o">*</span><span class="n">vma</span><span class="p">,</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">vm_fault</span><span class="w"> </span><span class="o">*</span><span class="n">vmf</span><span class="p">);</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">access</span><span class="p">)(</span><span class="k">struct</span><span class="w"> </span><span class="nc">vm_area_struct</span><span class="w"> </span><span class="o">*</span><span class="n">vma</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">addr</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">len</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">write</span><span class="p">);</span>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="_17">å†…å­˜åŒºåŸŸåˆ—è¡¨å’Œæ ‘<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h3>
<p>ä¸‹é¢ä¸¤ä¸ªæ•°æ®ç»“æ„ä¸­çš„å…ƒç´ éƒ½æ˜¯ <code>struct vm_area_struct</code>ï¼š</p>
<ul>
<li><code>mm_rb</code> æ˜¯çº¢é»‘æ ‘ï¼Œé€šè¿‡ <code>vm_rb</code> é“¾å…¥ã€‚</li>
<li><code>mmap</code> æ˜¯å•å‘é“¾è¡¨ï¼ˆsingly linked listï¼‰ï¼Œé€šè¿‡ <code>vm_next</code> å‡åºï¼ˆascendï¼‰è¿æ¥ã€‚</li>
</ul>
<p>è¿™ä¸¤ä¸ªå¹¶ä¸æ˜¯åˆ†å¼€çš„æ•°æ®ç»“æ„ï¼Œå…¶å®æ˜¯çº¿æ®µæ ‘ï¼ˆthreaded treeï¼‰ï¼Œé“¾è¡¨è¦†ç›–åœ¨æ ‘ä¸Šã€‚</p>
<p>å¯ä»¥ä½¿ç”¨ <code>pmap</code> æˆ– <code>/proc</code> æ–‡ä»¶ç³»ç»ŸæŸ¥çœ‹è¿›ç¨‹çš„åœ°å€ç©ºé—´ã€‚</p>
<h3 id="_18">æ“ä½œå†…å­˜åŒºåŸŸ<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h3>
<div class="language-c highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">vm_area_struct</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">find_vma</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">mm_struct</span><span class="w"> </span><span class="o">*</span><span class="n">mm</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">addr</span><span class="p">);</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="k">struct</span><span class="w"> </span><span class="nc">vm_area_struct</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">find_vma_prev</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">mm_struct</span><span class="w"> </span><span class="o">*</span><span class="n">mm</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">addr</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="w">                                      </span><span class="k">struct</span><span class="w"> </span><span class="nc">vm_area_struct</span><span class="w"> </span><span class="o">**</span><span class="n">pprev</span><span class="p">);</span>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="k">static</span><span class="w"> </span><span class="kr">inline</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">vm_area_struct</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="n">find_vma_intersection</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">mm_struct</span><span class="w"> </span><span class="o">*</span><span class="n">mm</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">start_addr</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="w">                      </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">end_addr</span><span class="p">);</span>
</span></code></pre></div>
<p>ä¸‹é¢ä¸¤ä¸ªå‡½æ•°åˆ›å»ºåœ°å€åŒºé—´ï¼š</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="nf">do_mmap</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">file</span><span class="w"> </span><span class="o">*</span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">addr</span><span class="p">,</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="w">                        </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">len</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">prot</span><span class="p">,</span>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="w">                        </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">flag</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">offset</span><span class="p">);</span>
</span></code></pre></div>
<p>å¦‚æœåˆ›å»ºçš„åœ°å€åŒºé—´ä¸æŸä¸ªå·²å­˜åœ¨çš„åŒºé—´ç›¸é‚»ä¸”æƒé™ç›¸åŒï¼Œåˆ™ä¼šè¢«åˆå¹¶ã€‚</p>
<p>æ˜ å°„ <code>file</code> çš„ <code>offset</code> å¼€å§‹çš„ <code>len</code> å­—èŠ‚åˆ° <code>addr</code> å¼€å§‹çš„åœ°å€ã€‚<code>file</code> ä¸º <code>NULL</code> æ—¶ä¸æ˜¯æ–‡ä»¶æ˜ å°„ï¼ˆfile-backed mapping)ï¼Œç§°ä¸ºåŒ¿åæ˜ å°„ï¼ˆanonymous mappingï¼‰ã€‚</p>
<p><code>prot</code> è¡¨ç¤ºæƒé™ï¼ˆpage protectionï¼‰ï¼Œä¸æ¶æ„æœ‰å…³ï¼Œä¸€èˆ¬æ˜¯ <code>PROT_READ</code>ã€<code>PROT_WRITE</code>ã€<code>PROT_EXEC</code>ã€<code>PROT_NONE</code>ã€‚</p>
<p><code>flag</code> ä¸å‰©ä½™çš„ VMA flags å¯¹åº”ï¼Œä»¥ <code>MAP_</code> å¼€å¤´ã€‚</p>
<p><code>do_mmap()</code> ä½œä¸ºç³»ç»Ÿè°ƒç”¨ <code>mmap()</code> è¢«å¯¼å‡ºè‡³ç”¨æˆ·ç©ºé—´ã€‚</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="nf">mmap2</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">start</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">length</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">prot</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">flags</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">fd</span><span class="p">,</span><span class="w"> </span><span class="kt">off_t</span><span class="w"> </span><span class="n">pgoff</span><span class="p">);</span>
</span></code></pre></div>
<p>ä¸ <code>mmap()</code> çš„åŒºåˆ«åœ¨äº <code>pgoff</code> æ˜¯ä»¥é¡µé¢ä¸ºå•ä½çš„åç§»é‡ï¼Œè€Œ <code>mmap()</code> æ˜¯ä»¥å­—èŠ‚ä¸ºå•ä½çš„ã€‚<code>mmap()</code> ä½¿ç”¨ <code>mmap2()</code> ä½œä¸ºåç«¯ã€‚</p>
<p>ä¸‹é¢ä¸¤ä¸ªå‡½æ•°ç§»é™¤åœ°å€åŒºé—´ï¼š</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="kt">int</span><span class="w"> </span><span class="nf">do_munmap</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">mm_struct</span><span class="w"> </span><span class="o">*</span><span class="n">mm</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">start</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">len</span><span class="p">);</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="kt">int</span><span class="w"> </span><span class="nf">munmap</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">start</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">len</span><span class="p">);</span>
</span></code></pre></div>
<h3 id="_19">é¡µè¡¨<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h3>
<p>åœ¨å¤„ç†å™¨è§£æè¯·æ±‚å‰ï¼Œè™šæ‹Ÿåœ°å€å¿…é¡»è¢«è½¬æ¢ä¸ºç‰©ç†åœ°å€ã€‚è™šæ‹Ÿåœ°å€è¢«åˆ’åˆ†ä¸ºåŒºå—ï¼Œä½œä¸ºé¡µè¡¨çš„ç´¢å¼•ï¼ˆindexï¼‰ã€‚è¡¨é¡¹æŒ‡å‘å…¶ä»–è¡¨æˆ–è€…ç›¸å…³çš„ç‰©ç†é¡µã€‚</p>
<p>Linux ä¸­çš„é¡µè¡¨æœ‰ä¸‰çº§ç»“æ„ï¼Œå½¢æˆä¸€ä¸ªç¨€ç–å¡«å……çš„åœ°å€ç©ºé—´ã€‚ä»ä¸Šåˆ°ä¸‹åˆ†åˆ«æ˜¯ï¼š</p>
<ul>
<li>Page Global Directoryï¼ˆPGDï¼‰ï¼š<code>pgd_t</code> çš„æ•°ç»„ï¼Œæ¯ä¸ªè¡¨é¡¹æŒ‡å‘ PMD ä¸­çš„è¡¨é¡¹ã€‚</li>
<li>Page Middle Directoryï¼ˆPMDï¼‰ï¼š<code>pmd_t</code> çš„æ•°ç»„ï¼Œæ¯ä¸ªè¡¨é¡¹æŒ‡å‘ PTE ä¸­çš„è¡¨é¡¹ã€‚</li>
<li>Page Table Entryï¼ˆPTEï¼‰ï¼š<code>pte_t</code> çš„æ•°ç»„ï¼Œæ¯ä¸ªè¡¨é¡¹æŒ‡å‘ç‰©ç†é¡µã€‚</li>
</ul>
<p><a class="glightbox" href="../lkd3.assets/ch15_vp.webp" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="ch15_vp" src="../lkd3.assets/ch15_vp.webp" /></a></p>
<p>åœ¨é¡µè¡¨ä¸Šéå†å’Œæ“ä½œéœ€è¦è·å–å†…å­˜æè¿°ç¬¦ä¸­çš„ <code>page_table_lock</code>ã€‚</p>
<p>é¡µè¡¨æ•°æ®ç»“æ„ä¸æ¶æ„æœ‰å¾ˆå¤§å…³ç³»ã€‚</p>
<p>å¤§å¤šæ•°å¤„ç†å™¨è¿˜å®ç° TLBï¼ˆTranslation Lookaside Bufferï¼‰ç¼“å­˜ï¼Œå¤„ç†å™¨é¦–å…ˆæŸ¥æ‰¾ TLBï¼Œå¦‚æœæ²¡æœ‰å‘½ä¸­ï¼Œå†æŸ¥æ‰¾é¡µè¡¨ã€‚</p>
<p>åœ¨ 2.6ï¼Œå†…æ ¸ä¸­çš„é¡µè¡¨ä»ç„¶åœ¨å¿«é€Ÿæ¼”å˜ã€‚</p>
<h2 id="16">ç¬¬ 16 ç« ï¼šé¡µç¼“å­˜å’Œé¡µå†™å›<a class="headerlink" href="#16" title="Permanent link">&para;</a></h2>
<p>Linux å®ç°ç£ç›˜ç¼“å­˜ï¼Œé€šè¿‡å°†æ•°æ®ä¿å­˜åœ¨å†…å­˜ä¸­å‡å°‘ç£ç›˜ I/O æ“ä½œï¼Œç§°ä¸ºé¡µç¼“å­˜ï¼ˆpage cacheï¼‰ã€‚</p>
<div class="admonition todo">
<p class="admonition-title">æš‚ç•¥ã€‚</p>
</div>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="June 25, 2025 12:00:40 UTC">June 25, 2025</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../%F0%9F%93%96%20Linux%20Device%20Drivers%20%283rd%29/" class="md-footer__link md-footer__link--prev" aria-label="Previous: ğŸ“– Linux Device Drivers (3rd)">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                ğŸ“– Linux Device Drivers (3rd)
              </div>
            </div>
          </a>
        
        
          
          <a href="../../%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/" class="md-footer__link md-footer__link--next" aria-label="Next: æ–‡ä»¶ç³»ç»Ÿ">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                æ–‡ä»¶ç³»ç»Ÿ
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      <a href="https://beian.miit.gov.cn/" target="_blank">æµ™ICPå¤‡2022036274å·-1</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://bowling233.com" target="_blank" rel="noopener" title="bowling233.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19.07 4.93C17.22 3 14.66 1.96 12 2c-2.66-.04-5.21 1-7.06 2.93C3 6.78 1.96 9.34 2 12c-.04 2.66 1 5.21 2.93 7.06C6.78 21 9.34 22.04 12 22c2.66.04 5.21-1 7.06-2.93C21 17.22 22.04 14.66 22 12c.04-2.66-1-5.22-2.93-7.07M17 12v6h-3.5v-5h-3v5H7v-6H5l7-7 7.5 7H17Z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "content.code.select", "content.code.annotate", "navigation.footer", "navigation.tabs", "navigation.sections", "navigation.expand", "navigation.indexes", "navigation.tracking", "navigation.path", "navigation.top", "toc.follow", "content.action.edit", "search.suggest", "search.highlight", "search.share"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.1e8ae164.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.alicdn.com/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://unpkg.com/tablesort/dist/tablesort.min.js"></script>
      
        <script src="../../../javascripts/tablesort.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>