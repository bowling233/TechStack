
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Bowling çš„ç¬”è®°æœ¬">
      
      
        <meta name="author" content="Bowling">
      
      
        <link rel="canonical" href="https://note.bowling233.top/Linux/%E5%86%85%E6%A0%B8/%F0%9F%93%96%20Linux%20Device%20Drivers%20%283rd%29/">
      
      
        <link rel="prev" href="../../%E5%90%AF%E5%8A%A8%E8%BF%87%E7%A8%8B/">
      
      
        <link rel="next" href="../%F0%9F%93%96%20Linux%20Kernel%20Development%20%283rd%29/">
      
      
      <link rel="icon" href="../../../assets/bowling.svg">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.17">
    
    
      
        <title>ğŸ“– Linux Device Drivers (3rd) - Bowling's TechStack</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.bcfcd587.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../../stylesheets/flink.css">
    
      <link rel="stylesheet" href="../../../stylesheets/neoteroi-mkdocs.css">
    
      <link rel="stylesheet" href="../../../stylesheets/custom.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-webfont@1.1.0/style.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-lite-webfont@1.1.0/style.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-tc-webfont@1.0.0/style.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-screen-webfont@1.1.0/style.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#linux-device-drivers-3rd" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Bowling&#39;s TechStack" class="md-header__button md-logo" aria-label="Bowling's TechStack" data-md-component="logo">
      
  <img src="../../../assets/bowling.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Bowling's TechStack
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ğŸ“– Linux Device Drivers (3rd)
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/bowling233/TechStack" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    TechStack
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  é¦–é¡µ

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../links/" class="md-tabs__link">
        
  
    
  
  å‹é“¾

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
    
  
  Linux

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E5%85%B6%E4%BB%96/%E6%94%B6%E8%97%8F%E5%A4%B9/" class="md-tabs__link">
          
  
    
  
  å…¶ä»–

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/LLM%20Infra/" class="md-tabs__link">
          
  
    
  
  åº”ç”¨é¢†åŸŸ

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E7%A7%91%E7%A0%94/%E8%8D%89%E7%A8%BF/" class="md-tabs__link">
          
  
    
  
  ç§‘ç ”

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E7%AE%97%E6%B3%95/%F0%9F%8F%AB%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%9F%BA%E7%A1%80/" class="md-tabs__link">
          
  
    
  
  ç®—æ³•

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/" class="md-tabs__link">
          
  
    
  
  ç³»ç»Ÿå’Œä½“ç³»ç»“æ„

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E7%BD%91%E7%BB%9C/%F0%9F%93%92%20%E4%BB%A3%E7%90%86%E4%B8%8E%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E7%BD%91/" class="md-tabs__link">
          
  
    
  
  ç½‘ç»œ

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E8%8D%89%E7%A8%BF/" class="md-tabs__link">
          
  
    
  
  è‰ç¨¿

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E8%AF%AD%E8%A8%80/go/" class="md-tabs__link">
          
  
    
  
  è¯­è¨€

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E9%AB%98%E6%80%A7%E8%83%BD/%E5%B9%B6%E8%A1%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/C%2B%2B%20%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" class="md-tabs__link">
          
  
    
  
  é«˜æ€§èƒ½

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Bowling&#39;s TechStack" class="md-nav__button md-logo" aria-label="Bowling's TechStack" data-md-component="logo">
      
  <img src="../../../assets/bowling.svg" alt="logo">

    </a>
    Bowling's TechStack
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/bowling233/TechStack" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    TechStack
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    é¦–é¡µ
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../links/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å‹é“¾
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Linux
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Linux
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%8F%91%E8%A1%8C%E7%89%88%E4%B8%8E%E5%8C%85%E7%AE%A1%E7%90%86/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å‘è¡Œç‰ˆä¸åŒ…ç®¡ç†
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%90%AF%E5%8A%A8%E8%BF%87%E7%A8%8B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å¯åŠ¨è¿‡ç¨‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" checked>
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    å†…æ ¸
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            å†…æ ¸
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    ğŸ“– Linux Device Drivers (3rd)
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    ğŸ“– Linux Device Drivers (3rd)
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬ä¸€ç« ï¼šè®¾å¤‡é©±åŠ¨ä»‹ç»
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬äºŒç« ï¼šæ„å»ºå’Œè¿è¡Œæ¨¡å—
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬äºŒç« ï¼šæ„å»ºå’Œè¿è¡Œæ¨¡å—">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      é…ç½®æµ‹è¯•ç³»ç»Ÿ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      æ ·ä¾‹æ¨¡å—
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      å†…æ ¸æ¨¡å—ä¸åº”ç”¨çš„å¯¹æ¯”
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      ç¼–è¯‘å’ŒåŠ è½½
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      å†…æ ¸ç¬¦å·è¡¨
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      å‡†å¤‡å·¥ä½œ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      åˆå§‹åŒ–å’Œå…³é—­
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      æ¨¡å—å‚æ•°
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      åœ¨ç”¨æˆ·ç©ºé—´å†…æ“ä½œ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬ä¸‰ç« ï¼šå­—ç¬¦è®¾å¤‡
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬ä¸‰ç« ï¼šå­—ç¬¦è®¾å¤‡">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scull" class="md-nav__link">
    <span class="md-ellipsis">
      scull çš„è®¾è®¡
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      ä¸»è¦å’Œæ¬¡è¦è®¾å¤‡å·
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      ä¸€äº›é‡è¦çš„æ•°æ®ç»“æ„
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      æ³¨å†Œå­—ç¬¦è®¾å¤‡
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      æ‰“å¼€å’Œé‡Šæ”¾
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scull_1" class="md-nav__link">
    <span class="md-ellipsis">
      scull çš„å†…å­˜ä½¿ç”¨
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      è¯»å’Œå†™
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      ä½¿ç”¨æ–°è®¾å¤‡
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬å››ç« ï¼šè°ƒè¯•æŠ€æœ¯
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬å››ç« ï¼šè°ƒè¯•æŠ€æœ¯">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      å†…æ ¸è°ƒè¯•æ”¯æŒ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      é€šè¿‡æ‰“å°è°ƒè¯•
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      é€šè¿‡æŸ¥è¯¢è°ƒè¯•
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    <span class="md-ellipsis">
      é€šè¿‡è§‚æµ‹è°ƒè¯•
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    <span class="md-ellipsis">
      è°ƒè¯•ç³»ç»Ÿé”™è¯¯
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    <span class="md-ellipsis">
      è°ƒè¯•å™¨å’Œç›¸å…³å·¥å…·
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬äº”ç« ï¼šå¹¶å‘å’Œç«äº‰æ¡ä»¶
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬äº”ç« ï¼šå¹¶å‘å’Œç«äº‰æ¡ä»¶">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    <span class="md-ellipsis">
      å¹¶å‘åŠå…¶ç®¡ç†
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#semaphoremutex" class="md-nav__link">
    <span class="md-ellipsis">
      æ——è¯­ï¼ˆSemaphoreï¼‰å’Œé”ï¼ˆMutexï¼‰
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    <span class="md-ellipsis">
      é”çš„å¸¸è§é”™è¯¯
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    <span class="md-ellipsis">
      é”çš„æ›¿ä»£å“
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬å…­ç« ï¼šé«˜çº§å­—ç¬¦é©±åŠ¨æ“ä½œ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬å…­ç« ï¼šé«˜çº§å­—ç¬¦é©±åŠ¨æ“ä½œ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ioctl" class="md-nav__link">
    <span class="md-ellipsis">
      ioctl
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#io" class="md-nav__link">
    <span class="md-ellipsis">
      é˜»å¡ I/O
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_31" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬ä¸ƒç« ï¼šæ—¶é—´ã€å»¶è¿Ÿä¸å»¶åå·¥ä½œ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬ä¸ƒç« ï¼šæ—¶é—´ã€å»¶è¿Ÿä¸å»¶åå·¥ä½œ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_32" class="md-nav__link">
    <span class="md-ellipsis">
      æµ‹é‡æ—¶é—´
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_33" class="md-nav__link">
    <span class="md-ellipsis">
      å»¶è¿Ÿæ‰§è¡Œ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬å…«ç« ï¼šåˆ†é…å†…å­˜
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬å…«ç« ï¼šåˆ†é…å†…å­˜">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kmalloc" class="md-nav__link">
    <span class="md-ellipsis">
      kmalloc çš„ç»†èŠ‚
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lookaside" class="md-nav__link">
    <span class="md-ellipsis">
      Lookaside ç¼“å­˜
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_35" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬ä¹ç« ï¼šä¸ç¡¬ä»¶æ²Ÿé€š
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬ä¹ç« ï¼šä¸ç¡¬ä»¶æ²Ÿé€š">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#io-io" class="md-nav__link">
    <span class="md-ellipsis">
      I/O ç«¯å£å’Œ I/O å†…å­˜
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#io_1" class="md-nav__link">
    <span class="md-ellipsis">
      ä½¿ç”¨ I/O ç«¯å£
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#io_2" class="md-nav__link">
    <span class="md-ellipsis">
      ä¸€ä¸ª I/O ç«¯å£ä¾‹å­
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-io-memory" class="md-nav__link">
    <span class="md-ellipsis">
      Using I/O Memory
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_36" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬åç« ï¼šä¸­æ–­å¤„ç†
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_37" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬åä¸€ç« ï¼šå†…æ ¸ä¸­çš„æ•°æ®ç±»å‹
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pci" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬åäºŒç« ï¼šPCI é©±åŠ¨
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usb" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬åä¸‰ç« ï¼šUSB é©±åŠ¨
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linux" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬åå››ç« ï¼šLinux è®¾å¤‡æ¨¡å‹
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬åå››ç« ï¼šLinux è®¾å¤‡æ¨¡å‹">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kobject-kset" class="md-nav__link">
    <span class="md-ellipsis">
      Kobject å’Œ Kset
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dma" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬åäº”ç« ï¼šå†…å­˜æ˜ å°„ä¸ DMA
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬åäº”ç« ï¼šå†…å­˜æ˜ å°„ä¸ DMA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#linux_1" class="md-nav__link">
    <span class="md-ellipsis">
      Linux å†…å­˜ç®¡ç†
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmap" class="md-nav__link">
    <span class="md-ellipsis">
      mmap() è®¾å¤‡æ“ä½œ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#io_3" class="md-nav__link">
    <span class="md-ellipsis">
      æ‰§è¡Œç›´æ¥ I/O
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dma_1" class="md-nav__link">
    <span class="md-ellipsis">
      DMA
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DMA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dma_2" class="md-nav__link">
    <span class="md-ellipsis">
      åˆ†é… DMA ç¼“å†²åŒº
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dma_3" class="md-nav__link">
    <span class="md-ellipsis">
      é€šç”¨ DMA å±‚
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_38" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬åä¸ƒç« ï¼šç½‘ç»œé©±åŠ¨
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬åä¸ƒç« ï¼šç½‘ç»œé©±åŠ¨">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#snull" class="md-nav__link">
    <span class="md-ellipsis">
      snull çš„è®¾è®¡
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_39" class="md-nav__link">
    <span class="md-ellipsis">
      è¿æ¥åˆ°å†…æ ¸
    </span>
  </a>
  
    <nav class="md-nav" aria-label="è¿æ¥åˆ°å†…æ ¸">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_40" class="md-nav__link">
    <span class="md-ellipsis">
      è®¾å¤‡æ³¨å†Œ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_41" class="md-nav__link">
    <span class="md-ellipsis">
      è®¾å¤‡åˆå§‹åŒ–
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_42" class="md-nav__link">
    <span class="md-ellipsis">
      æ¨¡å—å¸è½½
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#net_device" class="md-nav__link">
    <span class="md-ellipsis">
      net_device ç»“æ„è¯¦è§£
    </span>
  </a>
  
    <nav class="md-nav" aria-label="net_device ç»“æ„è¯¦è§£">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_43" class="md-nav__link">
    <span class="md-ellipsis">
      è®¾å¤‡æ–¹æ³•
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_44" class="md-nav__link">
    <span class="md-ellipsis">
      è¾…åŠ©å­—æ®µ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_45" class="md-nav__link">
    <span class="md-ellipsis">
      æ‰“å¼€ä¸å…³é—­
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_46" class="md-nav__link">
    <span class="md-ellipsis">
      åŒ…ä¼ è¾“
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_47" class="md-nav__link">
    <span class="md-ellipsis">
      æ›´æ”¹é“¾è·¯çŠ¶æ€
    </span>
  </a>
  
    <nav class="md-nav" aria-label="æ›´æ”¹é“¾è·¯çŠ¶æ€">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rtnl" class="md-nav__link">
    <span class="md-ellipsis">
      è¡¥å……å†…å®¹ï¼šRTNL
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%F0%9F%93%96%20Linux%20Kernel%20Development%20%283rd%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– Linux Kernel Development (3rd)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    æ–‡ä»¶ç³»ç»Ÿ
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_5" id="__nav_3_5_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            æ–‡ä»¶ç³»ç»Ÿ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/%F0%9F%93%92%20%E5%86%85%E6%A0%B8%E6%BA%90%E7%A0%81%EF%BC%9ANFS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ å†…æ ¸æºç ï¼šNFS
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    æºç ç¬”è®°
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            æºç ç¬”è®°
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%BA%90%E7%A0%81%E7%AC%94%E8%AE%B0/bonding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    drivers/net/bonding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%BA%90%E7%A0%81%E7%AC%94%E8%AE%B0/systemd-networkd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    systemd-networkd
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    å…¶ä»–
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            å…¶ä»–
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%E6%94%B6%E8%97%8F%E5%A4%B9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ”¶è—å¤¹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%E8%87%AA%E5%8A%A8%E5%8C%96/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    è‡ªåŠ¨åŒ–
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%F0%9F%93%92%20%E5%BF%AB%E6%8D%B7%E9%94%AE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ å¿«æ·é”®
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%F0%9F%93%92%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%BD%BF%E7%94%A8%E7%BB%8F%E9%AA%8C%E5%92%8C%E6%8A%80%E5%B7%A7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ æ“ä½œç³»ç»Ÿä½¿ç”¨ç»éªŒå’ŒæŠ€å·§
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%F0%9F%93%92%20%E8%BD%AF%E4%BB%B6%E4%BD%BF%E7%94%A8%E7%BB%8F%E9%AA%8C%E5%92%8C%E6%8A%80%E5%B7%A7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ è½¯ä»¶ä½¿ç”¨ç»éªŒå’ŒæŠ€å·§
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%F0%9F%93%92%20%E9%9D%A2%E7%BB%8F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ é¢ç»
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%F0%9F%93%96%20Vim%20%E5%AE%9E%E7%94%A8%E6%8A%80%E5%B7%A7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– Vim å®ç”¨æŠ€å·§
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%F0%9F%93%96%20%E4%BA%BA%E6%9C%88%E7%A5%9E%E8%AF%9D/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– äººæœˆç¥è¯
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%F0%9F%94%97%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B1%BB%E7%A7%91%E6%99%AE%E8%A7%86%E9%A2%91/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ”— è®¡ç®—æœºç±»ç§‘æ™®è§†é¢‘
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_10" >
        
          
          <label class="md-nav__link" for="__nav_4_10" id="__nav_4_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ç”Ÿæ´»
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_10">
            <span class="md-nav__icon md-icon"></span>
            ç”Ÿæ´»
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%E7%94%9F%E6%B4%BB/%E4%B8%AA%E4%BA%BA%E5%8F%91%E5%B1%95/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä¸ªäººå‘å±•
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%E7%94%9F%E6%B4%BB/%E6%81%8B%E7%88%B1%E3%80%81%E5%A9%9A%E5%A7%BB%E4%B8%8E%E5%AE%B6%E5%BA%AD/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ‹çˆ±ã€å©šå§»ä¸å®¶åº­
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%E7%94%9F%E6%B4%BB/%E6%9D%82%E4%BA%8B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ‚äº‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%E7%94%9F%E6%B4%BB/%E7%A4%BE%E4%BC%9A/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç¤¾ä¼š
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%E7%94%9F%E6%B4%BB/%F0%9F%93%96%20%E4%BA%B2%E5%AF%86%E5%85%B3%E7%B3%BB%EF%BC%88%E7%AC%AC%208%20%E7%89%88%EF%BC%89/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– äº²å¯†å…³ç³»ï¼ˆç¬¬ 8 ç‰ˆï¼‰
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%E7%94%9F%E6%B4%BB/%F0%9F%93%96%20%E4%BA%B2%E5%AF%86%E5%85%B3%E7%B3%BB%EF%BC%9A%E9%80%9A%E5%BE%80%E7%81%B5%E9%AD%82%E7%9A%84%E6%A1%A5%E6%A2%81/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– äº²å¯†å…³ç³»ï¼šé€šå¾€çµé­‚çš„æ¡¥æ¢
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%E7%94%9F%E6%B4%BB/%F0%9F%93%96%20%E5%88%BB%E6%84%8F%E7%BB%83%E4%B9%A0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– åˆ»æ„ç»ƒä¹ 
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%E7%94%9F%E6%B4%BB/%F0%9F%93%96%20%E5%8E%9F%E7%94%9F%E5%AE%B6%E5%BA%AD%C2%B7%E5%A9%9A%E6%81%8B%E7%89%88/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– åŸç”Ÿå®¶åº­Â·å©šæ‹ç‰ˆ
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_11" >
        
          
          <label class="md-nav__link" for="__nav_4_11" id="__nav_4_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    è¯¾ç¨‹ç¬”è®°
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_11">
            <span class="md-nav__icon md-icon"></span>
            è¯¾ç¨‹ç¬”è®°
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%85%B6%E4%BB%96/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/%F0%9F%8F%AB%20%E9%A9%AC%E5%85%8B%E6%80%9D%E4%B8%BB%E4%B9%89%E5%8E%9F%E7%90%86%EF%BC%88H%EF%BC%89/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ« é©¬å…‹æ€ä¸»ä¹‰åŸç†ï¼ˆHï¼‰
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    åº”ç”¨é¢†åŸŸ
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            åº”ç”¨é¢†åŸŸ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    äººå·¥æ™ºèƒ½
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            äººå·¥æ™ºèƒ½
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/LLM%20Infra/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LLM Infra
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/%E4%B8%AA%E4%BA%BA%E7%AC%94%E8%AE%B0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ äººå·¥æ™ºèƒ½
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/%F0%9F%93%96%20Dive%20into%20Deep%20Learning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– Dive into Deep Learning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/%F0%9F%93%96%20PyTorch%20%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%AE%9E%E6%88%98/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– PyTorch æ·±åº¦å­¦ä¹ å®æˆ˜
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/%F0%9F%93%96%20%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– æ·±åº¦å­¦ä¹ 
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E6%95%B0%E6%8D%AE%E5%BA%93/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    æ•°æ®åº“
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            æ•°æ®åº“
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E6%95%B0%E6%8D%AE%E5%BA%93/%F0%9F%93%92%20ClickHouse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ClickHouse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E6%95%B0%E6%8D%AE%E5%BA%93/%F0%9F%93%92%20ElasticSearch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ ElasticSearch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E6%95%B0%E6%8D%AE%E5%BA%93/%F0%9F%93%92%20%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ æ•°æ®åº“ç¼–ç¨‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E6%95%B0%E6%8D%AE%E5%BA%93/%F0%9F%93%92%20%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%90%E7%BB%B4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ æ•°æ®åº“è¿ç»´
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%BA%94%E7%94%A8%E9%A2%86%E5%9F%9F/%E6%95%B0%E6%8D%AE%E5%BA%93/%F0%9F%93%96%20%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– æ•°æ®åº“ç³»ç»Ÿæ¦‚å¿µ
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ç§‘ç ”
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            ç§‘ç ”
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%A7%91%E7%A0%94/%E8%8D%89%E7%A8%BF/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    è‰ç¨¿
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%A7%91%E7%A0%94/%F0%9F%93%92%20%E7%A7%91%E7%A0%94%E5%86%99%E4%BD%9C/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ ç§‘ç ”å†™ä½œ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%A7%91%E7%A0%94/%F0%9F%93%92%20%E9%AB%98%E6%80%A7%E8%83%BD%E7%BD%91%E7%BB%9C/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ é«˜æ€§èƒ½ç½‘ç»œ
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ç®—æ³•
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            ç®—æ³•
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%AE%97%E6%B3%95/%F0%9F%8F%AB%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%9F%BA%E7%A1%80/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ« æ•°æ®ç»“æ„åŸºç¡€
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    ç³»ç»Ÿå’Œä½“ç³»ç»“æ„
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8" id="__nav_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            ç³»ç»Ÿå’Œä½“ç³»ç»“æ„
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/ISA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ISA
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/%E6%95%B0%E5%AD%97%E7%94%B5%E8%B7%AF/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ•°å­—ç”µè·¯
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/%F0%9F%93%92%20%E5%AE%B9%E5%99%A8%E5%92%8C%E8%99%9A%E6%8B%9F%E5%8C%96%E6%8A%80%E6%9C%AF/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ å®¹å™¨å’Œè™šæ‹ŸåŒ–æŠ€æœ¯
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/%F0%9F%93%96%20%E6%80%BB%E7%BA%BF/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– æ€»çº¿
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/%F0%9F%93%96%20%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ç½‘ç»œ
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            ç½‘ç»œ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%BD%91%E7%BB%9C/%F0%9F%93%92%20%E4%BB%A3%E7%90%86%E4%B8%8E%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E7%BD%91/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ ä»£ç†ä¸è™šæ‹Ÿä¸“ç”¨ç½‘
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%BD%91%E7%BB%9C/%F0%9F%93%92%20%E7%89%A9%E7%90%86%E5%92%8C%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ ç‰©ç†å’Œæ•°æ®é“¾è·¯å±‚
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%BD%91%E7%BB%9C/%F0%9F%93%92%20%E7%BD%91%E7%BB%9C%E7%AC%94%E8%AE%B0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ ç½‘ç»œç¬”è®°
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%BD%91%E7%BB%9C/%F0%9F%93%96%20Head%20First%20HTML/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– Head First HTML
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%BD%91%E7%BB%9C/%F0%9F%93%96%20%E5%9B%BE%E8%A7%A3%20HTTP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– å›¾è§£ HTTP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E7%BD%91%E7%BB%9C/%F0%9F%93%96%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%EF%BC%9A%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B%E6%96%B9%E6%B3%95/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– è®¡ç®—æœºç½‘ç»œï¼šè‡ªé¡¶å‘ä¸‹æ–¹æ³•
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_10" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../%E8%8D%89%E7%A8%BF/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    è‰ç¨¿
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_10" id="__nav_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            è‰ç¨¿
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%8D%89%E7%A8%BF/ZFS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ZFS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%8D%89%E7%A8%BF/draft/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    é›¶æ•£ç¬”è®°
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%8D%89%E7%A8%BF/lvm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logical Volume Manager
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%8D%89%E7%A8%BF/%E5%88%86%E5%B8%83%E5%BC%8F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%8D%89%E7%A8%BF/%F0%9F%93%92%20%E4%B8%B4%E6%97%B6%E7%AC%94%E8%AE%B0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ ä¸´æ—¶ç¬”è®°
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_10_7" >
        
          
          <label class="md-nav__link" for="__nav_10_7" id="__nav_10_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    HPC
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_7">
            <span class="md-nav__icon md-icon"></span>
            HPC
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%8D%89%E7%A8%BF/HPC/%F0%9F%93%92%20%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ æ€§èƒ½åˆ†æ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%8D%89%E7%A8%BF/HPC/%F0%9F%93%92%20%E8%AE%BF%E5%AD%98%E4%BC%98%E5%8C%96/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ è®¿å­˜ä¼˜åŒ–
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_10_7_3" >
        
          
          <label class="md-nav__link" for="__nav_10_7_3" id="__nav_10_7_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    å·¥å…·
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_10_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_7_3">
            <span class="md-nav__icon md-icon"></span>
            å·¥å…·
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%8D%89%E7%A8%BF/HPC/%E5%B7%A5%E5%85%B7/spack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%8D%89%E7%A8%BF/HPC/%E5%B7%A5%E5%85%B7/%E7%BC%96%E8%AF%91%E5%A5%97%E4%BB%B6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç¼–è¯‘å¥—ä»¶
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_10_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../%E8%8D%89%E7%A8%BF/RFC/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    RFC
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_10_8" id="__nav_10_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_8">
            <span class="md-nav__icon md-icon"></span>
            RFC
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%8D%89%E7%A8%BF/RFC/4506%20XDR/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RFC 4506 - XDR: External Data Representation Standard
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%8D%89%E7%A8%BF/RFC/5531%20RPC/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RFC 5531 - RPC: Remote Procedure Call Protocol Specification Version 2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%8D%89%E7%A8%BF/RFC/5661%20NFSv4.1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RFC 5661 - Network File System (NFS) Version 4 Minor Version 1 Protocol
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%8D%89%E7%A8%BF/RFC/7530%20NFSv4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RFC 7530 - Network File System (NFS) Version 4 Protocol
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    è¯­è¨€
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            è¯­è¨€
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%AF%AD%E8%A8%80/go/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Go
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%AF%AD%E8%A8%80/%F0%9F%93%92%20C%20%E5%92%8C%20C%2B%2B%20%E9%AB%98%E7%BA%A7%E8%AF%9D%E9%A2%98/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ C å’Œ C++ é«˜çº§è¯é¢˜
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%AF%AD%E8%A8%80/%F0%9F%93%92%20%E4%BB%A3%E7%A0%81%E9%A3%8E%E6%A0%BC/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ ä»£ç é£æ ¼
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%AF%AD%E8%A8%80/%F0%9F%93%92%20%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“’ å¼€å‘å·¥å…·
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%AF%AD%E8%A8%80/%F0%9F%93%96%20C%2B%2B%20Primer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– C++ Primer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%AF%AD%E8%A8%80/%F0%9F%93%96%20%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“– ç¼–è¯‘åŸç†
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    é«˜æ€§èƒ½
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            é«˜æ€§èƒ½
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_12_1" >
        
          
          <label class="md-nav__link" for="__nav_12_1" id="__nav_12_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    å¹¶è¡Œç¨‹åºè®¾è®¡
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_12_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12_1">
            <span class="md-nav__icon md-icon"></span>
            å¹¶è¡Œç¨‹åºè®¾è®¡
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E9%AB%98%E6%80%A7%E8%83%BD/%E5%B9%B6%E8%A1%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/C%2B%2B%20%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    C++ å¹¶å‘ç¼–ç¨‹
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬ä¸€ç« ï¼šè®¾å¤‡é©±åŠ¨ä»‹ç»
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬äºŒç« ï¼šæ„å»ºå’Œè¿è¡Œæ¨¡å—
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬äºŒç« ï¼šæ„å»ºå’Œè¿è¡Œæ¨¡å—">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      é…ç½®æµ‹è¯•ç³»ç»Ÿ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      æ ·ä¾‹æ¨¡å—
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      å†…æ ¸æ¨¡å—ä¸åº”ç”¨çš„å¯¹æ¯”
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      ç¼–è¯‘å’ŒåŠ è½½
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      å†…æ ¸ç¬¦å·è¡¨
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      å‡†å¤‡å·¥ä½œ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      åˆå§‹åŒ–å’Œå…³é—­
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      æ¨¡å—å‚æ•°
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      åœ¨ç”¨æˆ·ç©ºé—´å†…æ“ä½œ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬ä¸‰ç« ï¼šå­—ç¬¦è®¾å¤‡
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬ä¸‰ç« ï¼šå­—ç¬¦è®¾å¤‡">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scull" class="md-nav__link">
    <span class="md-ellipsis">
      scull çš„è®¾è®¡
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      ä¸»è¦å’Œæ¬¡è¦è®¾å¤‡å·
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      ä¸€äº›é‡è¦çš„æ•°æ®ç»“æ„
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      æ³¨å†Œå­—ç¬¦è®¾å¤‡
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      æ‰“å¼€å’Œé‡Šæ”¾
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scull_1" class="md-nav__link">
    <span class="md-ellipsis">
      scull çš„å†…å­˜ä½¿ç”¨
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      è¯»å’Œå†™
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      ä½¿ç”¨æ–°è®¾å¤‡
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬å››ç« ï¼šè°ƒè¯•æŠ€æœ¯
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬å››ç« ï¼šè°ƒè¯•æŠ€æœ¯">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      å†…æ ¸è°ƒè¯•æ”¯æŒ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      é€šè¿‡æ‰“å°è°ƒè¯•
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      é€šè¿‡æŸ¥è¯¢è°ƒè¯•
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    <span class="md-ellipsis">
      é€šè¿‡è§‚æµ‹è°ƒè¯•
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    <span class="md-ellipsis">
      è°ƒè¯•ç³»ç»Ÿé”™è¯¯
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    <span class="md-ellipsis">
      è°ƒè¯•å™¨å’Œç›¸å…³å·¥å…·
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬äº”ç« ï¼šå¹¶å‘å’Œç«äº‰æ¡ä»¶
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬äº”ç« ï¼šå¹¶å‘å’Œç«äº‰æ¡ä»¶">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    <span class="md-ellipsis">
      å¹¶å‘åŠå…¶ç®¡ç†
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#semaphoremutex" class="md-nav__link">
    <span class="md-ellipsis">
      æ——è¯­ï¼ˆSemaphoreï¼‰å’Œé”ï¼ˆMutexï¼‰
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    <span class="md-ellipsis">
      é”çš„å¸¸è§é”™è¯¯
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    <span class="md-ellipsis">
      é”çš„æ›¿ä»£å“
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬å…­ç« ï¼šé«˜çº§å­—ç¬¦é©±åŠ¨æ“ä½œ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬å…­ç« ï¼šé«˜çº§å­—ç¬¦é©±åŠ¨æ“ä½œ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ioctl" class="md-nav__link">
    <span class="md-ellipsis">
      ioctl
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#io" class="md-nav__link">
    <span class="md-ellipsis">
      é˜»å¡ I/O
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_31" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬ä¸ƒç« ï¼šæ—¶é—´ã€å»¶è¿Ÿä¸å»¶åå·¥ä½œ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬ä¸ƒç« ï¼šæ—¶é—´ã€å»¶è¿Ÿä¸å»¶åå·¥ä½œ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_32" class="md-nav__link">
    <span class="md-ellipsis">
      æµ‹é‡æ—¶é—´
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_33" class="md-nav__link">
    <span class="md-ellipsis">
      å»¶è¿Ÿæ‰§è¡Œ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬å…«ç« ï¼šåˆ†é…å†…å­˜
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬å…«ç« ï¼šåˆ†é…å†…å­˜">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kmalloc" class="md-nav__link">
    <span class="md-ellipsis">
      kmalloc çš„ç»†èŠ‚
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lookaside" class="md-nav__link">
    <span class="md-ellipsis">
      Lookaside ç¼“å­˜
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_35" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬ä¹ç« ï¼šä¸ç¡¬ä»¶æ²Ÿé€š
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬ä¹ç« ï¼šä¸ç¡¬ä»¶æ²Ÿé€š">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#io-io" class="md-nav__link">
    <span class="md-ellipsis">
      I/O ç«¯å£å’Œ I/O å†…å­˜
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#io_1" class="md-nav__link">
    <span class="md-ellipsis">
      ä½¿ç”¨ I/O ç«¯å£
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#io_2" class="md-nav__link">
    <span class="md-ellipsis">
      ä¸€ä¸ª I/O ç«¯å£ä¾‹å­
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-io-memory" class="md-nav__link">
    <span class="md-ellipsis">
      Using I/O Memory
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_36" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬åç« ï¼šä¸­æ–­å¤„ç†
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_37" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬åä¸€ç« ï¼šå†…æ ¸ä¸­çš„æ•°æ®ç±»å‹
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pci" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬åäºŒç« ï¼šPCI é©±åŠ¨
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usb" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬åä¸‰ç« ï¼šUSB é©±åŠ¨
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linux" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬åå››ç« ï¼šLinux è®¾å¤‡æ¨¡å‹
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬åå››ç« ï¼šLinux è®¾å¤‡æ¨¡å‹">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kobject-kset" class="md-nav__link">
    <span class="md-ellipsis">
      Kobject å’Œ Kset
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dma" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬åäº”ç« ï¼šå†…å­˜æ˜ å°„ä¸ DMA
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬åäº”ç« ï¼šå†…å­˜æ˜ å°„ä¸ DMA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#linux_1" class="md-nav__link">
    <span class="md-ellipsis">
      Linux å†…å­˜ç®¡ç†
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mmap" class="md-nav__link">
    <span class="md-ellipsis">
      mmap() è®¾å¤‡æ“ä½œ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#io_3" class="md-nav__link">
    <span class="md-ellipsis">
      æ‰§è¡Œç›´æ¥ I/O
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dma_1" class="md-nav__link">
    <span class="md-ellipsis">
      DMA
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DMA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dma_2" class="md-nav__link">
    <span class="md-ellipsis">
      åˆ†é… DMA ç¼“å†²åŒº
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dma_3" class="md-nav__link">
    <span class="md-ellipsis">
      é€šç”¨ DMA å±‚
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_38" class="md-nav__link">
    <span class="md-ellipsis">
      ç¬¬åä¸ƒç« ï¼šç½‘ç»œé©±åŠ¨
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç¬¬åä¸ƒç« ï¼šç½‘ç»œé©±åŠ¨">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#snull" class="md-nav__link">
    <span class="md-ellipsis">
      snull çš„è®¾è®¡
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_39" class="md-nav__link">
    <span class="md-ellipsis">
      è¿æ¥åˆ°å†…æ ¸
    </span>
  </a>
  
    <nav class="md-nav" aria-label="è¿æ¥åˆ°å†…æ ¸">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_40" class="md-nav__link">
    <span class="md-ellipsis">
      è®¾å¤‡æ³¨å†Œ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_41" class="md-nav__link">
    <span class="md-ellipsis">
      è®¾å¤‡åˆå§‹åŒ–
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_42" class="md-nav__link">
    <span class="md-ellipsis">
      æ¨¡å—å¸è½½
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#net_device" class="md-nav__link">
    <span class="md-ellipsis">
      net_device ç»“æ„è¯¦è§£
    </span>
  </a>
  
    <nav class="md-nav" aria-label="net_device ç»“æ„è¯¦è§£">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_43" class="md-nav__link">
    <span class="md-ellipsis">
      è®¾å¤‡æ–¹æ³•
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_44" class="md-nav__link">
    <span class="md-ellipsis">
      è¾…åŠ©å­—æ®µ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_45" class="md-nav__link">
    <span class="md-ellipsis">
      æ‰“å¼€ä¸å…³é—­
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_46" class="md-nav__link">
    <span class="md-ellipsis">
      åŒ…ä¼ è¾“
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_47" class="md-nav__link">
    <span class="md-ellipsis">
      æ›´æ”¹é“¾è·¯çŠ¶æ€
    </span>
  </a>
  
    <nav class="md-nav" aria-label="æ›´æ”¹é“¾è·¯çŠ¶æ€">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rtnl" class="md-nav__link">
    <span class="md-ellipsis">
      è¡¥å……å†…å®¹ï¼šRTNL
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  
  
<nav class="md-tags" >
  
    
    
    
      <a href="../../../#" class="md-tag">è¯»ä¹¦ç¬”è®°</a>
    
  
</nav>


  
    <a href="https://github.com/bowling233/TechStack/blob/master/docs/Linux/å†…æ ¸/ğŸ“– Linux Device Drivers (3rd).md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  


<h1 id="linux-device-drivers-3rd">ğŸ“– Linux Device Drivers (3rd)<a class="headerlink" href="#linux-device-drivers-3rd" title="Permanent link">&para;</a></h1>
<div class="admonition abstract">
<p class="admonition-title">Abstract</p>
<ul>
<li><strong>è‹±æ–‡ç‰ˆï¼š</strong><a href="https://www.oreilly.com/library/view/linux-device-drivers/0596005903/">Linux Device Drivers, 3rd Edition</a></li>
<li><strong>ä¸­æ–‡ç‰ˆï¼š</strong><a href="https://book.douban.com/subject/1723151/">Linux è®¾å¤‡é©±åŠ¨ç¨‹åº</a></li>
</ul>
<p>æˆªæ­¢åˆ° 2025 å¹´ï¼Œè¿™æœ¬ä¹¦ä¾ç„¶æ˜¯ Linux é©±åŠ¨å¼€å‘çš„æœ€ä½³å…¥é—¨ä¹¦ç±ã€‚å’Œä¼—å¤šç»å…¸ Linux ä¹¦ç±ä¸€æ ·ï¼Œå¤§å®¶å¯¹å®ƒä»¬çš„è¯„ä»·æ˜¯ï¼šå†…æ ¸æºç å¤„äºä¸æ–­çš„æ›´æ–°ä¹‹ä¸­ï¼Œä¹¦ç±éƒ½åªèƒ½ä½œä¸ºèµ·ç‚¹ã€‚å­¦ä¹ çš„æœ€ä½³æ–¹å¼æ˜¯ä»ä¹¦ç±äº†è§£ç›¸å…³æ¦‚å¿µï¼Œç„¶åè¯»å†…æ ¸æºç å’Œç›¸å…³æ–‡æ¡£ã€‚</p>
<blockquote>
<p>The LDD book is a reasonable starting point, but as you say it's quite dated in some areas. Kernel APIs tend to change fairly quickly by book standards, which makes it a bit of a tall order.</p>
<p>Generally the best resources tend to be in-tree documentation (where it exists), which stands a higher chance of being up to date, and existing drivers that are doing something similar.</p>
</blockquote>
</div>
<p>è¿™æœ¬ä¹¦åŸºäº Linux 2.6ã€‚</p>
<div class="admonition info">
<p class="admonition-title">ä¸€äº›ç›¸å…³çš„èµ„æº</p>
<ul>
<li>æºç å¯ä»¥ä» <a href="https://resources.oreilly.com/examples/9780596005900.git">examples / Linux Device Drivers 3rd Edition Â· GitLab</a> ä¸‹è½½ã€‚ä½†å› å…¶åŸºäº Linux 2.6ï¼ŒåŸºæœ¬ä¸Šè·‘ä¸èµ·æ¥ã€‚</li>
<li><a href="https://github.com/martinezjavier/ldd3">martinezjavier/ldd3: Linux Device Drivers 3 examples updated to work in recent kernels</a> æ˜¯ç›®å‰æŒç»­åœ¨æ›´æ–°çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”æä¾›äº†æ¯”è¾ƒå¥½çš„æŒ‡å¯¼ï¼Œæ¨èä½¿ç”¨ã€‚å®ƒåŸºäº 5.10ã€‚</li>
<li><a href="https://github.com/d0u9/Linux-Device-Driver">d0u9/Linux-Device-Driver: Advanced examples of Linux Device Drivers (LDD3) </a>ï¼ŒåŸºäº 5.10ï¼Œä½¿ç”¨ QEMU è¿›è¡Œå®éªŒã€‚</li>
</ul>
</div>
<p>æœ¬ç¯‡ç¬”è®°ä½¿ç”¨ <code>martinezjavier/ldd3</code> è¿›è¡Œå®éªŒã€‚</p>
<h2 id="_1">ç¬¬ä¸€ç« ï¼šè®¾å¤‡é©±åŠ¨ä»‹ç»<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>ä¸‰ç±»è®¾å¤‡ï¼š</p>
<ul>
<li>å­—ç¬¦è®¾å¤‡ï¼šæä¾›å­—èŠ‚æµ<ul>
<li>ä¸€èˆ¬å®ç° <code>open</code>ã€<code>close</code>ã€<code>read</code>ã€<code>write</code></li>
<li>ä¾‹å­ï¼š<code>/dev/console</code></li>
</ul>
</li>
<li>å—è®¾å¤‡</li>
<li>ç½‘ç»œæ¥å£</li>
</ul>
<p>æ‚é¡¹ï¼š</p>
<ul>
<li>æ¦‚è¿°äº† Linux ç³»ç»Ÿçš„æ•´ä½“æ¶æ„</li>
<li>æåŠäº†å®‰å…¨é—®é¢˜ï¼š<ul>
<li>é©±åŠ¨ç¼–å†™è€…åº”å½“å°†å°½å¯èƒ½å°†å®‰å…¨ç­–ç•¥ç§»äº¤ç»™æ›´é«˜å±‚æ¬¡ï¼Œè€Œä¸æ˜¯åœ¨é©±åŠ¨ä¸­å®ç°ã€‚å¦‚æœå¯¹è®¾å¤‡çš„æ“ä½œå¯èƒ½å½±å“æ•´ä¸ªç³»ç»Ÿçš„å®‰å…¨ï¼Œå°±éœ€è¦åšå¥½è®¿é—®æ§åˆ¶ï¼Œæ¯”å¦‚åªæœ‰ç‰¹æƒç”¨æˆ·æ‰èƒ½åŠ è½½çš„å†…æ ¸æ¨¡å—ã€‚åŠ è½½æ¨¡å—æ—¶ï¼Œç³»ç»Ÿè°ƒç”¨ <code>init_module</code> ä¼šæ£€æŸ¥å¯¹åº”è¿›ç¨‹æ˜¯å¦æœ‰åŠ è½½æ¨¡å—çš„æƒé™ã€‚</li>
<li>æ­¤å¤–è¦é˜²èŒƒç¼“å†²åŒºæº¢å‡ºç­‰ C è¯­è¨€å®¹æ˜“äº§ç”Ÿçš„é—®é¢˜ã€‚</li>
<li>åœ¨éªŒè¯ä¹‹å‰ï¼Œä¸èƒ½ä¿¡ä»»ä»»ä½•ä»ç”¨æˆ·ç©ºé—´ä¼ æ¥çš„ä¸œè¥¿ï¼Œå¹¶ä¸”è¦è®¾è®¡ä¸ºä¸è®ºç”¨æˆ·ç»™åˆ°ä»€ä¹ˆä¿¡æ¯éƒ½ä¸è‡³äºä½¿ç³»ç»Ÿå´©æºƒã€‚ä»å†…æ ¸æ‹¿åˆ°çš„å†…å­˜ä¸€å®šè¦åˆå§‹åŒ–ï¼Œæ£€æŸ¥å†…å­˜æ³„éœ²ç­‰ã€‚</li>
</ul>
</li>
<li>Linux å¯ä»¥å®Œå…¨å…³é—­æ¨¡å—åŠŸèƒ½ï¼Œæ­¤æ—¶é©±åŠ¨å¿…é¡»ç¼–è¯‘è¿›å†…æ ¸ã€‚</li>
</ul>
<h2 id="_2">ç¬¬äºŒç« ï¼šæ„å»ºå’Œè¿è¡Œæ¨¡å—<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<h3 id="_3">é…ç½®æµ‹è¯•ç³»ç»Ÿ<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>é¦–å…ˆéœ€è¦æ‹‰å–å†…æ ¸æºç æ ‘å¹¶æ„å»ºï¼Œä¸‹é¢è®°å½•æˆ‘çš„æ“ä½œè¿‡ç¨‹ï¼š</p>
<div class="admonition info">
<p class="admonition-title">æ„å»ºå†…æ ¸è¿‡ç¨‹</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>git<span class="w"> </span>clone<span class="w"> </span>https://
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="nb">cd</span><span class="w"> </span>linux
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>yes<span class="w"> </span><span class="s2">&quot;&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>make<span class="w"> </span>oldconfig
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>make<span class="w"> </span>-j
</span></code></pre></div>
<p>åœ¨ Debian ç³»å‘è¡Œç‰ˆä¸Šï¼Œä¾ç…§ <a href="https://www.debian.org/doc/manuals/debian-kernel-handbook/ch-common-tasks.html">ChapterÂ 4.Â Common kernel-related tasks</a> æ“ä½œæ›´åŠ å¯é ï¼š</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>apt-get<span class="w"> </span>install<span class="w"> </span>linux-source<span class="w"> </span>build-essential<span class="w"> </span>fakeroot<span class="w"> </span>devscripts<span class="w"> </span>rsync<span class="w"> </span>git<span class="w"> </span>linux-headers-amd64
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>apt-get<span class="w"> </span>build-dep<span class="w"> </span>linux
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>tar<span class="w"> </span>xaf<span class="w"> </span>/usr/src/linux-source-*.tar.xz
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="nb">cd</span><span class="w"> </span>linux-source-*
</span></code></pre></div>
<p>åœ¨ RedHat ç³»å‘è¡Œç‰ˆä¸Šï¼Œå‚è€ƒ <a href="https://docs.fedoraproject.org/en-US/quick-docs/kernel-build-custom/">Building a Custom Kernel :: Fedora Docs</a>ï¼š</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>dnf<span class="w"> </span>builddep<span class="w"> </span>kernel
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>dnf<span class="w"> </span>download<span class="w"> </span>--source<span class="w"> </span>kernel
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>rpm2cpio<span class="w"> </span>kernel*.rpm<span class="w"> </span><span class="p">|</span><span class="w"> </span>cpio<span class="w"> </span>-idmv
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="nb">cd</span><span class="w"> </span>linux-source-*
</span></code></pre></div>
<p>å¦‚æœåªéœ€è¦ç‰¹å®šçš„å†…æ ¸æ¨¡å—ï¼Œå‚è€ƒ <a href="https://docs.kernel.org/kbuild/modules.html">Building External ModulesÂ¶</a></p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nb">cd</span><span class="w"> </span>drivers/net/bonding
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>make<span class="w"> </span>-C<span class="w"> </span>/lib/modules/<span class="sb">`</span>uname<span class="w"> </span>-r<span class="sb">`</span>/build<span class="w"> </span><span class="nv">M</span><span class="o">=</span><span class="nv">$PWD</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>make<span class="w"> </span>-C<span class="w"> </span>/lib/modules/<span class="sb">`</span>uname<span class="w"> </span>-r<span class="sb">`</span>/build<span class="w"> </span><span class="nv">M</span><span class="o">=</span><span class="nv">$PWD</span><span class="w"> </span>modules_install
</span></code></pre></div>
<p>æ­¤æ—¶æ¨¡å—ä¼šè¢«å®‰è£…åˆ° <code>/lib/modules/$(uname -r)/update/*.ko</code>ã€‚ç›´æ¥ç”¨å…¶è¦†ç›–ç›®æ ‡æ¨¡å—å³å¯ã€‚</p>
</div>
<h3 id="_4">æ ·ä¾‹æ¨¡å—<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<p>ç•¥</p>
<h3 id="_5">å†…æ ¸æ¨¡å—ä¸åº”ç”¨çš„å¯¹æ¯”<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<ul>
<li>å†…æ ¸æ¨¡å—åªä¸å†…æ ¸é“¾æ¥ï¼Œå› æ­¤åªèƒ½ä½¿ç”¨å†…æ ¸å¯¼å‡ºçš„å‡½æ•°ï¼Œä¸èƒ½ä½¿ç”¨æ ‡å‡†åº“å‡½æ•°ã€‚</li>
<li>å†…æ ¸æ¨¡å—è¿è¡Œåœ¨å†…æ ¸ç©ºé—´ï¼Œå†…å­˜æ˜ å°„å’Œåœ°å€ç©ºé—´ä¹Ÿä¸æ™®é€šåº”ç”¨ä¸ä¸€æ ·ã€‚</li>
<li>å½“åº”ç”¨æ‰§è¡Œç³»ç»Ÿè°ƒç”¨æˆ–è¢«ç¡¬ä»¶ä¸­æ–­æ—¶ï¼Œè¿›å…¥å†…æ ¸ç©ºé—´ã€‚ç³»ç»Ÿè°ƒç”¨è¿è¡Œåœ¨è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œå¯ä»¥è®¿é—®è¿›ç¨‹çš„åœ°å€ç©ºé—´ã€‚ç¡¬ä»¶ä¸­æ–­æ˜¯å¼‚æ­¥çš„ï¼Œä¸ç‰¹å®šè¿›ç¨‹æ— å…³ã€‚</li>
<li>éœ€è¦è€ƒè™‘å¹¶å‘åœºæ™¯ã€‚å¹¶å‘çš„æ¥æºæœ‰ï¼šå¤šè¿›ç¨‹ä½¿ç”¨é©±åŠ¨ã€ç¡¬ä»¶æ“ä½œè¿‡ç¨‹ä¸­å‘ç”Ÿä¸­æ–­ã€å†…æ ¸è®¡æ—¶å™¨ã€é©±åŠ¨åœ¨å¤šä¸ª CPU ä¸Šæ‰§è¡Œã€æŠ¢å ç­‰ã€‚å†…æ ¸ä¸å†…æ ¸æ¨¡å—éƒ½éœ€è¦åšåˆ° reentrantï¼Œå³å¯ä»¥åŒæ—¶è¿è¡Œåœ¨å¤šä¸ªä¸Šä¸‹æ–‡ä¸­ã€‚</li>
<li><code>current</code> æŒ‡é’ˆæŒ‡å‘å½“å‰è¿›ç¨‹çš„ <code>task_struct</code> ç»“æ„ä½“ã€‚</li>
<li>å†…æ ¸çš„æ ˆéå¸¸å°ï¼Œå¯ä»¥å°åˆ°ä¸€ä¸ª 4K é¡µã€‚æˆ‘ä»¬å†™çš„å‡½æ•°ä¸å†…æ ¸ç©ºé—´çš„è°ƒç”¨é“¾ä¸€èµ·ä½¿ç”¨è¿™ä¸ªæ ˆã€‚å› æ­¤ï¼Œä¸åº”å½“ä½¿ç”¨å¤§å‹å±€éƒ¨å˜é‡ï¼Œåº”å½“åŠ¨æ€åˆ†é…ã€‚</li>
</ul>
<h3 id="_6">ç¼–è¯‘å’ŒåŠ è½½<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<p>å†…æ ¸æ¨¡å—çš„ç¼–è¯‘ä½¿ç”¨å†…æ ¸æ„å»ºç³»ç»Ÿ <code>kbuild</code>ã€‚åœ¨å†…æ ¸æ¨¡å—çš„ç›®å½•ä¸‹æ”¾ç½®è¿™æ ·çš„ Makefileï¼š</p>
<div class="language-makefile highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="cp">ifneq ($(KERNELRELEASE),)</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">    </span>obj-m<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>hello.o
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="c"># Otherwise we were called directly from the command line; invoke the kernel build system.</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="cp">else</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="w">    </span>KERNELDIR<span class="w"> </span>?<span class="o">=</span><span class="w"> </span>/lib/modules/<span class="k">$(</span>shell<span class="w"> </span>uname<span class="w"> </span>-r<span class="k">)</span>/build
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="w">    </span>PWD<span class="w"> </span>:<span class="o">=</span><span class="w"> </span><span class="k">$(</span>shell<span class="w"> </span><span class="nb">pwd</span><span class="k">)</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="nf">default</span><span class="o">:</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="w">    </span><span class="k">$(</span>MAKE<span class="k">)</span><span class="w"> </span>-C<span class="w"> </span><span class="k">$(</span>KERNELDIR<span class="k">)</span><span class="w"> </span><span class="nv">M</span><span class="o">=</span><span class="k">$(</span>PWD<span class="k">)</span><span class="w"> </span>modules
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="cp">endif</span>
</span></code></pre></div>
<p>é€šè¿‡ä¸‹é¢çš„å‘½ä»¤ç¼–è¯‘ï¼š</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nv">KERNELDIR</span><span class="o">=</span>/path/to/kernel<span class="w"> </span>make
</span></code></pre></div>
<p>å…¶ä¸­çš„åŸç†æ¶‰åŠ GNU Make æ‰©å±•è¯­æ³•ï¼Œæš‚ç•¥ã€‚å¤§è‡´è¿‡ç¨‹æ˜¯è®© <code>make</code> è°ƒç”¨å†…æ ¸çš„ <code>Makefile</code>ï¼Œä½¿ç”¨å†…æ ¸æ„å»ºç³»ç»Ÿçš„ <code>module</code> ç›®æ ‡æ¥æ„å»ºå†…æ ¸æ¨¡å—ã€‚ç¼–è¯‘å®Œæˆçš„æ¨¡å—æ–‡ä»¶æ˜¯ <code>hello.ko</code>ã€‚</p>
<div class="admonition todo">
<p class="admonition-title">Todo</p>
<p><code>martinezjavier/ldd3</code> å¯ä»¥ä½¿ç”¨å½“å‰è¿è¡Œçš„ 6.1 å†…æ ¸æºç ç¼–è¯‘ï¼Œå´ä¸èƒ½ä½¿ç”¨ä¸‹è½½çš„ 5.10 å†…æ ¸æºç ç¼–è¯‘ã€‚çœ‹æŠ¥é”™æ˜¯ç¼ºäº†å‡½æ•°å®šä¹‰ã€‚ä¸çŸ¥é“æ˜¯ Debian Patch è¿˜æ˜¯å†…æ ¸ API å˜åŠ¨å¯¼è‡´çš„ã€‚</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>jit.c:96:47: error: implicit declaration of function â€˜pde_dataâ€™ [-Werror=implicit-function-declaration]
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>96 |         return single_open(file, jit_fn_show, pde_data(inode));
</span></code></pre></div>
</div>
<p>å‡ ä¸ªå®ç”¨å·¥å…·ï¼š</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>insmod modprobe rmmod lsmod
</span></code></pre></div>
<ul>
<li>åŠ è½½å†…æ ¸æ¨¡å—æ—¶å¯ä»¥æŒ‡å®šå‚æ•°ã€‚</li>
<li><code>insmod</code> é€šè¿‡ <code>sys_init_module</code> ç³»ç»Ÿè°ƒç”¨åŠ è½½æ¨¡å—ï¼Œè¿™ä¼šä¸ºæ¨¡å—åˆ†é…ä¸€å—å†…å­˜åŒºåŸŸï¼Œå°†æ¨¡å—çš„ä»£ç å’Œæ•°æ®å¤åˆ¶åˆ°è¿™ä¸ªåŒºåŸŸï¼Œç„¶åè¿›è¡Œè§£ææ¨¡å—çš„ç¬¦å·è¡¨ç­‰æ“ä½œã€‚</li>
<li>ä½¿ç”¨ <code>modprobe</code> æ—¶ï¼Œä¼šæ£€æŸ¥æ¨¡å—ä¸­æ˜¯å¦æœ‰å†…æ ¸ç¬¦å·è¡¨ä¸­çš„ç¬¦å·ï¼Œå¦‚æœæ²¡æœ‰ï¼Œä¼šè‡ªåŠ¨åŠ è½½ä¾èµ–çš„æ¨¡å—ã€‚</li>
<li>å¦‚æœå†…æ ¸æ£€æµ‹åˆ°æ¨¡å—å¯¼å‡ºçš„è®¾å¤‡ç­‰æ­£åœ¨ä½¿ç”¨ï¼Œä¼šæ‹’ç»å¸è½½æ¨¡å—ã€‚</li>
</ul>
<p>å†…æ ¸ç‰ˆæœ¬ä¾èµ–ï¼š</p>
<ul>
<li>å†…æ ¸æ¨¡å—ä¸ç‰¹å®šå†…æ ¸ç‰ˆæœ¬ç´§å¯†ç›¸å…³ã€‚æ„å»ºå†…æ ¸æ¨¡å—æ—¶ä¸ <code>vermagic.o</code> é“¾æ¥ï¼Œè¯¥æ–‡ä»¶ä¸­åŒ…å«å†…æ ¸ç‰ˆæœ¬ã€å¤„ç†å™¨æ¶æ„ç­‰ä¿¡æ¯ï¼ŒåŠ è½½æ—¶ä¼šä»¥æ­¤æ£€æŸ¥å…¼å®¹æ€§ã€‚</li>
<li>ç¼–å†™è·¨å†…æ ¸ç‰ˆæœ¬çš„æ¨¡å—æ—¶ï¼Œä¸ç‰ˆæœ¬æœ‰å…³çš„æ¥å£ï¼Œé€šå¸¸åº”å½“æ”¾ç½®åœ¨ä¸€ä¸ªå¤´æ–‡ä»¶ä¸­ç”¨ä¸€å±‚å®åŒ…è£…ã€‚</li>
</ul>
<h3 id="_7">å†…æ ¸ç¬¦å·è¡¨<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<ul>
<li>åŠ è½½æ¨¡å—åï¼Œ<code>EXPORT_SYMBOL()</code> çš„ç¬¦å·è¿›å…¥å†…æ ¸ç¬¦å·è¡¨ï¼Œå…¶ä»–æ¨¡å—å¯ä»¥ä½¿ç”¨ã€‚</li>
<li><code>EXPORT_SYMBOL_GPL()</code> åªå…è®¸ GPL è®¸å¯è¯çš„æ¨¡å—ä½¿ç”¨ã€‚</li>
</ul>
<h3 id="_8">å‡†å¤‡å·¥ä½œ<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<ul>
<li>ä½¿ç”¨ <code>MODULE_LICENSE()</code> å®šä¹‰æ¨¡å—çš„è®¸å¯è¯ã€‚å¦‚æœæœªå®šä¹‰ï¼Œå†…æ ¸ä¼šè®¤ä¸ºæ˜¯ä¸“æœ‰çš„ã€‚åŠ è½½è¿™æ ·çš„æ¨¡å—æ—¶ï¼Œä¼šæœ‰ <code>taint</code> è­¦å‘Šã€‚</li>
</ul>
<h3 id="_9">åˆå§‹åŒ–å’Œå…³é—­<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<div class="language-c highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">__init</span><span class="w"> </span><span class="nf">init_func</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="p">{</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="p">}</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="n">module_init</span><span class="p">(</span><span class="n">init_func</span><span class="p">);</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="n">module_exit</span><span class="p">(</span><span class="n">exit_func</span><span class="p">);</span>
</span></code></pre></div>
<p>åˆå§‹åŒ–å‡½æ•°å‘ç³»ç»Ÿæ³¨å†Œä¸€äº›è®¾å¤‡ã€‚æ³¨å†Œå¯èƒ½å¤±è´¥ï¼Œå› æ­¤éœ€è¦æ£€æŸ¥è¿”å›å€¼ã€‚å¤±è´¥æ—¶ï¼Œå¯èƒ½ç»§ç»­æ‰§è¡Œä½†æä¾›æœ‰é™çš„åŠŸèƒ½ï¼Œä¹Ÿå¯èƒ½ç›´æ¥é€€å‡ºï¼Œæ­¤æ—¶è¦æ³¨æ„æ¸…ç†å·²ç»æ³¨å†Œçš„èµ„æºï¼Œè¿™äº›ç¼–ç¨‹ç»å¸¸ä½¿ç”¨ <code>goto</code> è¯­å¥ã€‚</p>
<p>å‡½æ•°å£°æ˜ä¸­çš„ <code>__init</code> å’Œ <code>__exit</code> å…·æœ‰ç‰¹å®šåŠŸèƒ½å’Œä½œç”¨ï¼Œä½¿ç”¨æ—¶éœ€è¦æ³¨æ„ã€‚æ¯”å¦‚ <code>__init</code> åœ¨æ¨¡å—åŠ è½½åä¼šè¢«ä¸¢å¼ƒï¼Œ<code>__exit</code> ä¼šæ”¾åœ¨ç‰¹æ®Šçš„æ®µä¸­ï¼Œåªèƒ½åœ¨æ¨¡å—å¸è½½æ—¶è°ƒç”¨è¯·ï¼Œå…¶ä»–æƒ…å†µä¸‹äº§ç”Ÿé”™è¯¯ã€‚</p>
<p>éœ€è¦è€ƒè™‘æ¨¡å—åŠ è½½æ—¶çš„ç«äº‰æ¡ä»¶ï¼Œå¯èƒ½åˆå§‹åŒ–å‡½æ•°å°šæœªæ‰§è¡Œå®Œæ¯•ï¼Œå°±ä¼šæœ‰å¯¹æ¨¡å—çš„è®¿é—®ã€‚å› æ­¤æ¨¡å—å†…éƒ¨çš„åˆå§‹åŒ–åº”å½“åœ¨æ³¨å†Œè®¾å¤‡ä¹‹å‰å®Œæˆã€‚</p>
<h3 id="_10">æ¨¡å—å‚æ•°<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h3>
<p>æ¨¡å—å‚æ•°å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­æŒ‡å®šï¼Œå¦‚ï¼š</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>insmod<span class="w"> </span>hello.ko<span class="w"> </span><span class="nv">howmany</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="nv">whom</span><span class="o">=</span><span class="s2">&quot;Mom&quot;</span>
</span></code></pre></div>
<p>ä¹Ÿå¯ä»¥åœ¨ <code>/etc/modules.conf</code> ä¸­é…ç½®ã€‚</p>
<p>æ¨¡å—å‚æ•°ä¸æ”¯æŒæµ®ç‚¹æ•°ã€‚</p>
<p>åœ¨æ¨¡å—ä¸­å£°æ˜å‚æ•°ï¼š</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">howmany</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="n">module_param</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">perm</span><span class="p">);</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="n">module_param_array</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">num</span><span class="p">,</span><span class="w"> </span><span class="n">perm</span><span class="p">);</span>
</span></code></pre></div>
<p>æ‰€æœ‰æ¨¡å—å‚æ•°éƒ½åº”è¯¥æœ‰é»˜è®¤å€¼ã€‚<code>perm</code> æ§åˆ¶ <code>sysfs</code> ä¸­å‚æ•°çš„æƒé™ã€‚</p>
<h3 id="_11">åœ¨ç”¨æˆ·ç©ºé—´å†…æ“ä½œ<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h3>
<p><code>libusb</code> å°±æ˜¯ä¸€ä¸ªå®ç°åœ¨ç”¨æˆ·ç©ºé—´çš„ USB é©±åŠ¨ã€‚å®ç°åœ¨ç”¨æˆ·ç©ºé—´æœ‰ä¸€äº›å¥½å¤„ï¼Œæ¯”å¦‚å¯ä»¥ä½¿ç”¨æ ‡å‡†åº“ã€è°ƒè¯•è¿‡ç¨‹æ›´ç®€å•ç­‰ã€‚ä½†è¿™ä¹Ÿæœ‰å¾ˆå¤šé™åˆ¶ï¼Œæ¯”å¦‚ç½‘ç»œæ¥å£ã€å—è®¾å¤‡éƒ½æ— æ³•åœ¨ç”¨æˆ·ç©ºé—´å®ç°ï¼ŒDMA å—é™ï¼Œé€Ÿåº¦è¾ƒæ…¢ç­‰ã€‚</p>
<h2 id="_12">ç¬¬ä¸‰ç« ï¼šå­—ç¬¦è®¾å¤‡<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h2>
<p>æœ¬ç« è®²è§£ Simple Character Utility for Loading Localities (scull) è®¾å¤‡çš„å®ç°ã€‚å®ƒæ“ä½œä¸€å—å†…å­˜ï¼Œè¡¨ç°ä¸ºä¸€ä¸ªå­—ç¬¦è®¾å¤‡ã€‚</p>
<h3 id="scull">scull çš„è®¾è®¡<a class="headerlink" href="#scull" title="Permanent link">&para;</a></h3>
<p>å®ƒå°†æä¾›ä¸‹åˆ—è®¾å¤‡ï¼š</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>scull0-3
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>scullpipe0-3
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>scullsingle
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>scullpriv
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>sculluid
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>scullwuid
</span></code></pre></div>
<h3 id="_13">ä¸»è¦å’Œæ¬¡è¦è®¾å¤‡å·<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h3>
<p>åœ¨ <code>/dev</code> ä¸­ä½¿ç”¨ <code>ls -l</code> ä¼šå‘ç°åŸå…ˆæ˜¾ç¤ºæ–‡ä»¶å¤§å°çš„åœ°æ–¹è¢«è®¾å¤‡å·å æ®ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œä¸»è®¾å¤‡å·æ ‡è¯†ç®¡ç†è¯¥è®¾å¤‡çš„é©±åŠ¨ï¼ˆç°åœ¨ Linux å…è®¸å¤šä¸ªé©±åŠ¨å…±äº«ä¸€ä¸ªä¸»è®¾å¤‡å·ï¼‰ï¼Œæ¬¡è®¾å¤‡å·æ ‡è¯†è®¾å¤‡çš„å®ä¾‹ã€‚</p>
<p>å¸¸ç”¨å›ºå®šè®¾å¤‡å·è§å†…æ ¸æ–‡æ¡£ <code>devices.txt</code>ã€‚å¯ä»¥åœ¨ <code>/proc/devices</code> ä¸­æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¸­æ³¨å†Œçš„è®¾å¤‡ã€‚</p>
<p>è®¾å¤‡å·å­˜å‚¨åœ¨ <code>dev_t</code> ç±»å‹ä¸­ï¼Œä½¿ç”¨å®æ“ä½œå®ƒï¼š</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="n">MAJOR</span><span class="p">(</span><span class="kt">dev_t</span><span class="w"> </span><span class="n">dev</span><span class="p">);</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="n">MINOR</span><span class="p">(</span><span class="kt">dev_t</span><span class="w"> </span><span class="n">dev</span><span class="p">);</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="n">MKDEV</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">major</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">minor</span><span class="p">);</span>
</span></code></pre></div>
<p>è®¾å¤‡å·ç›¸å…³å‡½æ•°ï¼š</p>
<div class="language-c highlight"><span class="filename">linux/fs.h</span><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c1">//int register_chrdev_region(dev_t first, unsigned int count, const char *name);</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="kt">int</span><span class="w"> </span><span class="nf">alloc_chrdev_region</span><span class="p">(</span><span class="kt">dev_t</span><span class="w"> </span><span class="o">*</span><span class="n">dev</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">firstminor</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="p">);</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="kt">void</span><span class="w"> </span><span class="nf">unregister_chrdev_region</span><span class="p">(</span><span class="kt">dev_t</span><span class="w"> </span><span class="n">first</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="p">);</span>
</span></code></pre></div>
<p>æ‹¿åˆ°è®¾å¤‡å·åï¼Œè¿˜éœ€è¦å°†è®¾å¤‡å·ä¸é©±åŠ¨å†…éƒ¨å®ç°ç¡¬ä»¶æ“ä½œçš„å‡½æ•°å…³è”èµ·æ¥ã€‚</p>
<h3 id="_14">ä¸€äº›é‡è¦çš„æ•°æ®ç»“æ„<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><code>file_operations</code></p>
<ul>
<li>å®šä¹‰äº <code>linux/fs.h</code>ï¼ŒåŒ…å«äº†è®¾å¤‡é©±åŠ¨çš„æ“ä½œå‡½æ•°æŒ‡é’ˆã€‚æ¯ä¸ªæ‰“å¼€çš„æ–‡ä»¶ <code>file</code> éƒ½å«æœ‰ <code>f_op</code> æŒ‡å‘æ–‡ä»¶æ“ä½œç›¸å…³çš„ç³»ç»Ÿè°ƒç”¨ï¼Œå®ç° <code>open</code>ã€<code>read</code> ç­‰æ“ä½œã€‚</li>
<li><code>struct module *owner</code> æŒ‡å‘æŒæœ‰è¿™ä¸ªç»“æ„çš„æ¨¡å—ï¼Œé¿å…æ¨¡å—åœ¨ä½¿ç”¨æ—¶è¢«å¸è½½ã€‚</li>
</ul>
<div class="language-c highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="n">loff_t</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">llseek</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">file</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">loff_t</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="kt">ssize_t</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">read</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">file</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">__user</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="p">,</span><span class="w"> </span><span class="n">loff_t</span><span class="w"> </span><span class="o">*</span><span class="p">)</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="kt">ssize_t</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">write</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">file</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">__user</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="p">,</span><span class="w"> </span><span class="n">loff_t</span><span class="w"> </span><span class="o">*</span><span class="p">)</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="kt">int</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">open</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">inode</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">file</span><span class="w"> </span><span class="o">*</span><span class="p">)</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="kt">int</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">ioctl</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">inode</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">file</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="p">...</span>
</span></code></pre></div>
</li>
<li>
<p><code>file</code></p>
<ul>
<li>å®šä¹‰äº <code>linux/fs.h</code>ï¼Œä¸æ ‡å‡†åº“ä¸­çš„ <code>FILE</code> ä¸åŒï¼Œè¡¨ç¤ºæ‰“å¼€çš„æ–‡ä»¶çš„æè¿°ç¬¦ã€‚<code>open</code> æ—¶åˆ›å»ºï¼Œä¼ ç»™æ¯ä¸ªç”¨åˆ°çš„å‡½æ•°ï¼Œæœ€å <code>close</code> æ—¶é‡Šæ”¾ã€‚</li>
</ul>
<div class="language-c highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="kt">mode_t</span><span class="w"> </span><span class="n">f_mode</span><span class="p">;</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="n">loff_t</span><span class="w"> </span><span class="n">f_pos</span><span class="p">;</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="k">struct</span><span class="w"> </span><span class="nc">file_operations</span><span class="w"> </span><span class="o">*</span><span class="n">f_op</span><span class="p">;</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="p">...</span>
</span></code></pre></div>
</li>
<li>
<p><code>inode</code></p>
<ul>
<li>ä¸€ä¸ªæ–‡ä»¶å¯ä»¥æœ‰å¤šä¸ª <code>file</code> æè¿°ç¬¦ï¼Œä½†éƒ½æŒ‡å‘åŒä¸€ä¸ª <code>inode</code>ã€‚</li>
</ul>
<div class="language-c highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="kt">dev_t</span><span class="w"> </span><span class="n">i_rdev</span><span class="p">;</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="k">struct</span><span class="w"> </span><span class="nc">cdev</span><span class="w"> </span><span class="o">*</span><span class="n">i_cdev</span><span class="p">;</span>
</span></code></pre></div>
</li>
</ul>
<h3 id="_15">æ³¨å†Œå­—ç¬¦è®¾å¤‡<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h3>
<p>å…ˆåˆå§‹åŒ–ï¼Œå†æ³¨å†Œï¼š</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">cdev</span><span class="w"> </span><span class="o">*</span><span class="n">my_cdev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cdev_alloc</span><span class="p">();</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="n">my_cdev</span><span class="o">-&gt;</span><span class="n">ops</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">my_fops</span><span class="p">;</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="kt">void</span><span class="w"> </span><span class="nf">cdev_init</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">cdev</span><span class="w"> </span><span class="o">*</span><span class="n">cdev</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">file_operations</span><span class="w"> </span><span class="o">*</span><span class="n">fops</span><span class="p">);</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="n">my_cdev</span><span class="o">-&gt;</span><span class="n">owner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">THIS_MODULE</span><span class="p">;</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="kt">int</span><span class="w"> </span><span class="nf">cdev_add</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">cdev</span><span class="w"> </span><span class="o">*</span><span class="n">dev</span><span class="p">,</span><span class="w"> </span><span class="kt">dev_t</span><span class="w"> </span><span class="n">num</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="p">);</span>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="kt">void</span><span class="w"> </span><span class="nf">cdev_del</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">cdev</span><span class="w"> </span><span class="o">*</span><span class="n">dev</span><span class="p">);</span>
</span></code></pre></div>
<h3 id="_16">æ‰“å¼€å’Œé‡Šæ”¾<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h3>
<p><code>open</code> çš„å·¥ä½œï¼š</p>
<ul>
<li>æ£€æŸ¥è®¾å¤‡ç›¸å…³é”™è¯¯ã€‚</li>
<li>å¦‚æœç¬¬ä¸€æ¬¡æ‰“å¼€ï¼Œåˆå§‹åŒ–è®¾å¤‡ã€‚</li>
<li>å¿…è¦æ—¶æ›´æ–° <code>f_op</code>ã€‚</li>
<li>åˆ†é…å¹¶å¡«å…… <code>filp-&gt;private_data</code> ä¸­çš„ç»“æ„ã€‚</li>
</ul>
<p><code>release</code> çš„å·¥ä½œï¼š</p>
<ul>
<li>é‡Šæ”¾ <code>open</code> åˆ†é…çš„å†…å­˜ã€‚</li>
<li>å†æœ€åä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦å…³é—­æ—¶ï¼Œå…³é—­è®¾å¤‡ã€‚</li>
<li>ä¸æ˜¯æ¯ä¸ª <code>close</code> è°ƒç”¨éƒ½ä¼šå¯¼è‡´ <code>release</code> è°ƒç”¨ï¼Œå†…æ ¸åšäº†å¼•ç”¨è®¡æ•°ï¼Œå› æ­¤ <code>dup</code> å’Œ <code>fork</code> èƒ½å®‰å…¨ä½¿ç”¨æ–‡ä»¶ã€‚</li>
<li>ä½†æ¯æ¬¡ <code>close</code> æ—¶æ€»ä¼šè°ƒç”¨ <code>flush</code>ã€‚</li>
</ul>
<p>æ‚é¡¹ï¼š</p>
<ul>
<li><code>container_of(pointer, container_type, container_field)</code> å®ï¼Œå®šä¹‰äº <code>linux/kernel.h</code>ï¼Œç”¨äºä»ç»“æ„ä½“çš„æˆå‘˜æŒ‡é’ˆè·å–ç»“æ„ä½“æŒ‡é’ˆã€‚</li>
</ul>
<h3 id="scull_1">scull çš„å†…å­˜ä½¿ç”¨<a class="headerlink" href="#scull_1" title="Permanent link">&para;</a></h3>
<div class="language-c highlight"><span class="filename">linux/slab.h</span><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="nf">kmalloc</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">gfp_t</span><span class="w"> </span><span class="n">flags</span><span class="p">);</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="kt">void</span><span class="w"> </span><span class="nf">kfree</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">ptr</span><span class="p">);</span>
</span></code></pre></div>
<h3 id="_17">è¯»å’Œå†™<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h3>
<div class="language-c highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="kt">ssize_t</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">read</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">file</span><span class="w"> </span><span class="o">*</span><span class="n">filp</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">__user</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">count</span><span class="p">,</span><span class="w"> </span><span class="n">loff_t</span><span class="w"> </span><span class="o">*</span><span class="n">offp</span><span class="p">);</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="kt">ssize_t</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">write</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">file</span><span class="w"> </span><span class="o">*</span><span class="n">filp</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">__user</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">count</span><span class="p">,</span><span class="w"> </span><span class="n">loff_t</span><span class="w"> </span><span class="o">*</span><span class="n">offp</span><span class="p">);</span>
</span></code></pre></div>
<p>æ³¨æ„ç¼“å†²åŒºæ˜¯ç”¨æˆ·ç©ºé—´åœ°å€ï¼Œæ— æ³•è¢«å†…æ ¸ç¨‹åºç›´æ¥è®¿é—®ã€‚æœ‰å‡ ä¸ªåŸå› ï¼š</p>
<ul>
<li>æ ¹æ®ä½“ç³»ç»“æ„çš„ä¸åŒï¼Œç”¨æˆ·ç©ºé—´çš„åœ°å€å¯èƒ½åœ¨å†…æ ¸ç©ºé—´ä¸­æ— æ•ˆã€‚</li>
<li>å³ä½¿æ˜¯åŒä¸€ä¸ªåœ°å€ï¼Œç”¨æˆ·ç©ºé—´å†…å­˜æ˜¯åˆ†é¡µçš„ï¼Œå¯èƒ½ä¸åœ¨ RAM ä¸­ï¼Œä¼šè®©å†…æ ¸äº§ç”Ÿæ®µé”™è¯¯ã€‚</li>
<li>å®‰å…¨é—®é¢˜ã€‚</li>
</ul>
<div class="language-c highlight"><span class="filename">asm/uaccess.h</span><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="nf">copy_to_user</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="n">__user</span><span class="w"> </span><span class="o">*</span><span class="n">to</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">from</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">n</span><span class="p">);</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="nf">copy_from_user</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">to</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">__user</span><span class="w"> </span><span class="o">*</span><span class="n">from</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">n</span><span class="p">);</span>
</span></code></pre></div>
<p>æ‹·è´æ—¶è¿›ç¨‹å¯èƒ½è¢« sleepï¼ˆç­‰å¾…é¡µä»ç£ç›˜åŠ è½½åˆ°å†…å­˜ï¼‰ï¼Œå› æ­¤éœ€è¦è€ƒè™‘å¹¶å‘å’Œ reentrantã€‚</p>
<p><a class="glightbox" href="../ldd3.assets/ldd_ch3_dev_read.webp" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="ldd_ch3_dev_read" src="../ldd3.assets/ldd_ch3_dev_read.webp" /></a></p>
<p><code>read</code> å‡½æ•°çš„è¿”å›å€¼ï¼š</p>
<ul>
<li>ä¸è¦æ±‚çš„å­—èŠ‚æ•°ç›¸åŒï¼Œè¡¨ç¤ºæˆåŠŸã€‚</li>
<li>å°äºè¦æ±‚çš„å­—èŠ‚æ•°ï¼Œæœ‰å¤šç§åŸå› ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç”¨æˆ·ç¨‹åºä¼šå†æ¬¡å°è¯•ï¼Œç›´åˆ°ä¼ è¾“å®Œæˆã€‚</li>
<li>0ï¼Œè¡¨ç¤ºåˆ°è¾¾æ–‡ä»¶å°¾ã€‚</li>
<li>è´Ÿæ•°ï¼Œè¡¨ç¤ºé”™è¯¯ã€‚</li>
</ul>
<p>æ­¤å¤–è¿˜æœ‰å½“å‰æ²¡æœ‰æ•°æ®ï¼Œä½†é©¬ä¸Šä¼šæœ‰æ•°æ®çš„æƒ…å†µï¼Œåœ¨åæ–‡è®¨è®ºé˜»å¡æ—¶è¯¦ç»†è¯´æ˜ã€‚</p>
<p><code>write</code> å‡½æ•°è¿”å›å€¼å’Œ <code>read</code> ä¸€è‡´ã€‚</p>
<p>å®ƒä»¬æœ‰å‘é‡ç‰ˆæœ¬ï¼š</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="kt">ssize_t</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">readv</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">file</span><span class="w"> </span><span class="o">*</span><span class="n">filp</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">iovec</span><span class="w"> </span><span class="o">*</span><span class="n">iov</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">count</span><span class="p">,</span><span class="w"> </span><span class="n">loff_t</span><span class="w"> </span><span class="o">*</span><span class="n">pos</span><span class="p">);</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="kt">ssize_t</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">writev</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">file</span><span class="w"> </span><span class="o">*</span><span class="n">filp</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">iovec</span><span class="w"> </span><span class="o">*</span><span class="n">iov</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">count</span><span class="p">,</span><span class="w"> </span><span class="n">loff_t</span><span class="w"> </span><span class="o">*</span><span class="n">pos</span><span class="p">);</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="k">struct</span><span class="w"> </span><span class="nc">iovec</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">__user</span><span class="w"> </span><span class="o">*</span><span class="n">iov_base</span><span class="p">;</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="w">    </span><span class="n">__kernel_size_t</span><span class="w"> </span><span class="n">iov_len</span><span class="p">;</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="p">};</span>
</span></code></pre></div>
<h3 id="_18">ä½¿ç”¨æ–°è®¾å¤‡<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h3>
<p>å¯ä»¥ç”¨å®ƒåƒæ»¡å†…å­˜ï¼š</p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>cp<span class="w"> </span>/dev/zero<span class="w"> </span>/dev/scull0
</span></code></pre></div>
<p>ä½¿ç”¨ <code>strace</code> å¯ä»¥æŸ¥çœ‹é©±åŠ¨ä¸­çš„ç³»ç»Ÿè°ƒç”¨ã€‚</p>
<h2 id="_19">ç¬¬å››ç« ï¼šè°ƒè¯•æŠ€æœ¯<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h2>
<h3 id="_20">å†…æ ¸è°ƒè¯•æ”¯æŒ<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h3>
<p>è‡ªè¡Œç¼–è¯‘å†…æ ¸ï¼Œå¯ç”¨ä¸€èˆ¬å‘è¡Œç‰ˆè‡ªå¸¦å†…æ ¸æ²¡æœ‰å¯ç”¨çš„è°ƒè¯•é€‰é¡¹ã€‚</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>CONFIG_DEBUG_KERNEL
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>CONFIG_DEBUG_SLAB
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>CONFIG_DEBUG_PAGEALLOC
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>CONFIG_DEBUG_SPINLOCK
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>CONFIG_DEBUG_SPINLOCK_SLEEP
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>...
</span></code></pre></div>
<h3 id="_21">é€šè¿‡æ‰“å°è°ƒè¯•<a class="headerlink" href="#_21" title="Permanent link">&para;</a></h3>
<p>æœ¬èŠ‚æè¿°äº†å†…æ ¸æ—¥å¿—ç³»ç»Ÿï¼Œå¦‚ä½•æ§åˆ¶è¾“å‡ºçº§åˆ«ã€æ§åˆ¶å°è¾“å‡ºç­‰ã€‚</p>
<p>ä»‹ç»äº†é€šè¿‡å®åŒ…è£…çš„ä¾¿æ·è°ƒè¯•å‡½æ•°ï¼š</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="cp">#undef PDEBUG </span><span class="cm">/* undef it, just in case */</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="cp">#ifdef SCULL_DEBUG</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="cp"># ifdef __KERNEL__</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="cm">/* This one if debugging is on, and kernel space */</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="cp"># define PDEBUG(fmt, args...) printk( KERN_DEBUG &quot;scull: &quot; fmt, ## args)</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="cp"># else</span>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="cm">/* This one for user space */</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="cp"># define PDEBUG(fmt, args...) fprintf(stderr, fmt, ## args)</span>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a><span class="cp"># endif</span>
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a><span class="cp">#else</span>
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a><span class="cp"># define PDEBUG(fmt, args...) </span><span class="cm">/* not debugging: nothing */</span>
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a><span class="cp">#endif</span>
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a><span class="cp">#undef PDEBUGG</span>
</span><span id="__span-24-14"><a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a><span class="cp">#define PDEBUGG(fmt, args...) </span><span class="cm">/* nothing: it&#39;s a placeholder */</span>
</span></code></pre></div>
<div class="language-makefile highlight"><span class="filename">Makefile</span><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="c"># Comment/uncomment the following line to disable/enable debugging</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="nv">DEBUG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>y
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="c"># Add your debugging flag (or not) to CFLAGS</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="cp">ifeq ($(DEBUG),y)</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="w">  </span><span class="nv">DEBFLAGS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>-O<span class="w"> </span>-g<span class="w"> </span>-DSCULL_DEBUG<span class="w"> </span><span class="c1"># &quot;-O&quot; is needed to expand inlines</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="cp">else</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a><span class="w">  </span><span class="nv">DEBFLAGS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>-O2
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a><span class="cp">endif</span>
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a>
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a><span class="nv">CFLAGS</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="k">$(</span>DEBFLAGS<span class="k">)</span>
</span></code></pre></div>
<p>å¯¹äºé©±åŠ¨è¿˜æœ‰ä¸€äº›å‡½æ•°ï¼š</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="kt">int</span><span class="w"> </span><span class="nf">print_dev_t</span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="kt">dev_t</span><span class="w"> </span><span class="n">dev</span><span class="p">);</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="nf">format_dev_t</span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="kt">dev_t</span><span class="w"> </span><span class="n">dev</span><span class="p">);</span>
</span></code></pre></div>
<h3 id="_22">é€šè¿‡æŸ¥è¯¢è°ƒè¯•<a class="headerlink" href="#_22" title="Permanent link">&para;</a></h3>
<p><code>/proc</code> æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ¯ä¸ªæ–‡ä»¶éƒ½å¯¹åº”ä¸€ä¸ªå†…æ ¸å‡½æ•°ï¼Œäº§ç”Ÿè¯¥æ–‡ä»¶çš„å†…å®¹ã€‚</p>
<div class="language-c highlight"><span class="filename">linux/proc_fs.h</span><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="kt">int</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">read_proc</span><span class="p">)(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">page</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">start</span><span class="p">,</span><span class="w"> </span><span class="kt">off_t</span><span class="w"> </span><span class="n">offset</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">eof</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">);</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="k">struct</span><span class="w"> </span><span class="nc">proc_dir_entry</span><span class="w"> </span><span class="o">*</span><span class="n">create_proc_read_entry</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="p">,</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="w">    </span><span class="kt">mode_t</span><span class="w"> </span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">proc_dir_entry</span><span class="w"> </span><span class="o">*</span><span class="n">base</span><span class="p">,</span>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="w">    </span><span class="n">read_proc_t</span><span class="w"> </span><span class="o">*</span><span class="n">read_proc</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">);</span>
</span></code></pre></div>
<p>æœ¬èŠ‚è¿˜ä»‹ç»äº† <code>seq_file</code> æ¥å£ã€‚</p>
<h3 id="_23">é€šè¿‡è§‚æµ‹è°ƒè¯•<a class="headerlink" href="#_23" title="Permanent link">&para;</a></h3>
<p>æœ¬èŠ‚ä»‹ç»ä½¿ç”¨ <code>strace</code> è§‚å¯Ÿä»ç”¨æˆ·ç©ºé—´å‘å‡ºçš„ç³»ç»Ÿè°ƒç”¨ã€‚</p>
<h3 id="_24">è°ƒè¯•ç³»ç»Ÿé”™è¯¯<a class="headerlink" href="#_24" title="Permanent link">&para;</a></h3>
<p>é©±åŠ¨å‘ç”Ÿé”™è¯¯æ—¶ï¼Œå¯èƒ½å¯¼è‡´ä½¿ç”¨è¯¥é©±åŠ¨çš„åº”ç”¨ç¨‹åºå´©æºƒã€‚æ­¤æ—¶åŠ¨æ€åˆ†é…åˆ°è¯¥ä¸Šä¸‹æ–‡çš„æ•°æ®å¯èƒ½ä¸¢å¤±ã€‚ç¨‹åºå´©æºƒæ—¶ï¼Œå†…æ ¸ä¼šä½¿ç”¨ <code>close</code> å…³é—­æ‰“å¼€çš„æ–‡ä»¶ï¼Œé©±åŠ¨ç¨‹åºå¯ä»¥æ”¶å› <code>open</code> æ—¶åˆ†é…çš„èµ„æºã€‚</p>
<p>å‘ç”Ÿé”™è¯¯æ—¶ï¼Œoops æ¶ˆæ¯æ‰“å°å¤„ç†å™¨å½“å‰çŠ¶æ€ï¼Œå¦‚å¯„å­˜å™¨ã€EIP ç­‰ã€‚æœ¬èŠ‚ç”¨è§£å¼•ç”¨ NULL æŒ‡é’ˆå’Œç¼“å†²åŒºæº¢å‡ºä¸¤ä¸ªä¾‹å­æ¼”ç¤ºäº†å¦‚ä½•é˜…è¯» oops æ¶ˆæ¯ã€‚</p>
<p>è¿˜ä»‹ç»äº†åº”å¯¹æ­»æœºçš„æ–¹æ³•ã€‚</p>
<h3 id="_25">è°ƒè¯•å™¨å’Œç›¸å…³å·¥å…·<a class="headerlink" href="#_25" title="Permanent link">&para;</a></h3>
<p>ä»‹ç»äº†ä½¿ç”¨ GDBã€kdb å’Œå…¶ä»–å„ç±»å·¥å…·è°ƒè¯•å†…æ ¸çš„æ–¹æ³•ã€‚ç”±äºæ²¡æœ‰è‡ªè¡Œç¼–è¯‘å†…æ ¸ï¼Œæ•…ç•¥å»ã€‚</p>
<p>æœ‰è¶£çš„æ˜¯æœ¬èŠ‚æåŠäº†å†…æ ¸ä¸ºä»€ä¹ˆä¸æä¾›è°ƒè¯•å™¨ï¼š</p>
<blockquote>
<p>The answer, quite simply, is that Linus does not
believe in interactive debuggers. He fears that they lead to poor fixes, those which
patch up symptoms rather than addressing the real cause of problems. Thus, no
built-in debuggers.</p>
</blockquote>
<h2 id="_26">ç¬¬äº”ç« ï¼šå¹¶å‘å’Œç«äº‰æ¡ä»¶<a class="headerlink" href="#_26" title="Permanent link">&para;</a></h2>
<h3 id="_27">å¹¶å‘åŠå…¶ç®¡ç†<a class="headerlink" href="#_27" title="Permanent link">&para;</a></h3>
<p>ç¡¬ä»¶å’Œå¾ˆå¤šè½¯ä»¶èµ„æºéƒ½éœ€è¦å…±äº«ï¼Œä¸€èˆ¬ä½¿ç”¨é”æœºåˆ¶æ¥æ§åˆ¶çº¿ç¨‹å¯¹å…±äº«èµ„æºçš„è®¿é—®ã€‚</p>
<h3 id="semaphoremutex">æ——è¯­ï¼ˆSemaphoreï¼‰å’Œé”ï¼ˆMutexï¼‰<a class="headerlink" href="#semaphoremutex" title="Permanent link">&para;</a></h3>
<p>æ——è¯­ç”±ä¸€ä¸ªæ•´æ•°å€¼å’Œ Pã€V æ“ä½œç»„æˆã€‚å½“è¿›ç¨‹è¿›å…¥å…³é”®åŒºæ—¶ä½¿ç”¨ P æ“ä½œå°†å€¼å‡ä¸€ï¼Œç¦»å¼€æ—¶ä½¿ç”¨ V æ“ä½œå°†å€¼åŠ ä¸€ã€‚å½“å€¼ä¸º 0 æ—¶ï¼Œè¿›ç¨‹ä¼šè¢«é˜»å¡ã€‚</p>
<p>å°†æ——è¯­æ•´æ•°å€¼è®¾ç½®ä¸º 1 å³å¯å®ç°äº’æ–¥é”ï¼Œæœ‰æ—¶ç§°ä¸º mutexï¼ˆå³ mutual exclusionï¼‰ã€‚</p>
<p>åœ¨ Linux ä¸­ï¼ŒV å¯¹åº” <code>up</code>ï¼ŒP å¯¹åº” <code>down</code>ã€‚æºç ç›®å‰ä½äº <a href="https://github.com/torvalds/linux/blob/master/include/linux/semaphore.h">linux/include/semaphore.h</a>ã€‚</p>
<p>æ­¤å¤–ï¼Œå†…æ ¸è¿˜æä¾›</p>
<ul>
<li><code>rwsem</code> è¯»å†™é”ï¼Œå…è®¸å¤šä¸ªè¿›ç¨‹åŒæ—¶è¯»ï¼Œä½†åªå…è®¸ä¸€ä¸ªè¿›ç¨‹å†™ã€‚è¯»å†™é”å¯èƒ½é€ æˆé¥¥é¥¿ã€‚</li>
<li><code>completion</code> ç­‰å¾…æ“ä½œ/å­è¿›ç¨‹å®Œæˆã€‚</li>
<li><code>spinlock</code> å¯ä»¥ç”¨åœ¨ä¸å¯ sleep çš„ä»»åŠ¡ï¼ˆå¦‚ä¸­æ–­å¤„ç†ï¼‰ä¸­ã€‚éœ€è¦è·å¾—é”çš„ç¨‹åºä¼šä¸æ–­è½®è®­ï¼Œå› æ­¤ç§°ä¸ºè‡ªæ—‹ã€‚è¿™ç§æƒ…å†µå®¹æ˜“é€ æˆæ­»é”ï¼šæŒæœ‰é”çš„çº¿ç¨‹ä¼‘çœ ï¼Œè€Œéœ€è¦é”çš„çº¿ç¨‹å ç”¨ CPUã€‚å› æ­¤ï¼ŒæŒæœ‰é”çš„è¿›ç¨‹åº”å½“æ‰§è¡ŒåŸå­åŒ–æ“ä½œï¼ˆæœŸé—´ä¸å¯ sleepï¼‰ã€‚</li>
<li><code>rwlock</code> è¯»å†™ç‰ˆçš„è‡ªæ—‹é”ã€‚</li>
</ul>
<p>ä¸åŒç±»å‹çš„é”é’ˆå¯¹ä¸åŒçš„ä½¿ç”¨åœºæ™¯è¿›è¡Œæ€§èƒ½ä¼˜åŒ–ã€‚</p>
<h3 id="_28">é”çš„å¸¸è§é”™è¯¯<a class="headerlink" href="#_28" title="Permanent link">&para;</a></h3>
<p>ç•¥ã€‚</p>
<h3 id="_29">é”çš„æ›¿ä»£å“<a class="headerlink" href="#_29" title="Permanent link">&para;</a></h3>
<p>circular bufferã€atomic variableã€seqlock ç­‰å¯ä»¥å®ç°æ— é”æ•°æ®ç»“æ„ã€‚è¿™äº›åœ¨é©±åŠ¨ä¸­å¾ˆå¸¸è§ï¼Œæ¯”å¦‚ç½‘ç»œé€‚é…å™¨å°±ä½¿ç”¨ circular bufferã€‚</p>
<p>æ­¤å¤–è¿˜æœ‰ Read-Copy-Update ç®—æ³•ï¼Œç±»ä¼¼äºå†™æ—¶å¤åˆ¶ã€‚</p>
<h2 id="_30">ç¬¬å…­ç« ï¼šé«˜çº§å­—ç¬¦é©±åŠ¨æ“ä½œ<a class="headerlink" href="#_30" title="Permanent link">&para;</a></h2>
<h3 id="ioctl">ioctl<a class="headerlink" href="#ioctl" title="Permanent link">&para;</a></h3>
<p>ç•¥</p>
<h3 id="io">é˜»å¡ I/O<a class="headerlink" href="#io" title="Permanent link">&para;</a></h3>
<p>å½“è¯»å†™è¯·æ±‚æ— æ³•ç«‹å³å®Œæˆæ—¶ï¼Œé©±åŠ¨ä¼šå°†è¿›ç¨‹ç½®äºç¡çœ çŠ¶æ€ã€‚æœ¬èŠ‚å­¦ä¹ è¿›ç¨‹ç¡çœ çš„ç›¸å…³çŸ¥è¯†ã€‚ç¡çœ å°±æ˜¯å°†è¿›ç¨‹æ ‡è®°ä¸ºä¸€ç§çŠ¶æ€ï¼Œä»è°ƒåº¦å™¨çš„å¯è¿è¡Œé˜Ÿåˆ—ä¸­ç§»é™¤ã€‚</p>
<ul>
<li>å¯ä»¥åœ¨ <code>wait_queue_head_t</code> ä¸­æ‰¾åˆ°æ­£åœ¨ç­‰å¾…çš„è¿›ç¨‹å¹¶å°†å…¶å”¤é†’ã€‚</li>
<li>ä½¿ç”¨ <code>wait_event(queue, condition)</code> ä½¿è¿›ç¨‹è¿›å…¥ç¡çœ ã€‚</li>
<li>ä½¿ç”¨ <code>wake_up(queue)</code> å”¤é†’è¿›ç¨‹ã€‚</li>
<li><code>filp-&gt;f_flags</code> æœ‰ <code>O_NONBLOCK</code> æ ‡è®°ï¼Œé©±åŠ¨å¯ä»¥è€ƒè™‘æ”¯æŒéé˜»å¡ I/Oã€‚æœ‰äº›æ“ä½œéœ€è¦èŠ±è´¹è¾ƒé•¿æ—¶é—´æ—¶å¯ä»¥ä½¿ç”¨éé˜»å¡ I/O è¿”å› <code>EAGAIN</code>ï¼Œè®©åº”ç”¨ç¨‹åºæ‰§è¡Œè½®è¯¢ã€‚</li>
</ul>
<p>æœ¬èŠ‚ä»¥ä¸€ä¸ªé˜»å¡ I/O çš„ä¾‹ç¨‹ç»“å°¾ï¼š</p>
<ul>
<li><code>read</code> è¯·æ±‚é˜»å¡ï¼Œç›´åˆ°ç¡¬ä»¶å‘å‡ºä¸­æ–­ã€‚ä½œä¸ºä¸­æ–­å¤„ç†çš„ä¸€éƒ¨åˆ†ï¼Œé©±åŠ¨å”¤é†’ç­‰å¾…çš„è¿›ç¨‹ã€‚</li>
<li>ç¤ºä¾‹ç¨‹åºå› ä¸ºæ²¡æœ‰ç¡¬ä»¶ï¼Œé‡‡ç”¨å¦ä¸€ä¸ªè¿›ç¨‹ç”Ÿæˆæ•°æ®å¹¶å”¤é†’ã€‚</li>
<li>é©±åŠ¨å…·æœ‰è¯»/å†™é˜Ÿåˆ—å’Œç¼“å†²åŒºã€‚</li>
</ul>
<p>æœ¬ç« å‰©ä½™éƒ¨åˆ†æš‚ç•¥ã€‚</p>
<h2 id="_31">ç¬¬ä¸ƒç« ï¼šæ—¶é—´ã€å»¶è¿Ÿä¸å»¶åå·¥ä½œ<a class="headerlink" href="#_31" title="Permanent link">&para;</a></h2>
<p>ç°å®ä¸–ç•Œä¸­çš„é©±åŠ¨è¿˜éœ€è¦å¤„ç†æ—¶é—´ã€å†…å­˜ç®¡ç†å’Œç¡¬ä»¶è®¿é—®ç­‰é—®é¢˜ã€‚</p>
<h3 id="_32">æµ‹é‡æ—¶é—´<a class="headerlink" href="#_32" title="Permanent link">&para;</a></h3>
<ul>
<li>ä½¿ç”¨å†…æ ¸çš„ <code>jiffies</code> è®¡æ•°å™¨ï¼šå†…æ ¸é€šè¿‡æ—¶é’Ÿä¸­æ–­æ¥è®°å½•æ—¶é—´ã€‚æ—¶é’Ÿä¸­æ–­ä¸€èˆ¬ 1000 æ¬¡/ç§’ï¼Œå¯ä»¥é€šè¿‡ <code>HZ</code> å®æŸ¥çœ‹ã€‚æ—¶é’Ÿä¸­æ–­å‘ç”Ÿæ—¶ï¼Œå†…æ ¸ä¸­çš„è®¡æ•°å™¨ <code>jiffies</code> å°±é€’å¢ã€‚</li>
<li>
<p>ä½¿ç”¨å¹³å°ç‰¹å®šçš„å¯„å­˜å™¨ï¼šå¦‚æœéœ€è¦æµ‹é‡ç²¾ç¡®çš„æ—¶é—´ï¼Œå¯ä»¥ç‰ºç‰²ä¸€äº›ç§»æ¤æ€§ï¼Œä½¿ç”¨ç¡¬ä»¶çš„è®¡æ—¶å™¨ã€‚</p>
<ul>
<li>ç°ä»£ CPU çš„ç¼“å­˜ã€æŒ‡ä»¤é‡æ’ã€åˆ†æ”¯é¢„æµ‹ç­‰æŠ€æœ¯å¯¼è‡´æŒ‡ä»¤çš„æ—¶é—´æ— æ³•é¢„çŸ¥ã€‚å‚å•†é€šè¿‡æä¾›æ—¶é’Ÿå‘¨æœŸè®¡æ•°å™¨è§£å†³é«˜ç²¾åº¦è®¡æ—¶çš„é—®é¢˜ã€‚</li>
<li>è¿™æ ·çš„è®¡æ—¶å™¨å› å¹³å°è€Œå¼‚ï¼Œå¯èƒ½ 64 ä½æˆ– 32 ä½ï¼Œå¯èƒ½åªè¯»æˆ–å¯å†™ï¼Œå¯èƒ½æ— æ³•ä»ç”¨æˆ·ç©ºé—´è®¿é—®ã€‚</li>
<li>
<p>æœ€æœ‰åçš„è®¡æ—¶å™¨æ˜¯ x86 å¹³å°ä¸Šçš„ TSCï¼ˆTime Stamp Counterï¼‰ã€‚è¿™ä¸ª 64 ä½å¯„å­˜å™¨è®°å½•æ—¶é’Ÿå‘¨æœŸæ•°ï¼Œå¯ä»¥ä»å†…æ ¸å’Œç”¨æˆ·ç©ºé—´è®¿é—®ã€‚</p>
<div class="language-c highlight"><span class="filename">asm/msr.h</span><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="n">rdtsc</span><span class="p">(</span><span class="n">low32</span><span class="p">,</span><span class="w"> </span><span class="n">high32</span><span class="p">);</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="n">rdtscl</span><span class="p">(</span><span class="n">low32</span><span class="p">);</span>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="n">rdtscll</span><span class="p">(</span><span class="n">var64</span><span class="p">);</span>
</span></code></pre></div>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œ1 GHz çš„ CPU çº¦ 4.2 ç§’æº¢å‡ºä¸€æ¬¡ 32 ä½è®¡æ•°å™¨ã€‚</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="n">unsinged</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">ini</span><span class="p">,</span><span class="w"> </span><span class="n">end</span><span class="p">;</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="n">rdtscl</span><span class="p">(</span><span class="n">ini</span><span class="p">);</span><span class="w"> </span><span class="n">rdtscl</span><span class="p">(</span><span class="n">end</span><span class="p">);</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="n">printk</span><span class="p">(</span><span class="s">&quot;Time: %lu</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ini</span><span class="p">);</span>
</span></code></pre></div>
</li>
<li>
<p>å†…æ ¸æä¾› <code>rdtsc</code> çš„æ›¿ä»£å“ <code>get_cycles</code>ï¼Œä¸å¹³å°æ— å…³ã€‚</p>
</li>
<li>
<p>æœ¬èŠ‚è¿˜ä»‹ç»äº†ä½¿ç”¨æ±‡ç¼–å†…è”ä»£ç çš„æ–¹æ³•ã€‚ä¸‹é¢è¿™ä¸ªå®åœ¨ MIPS å¹³å°ä¸Šå®ç°äº† <code>rdtsc</code>ï¼š</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="cp">#define rdtscl(dest) \</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="cp">    __asm__ __volatile__(&quot;mfc0 %0,$9; nop&quot; : &quot;=r&quot; (dest))</span>
</span></code></pre></div>
</li>
<li>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¹³å°ç‰¹å®šçš„è®¡æ—¶å™¨åœ¨ SMP ç³»ç»Ÿä¸Šå¯èƒ½ä¸åŒæ­¥ã€‚å› æ­¤ï¼Œéœ€è¦å…³é—­ Linux çš„æŠ¢å æœºåˆ¶ï¼Œä½¿å¾—ä»£ç å§‹ç»ˆåœ¨åŒä¸€ä¸ª CPU ä¸Šè¿è¡Œã€‚</p>
</li>
<li>å½“å‰æ—¶é—´ï¼ˆWall-clock timeï¼‰ï¼šè¿™ä¸ªè‹±æ–‡å¾ˆå½¢è±¡ï¼Œå°±æ˜¯æŒ‚è½½å¢™ä¸Šçš„é’Ÿçš„æ—¶é—´</li>
<li>å¯¹äºé©±åŠ¨æ¥è¯´ï¼Œä¸€èˆ¬ä¸ä¼šä½¿ç”¨è¿™ä¸ªæ—¶é—´ã€‚ç›¸å…³æ“ä½œä¸€èˆ¬æ”¾åˆ°ç”¨æˆ·ç©ºé—´è¿›è¡Œï¼Œå¦‚ <code>cron</code>ã€‚</li>
<li>å†…æ ¸æä¾›äº† <code>gettimeofday</code> ç­‰å‡½æ•°ï¼Œå¯ä»¥è·å–å½“å‰æ—¶é—´æˆ³ã€‚</li>
</ul>
</li>
</ul>
<h3 id="_33">å»¶è¿Ÿæ‰§è¡Œ<a class="headerlink" href="#_33" title="Permanent link">&para;</a></h3>
<p>ç•¥</p>
<h2 id="_34">ç¬¬å…«ç« ï¼šåˆ†é…å†…å­˜<a class="headerlink" href="#_34" title="Permanent link">&para;</a></h2>
<h3 id="kmalloc"><code>kmalloc</code> çš„ç»†èŠ‚<a class="headerlink" href="#kmalloc" title="Permanent link">&para;</a></h3>
<div class="language-c highlight"><span class="filename">linux/slab.h</span><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="nf">kmalloc</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">flags</span><span class="p">);</span>
</span></code></pre></div>
<p>æœ€å¸¸ç”¨çš„ <code>flags</code> æ˜¯ <code>GFP_KERNEL</code> å’Œ <code>GFP_ATOMIC</code>ã€‚å‰è€…è¡¨ç¤ºä¸ºä¸€ä¸ªè¿›ç¨‹åˆ†é…å†…å­˜ï¼Œå¯èƒ½ä¼šç¡çœ ï¼›åè€…å¯ç”¨äºä¸­æ–­å¤„ç†ç¨‹åºç­‰ä¸åœ¨è¿›ç¨‹ä¸Šä¸‹æ–‡ä¸­çš„åœ°æ–¹ï¼Œä¸”ä¸ä¼šç¡çœ ã€‚</p>
<p>Linux å†…æ ¸çŸ¥é“è‡³å°‘ä¸‰ç§å†…å­˜åŒºåŸŸï¼šDMA ä½¿èƒ½å†…å­˜ã€æ™®é€šå†…å­˜å’Œé«˜ç«¯å†…å­˜ã€‚ä½¿ç”¨ä¸åŒçš„ <code>flags</code> å¯ä»¥æŒ‡å®šä»ä¸åŒçš„åŒºåŸŸåˆ†é…å†…å­˜ã€‚</p>
<ul>
<li>å¯¹äºç»å¤§å¤šæ•°å¹³å°ï¼Œæ‰€æœ‰çš„å†…å­˜éƒ½åœ¨ DMA åŒºåŸŸã€‚</li>
<li>é«˜ç«¯å†…å­˜ç”¨äº x86 å¹³å°è®¿é—®å¤§é‡å†…å­˜ï¼Œéœ€è¦å»ºç«‹ç‰¹åˆ«çš„æ˜ å°„ã€‚</li>
<li>å¯¹äº NUMA æ¶æ„æ¥è¯´ï¼Œä¼šå°½é‡åˆ†é…æœ¬åœ°å†…å­˜ã€‚</li>
</ul>
<p>Linux åˆ›å»ºå†…å­˜æ± ï¼Œå†…å­˜å‚¨ä¸­æœ‰å›ºå®šå¤§å°çš„å†…å­˜å¯¹è±¡ã€‚åˆ†é…å†…å­˜æ—¶ï¼Œä»å…·æœ‰è¶³å¤Ÿå¤§çš„å†…å­˜å¯¹è±¡çš„æ± ä¸­å–å‡ºå†…å­˜ï¼Œå°†å…¶æ•´å—è¿”å›ç»™è°ƒç”¨è€…ã€‚å†…æ ¸ç¼–ç¨‹è€…åº”å½“æ³¨æ„è¿™ä¸€ç‚¹ï¼Œå³åˆ†é…çš„å†…å­˜å¯èƒ½æ¯”è¯·æ±‚çš„å†…å­˜å¤§ã€‚</p>
<p>æœ¬èŠ‚æ²¡æœ‰æ·±å…¥æ¢ç©¶å…·ä½“æœºåˆ¶ã€‚</p>
<h3 id="lookaside">Lookaside ç¼“å­˜<a class="headerlink" href="#lookaside" title="Permanent link">&para;</a></h3>
<p>æœ¬ç« å‰©ä½™éƒ¨åˆ†ç•¥ã€‚</p>
<h2 id="_35">ç¬¬ä¹ç« ï¼šä¸ç¡¬ä»¶æ²Ÿé€š<a class="headerlink" href="#_35" title="Permanent link">&para;</a></h2>
<h3 id="io-io">I/O ç«¯å£å’Œ I/O å†…å­˜<a class="headerlink" href="#io-io" title="Permanent link">&para;</a></h3>
<p>è¿™æ˜¯ä¸¤ç§ä¸åŒçš„ç¡¬ä»¶è®¿é—®æ–¹å¼ï¼š</p>
<ul>
<li>å¤–å›´è®¾å¤‡é€šè¿‡è¯»/å†™å…¶å¯„å­˜å™¨è¿›è¡Œæ§åˆ¶ã€‚æ¯ä¸ªè®¾å¤‡æœ‰ä¸€äº›å¯„å­˜å™¨ï¼Œåœ¨å†…å­˜åœ°å€ç©ºé—´æˆ– I/O åœ°å€ç©ºé—´ä¸­è¿ç»­åˆ†å¸ƒã€‚åœ¨ç¡¬ä»¶å±‚é¢ä¸Šï¼Œè¿™äº›åœ°å€ç©ºé—´æ²¡æœ‰æœ¬è´¨åŒºåˆ«ï¼Œéƒ½æ˜¯å‘åœ°å€æ€»çº¿å’Œæ§åˆ¶æ€»çº¿å‘é€ä¿¡å·ï¼Œä»æ•°æ®æ€»çº¿è¯»å–æˆ–å†™å…¥æ•°æ®ã€‚<ul>
<li>æœ‰äº› CPUï¼ˆå¦‚ x86ï¼‰åˆ™åŒºåˆ†å†…å­˜å’Œ I/O åœ°å€ç©ºé—´ï¼Œä½¿ç”¨ä¸“é—¨çš„æŒ‡ä»¤è®¿é—® I/O ç«¯å£ã€‚</li>
<li>æœ‰çš„ CPU ä½¿ç”¨ç»Ÿä¸€åœ°å€ç©ºé—´ï¼Œæ²¡æœ‰ I/O ç«¯å£çš„æ¦‚å¿µã€‚ä½†å¤§å¤šæ•°æ€»çº¿æ ‡å‡†éƒ½æœ‰ I/O ç«¯å£çš„æ¦‚å¿µï¼Œè¿™äº› CPU å°±é€šè¿‡å†…/å¤–éƒ¨ç”µè·¯æ¨¡æ‹Ÿ I/O ç«¯å£ã€‚</li>
<li>Linux ä¹Ÿåœ¨æ‰€æœ‰å¹³å°ä¸Šå®ç° I/O ç«¯å£çš„æ¦‚å¿µï¼Œå³ä½¿åº•å±‚ CPU æ˜¯ç»Ÿä¸€åœ°å€ç©ºé—´ã€‚</li>
</ul>
</li>
<li>å³ä½¿å¤–å›´æ€»çº¿æœ‰ I/O ç«¯å£ç‹¬ç«‹çš„åœ°å€ç©ºé—´ï¼Œæœ‰äº›è®¾å¤‡ä¹Ÿä¸ä¼šæŠŠå¯„å­˜å™¨æ˜ å°„åˆ° I/O ç«¯å£ï¼Œè€Œæ˜¯æ˜ å°„åˆ°å†…å­˜åœ°å€ç©ºé—´ï¼ˆæ¯”å¦‚ PCI è®¾å¤‡ï¼‰ï¼Œå› ä¸ºè¿™æ ·ï¼šä¸éœ€è¦ä¸“é—¨çš„ CPU æŒ‡ä»¤ã€è®¿é—®æ•ˆç‡æ›´é«˜ã€ç¼–è¯‘å™¨åœ¨å¯„å­˜å™¨åˆ†é…å’Œè®¿å­˜æ¨¡å¼çš„é€‰æ‹©ä¸Šæ›´çµæ´»ã€‚</li>
</ul>
<p>I/O æ“ä½œæœ‰å‰¯ä½œç”¨ï¼Œè€Œå†…å­˜æ²¡æœ‰ï¼š</p>
<ul>
<li>å†…å­˜å¯¹ CPU çš„æ€§èƒ½éå¸¸é‡è¦ï¼Œå› æ­¤è¿›è¡Œäº†å¾ˆå¤šä¼˜åŒ–ï¼š<ul>
<li>ç¼–è¯‘å™¨å¯ä»¥è¿›è¡Œç¼“å­˜ï¼Œä½¿ç”¨å¯„å­˜å™¨æˆ– CPU Cacheï¼Œä¸è¿›å…¥ç‰©ç†å†…å­˜ã€‚</li>
<li>ç¼–è¯‘å’Œç¡¬ä»¶æ‰§è¡Œæ—¶éƒ½å¯èƒ½å‘ç”Ÿé‡æ’ã€‚</li>
</ul>
</li>
<li>ä¸Šé¢è¿™äº›ä¼˜åŒ–ä¼šé€ æˆ I/O æ“ä½œçš„ Bugï¼Œå› æ­¤éœ€è¦è§£å†³ï¼š<ul>
<li>ç¼“å­˜é—®é¢˜ç”± Linux è§£å†³ï¼Œåœ¨è®¿é—® I/O åŒºåŸŸæ—¶å…³é—­æ‰€æœ‰ç¡¬ä»¶ç¼“å­˜ã€‚</li>
<li>
<p>ç¼–è¯‘å™¨å’Œç¡¬ä»¶çš„é‡æ’ä¼˜åŒ–é€šè¿‡ memory barrier è§£å†³ã€‚</p>
<div class="language-c highlight"><span class="filename">linux/kernel.h</span><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="kt">void</span><span class="w"> </span><span class="nf">barrier</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
</span></code></pre></div>
<div class="language-c highlight"><span class="filename">asm/system.h</span><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="kt">void</span><span class="w"> </span><span class="nf">mb</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="kt">void</span><span class="w"> </span><span class="nf">wmb</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span><span class="w"> </span><span class="c1">// write memory barrier</span>
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a><span class="kt">void</span><span class="w"> </span><span class="nf">rmb</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span><span class="w"> </span><span class="c1">// read memory barrier</span>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="kt">void</span><span class="w"> </span><span class="nf">smp_rmb</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span><span class="w"> </span><span class="c1">// read memory barrier for SMP</span>
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a><span class="p">...</span>
</span></code></pre></div>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä¸åŒæ­¥æœ‰å…³çš„åŸè¯­ï¼ˆå¦‚ spinlock å’Œ <code>atomic_t</code> æ“ä½œï¼‰ä¹Ÿä¼šèµ·åˆ° memory barrier çš„ä½œç”¨ã€‚</p>
</li>
</ul>
</li>
</ul>
<div class="admonition bug">
<p class="admonition-title">Avoid normal pointers!</p>
<p>Use wrapper functions instead.</p>
</div>
<h3 id="io_1">ä½¿ç”¨ I/O ç«¯å£<a class="headerlink" href="#io_1" title="Permanent link">&para;</a></h3>
<div class="language-c highlight"><span class="filename">linux/ioport.h</span><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">resource</span><span class="w"> </span><span class="o">*</span><span class="n">request_region</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">start</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">len</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="p">);</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="kt">void</span><span class="w"> </span><span class="nf">release_region</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">start</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">len</span><span class="p">);</span>
</span></code></pre></div>
<p>åœ¨ <code>/proc/ioports</code> ä¸­å¯ä»¥æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¸­çš„ I/O ç«¯å£ã€‚</p>
<p>ç¡¬ä»¶å¯èƒ½æä¾› 8ã€16ã€32 ä½çš„ç«¯å£ï¼Œå› æ­¤æœ‰ä¸åŒçš„å‡½æ•°ç”¨äºè®¿é—®ï¼š</p>
<div class="language-c highlight"><span class="filename">asm/io.h</span><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="kt">unsigned</span><span class="w"> </span><span class="nf">inb</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="n">port</span><span class="p">);</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="kt">void</span><span class="w"> </span><span class="nf">outb</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">byte</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">port</span><span class="p">);</span>
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="kt">unsigned</span><span class="w"> </span><span class="nf">inw</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="n">port</span><span class="p">);</span>
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a><span class="kt">void</span><span class="w"> </span><span class="nf">outw</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">word</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="n">port</span><span class="p">);</span>
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a><span class="p">...</span>
</span></code></pre></div>
<p>GNU C æä¾›äº†åœ¨ç”¨æˆ·ç©ºé—´è®¿é—® I/O ç«¯å£çš„æ–¹æ³•ï¼ˆ<code>&lt;sys/io.h&gt;</code>ï¼‰ï¼Œä½†æ˜¯éœ€è¦ç³»ç»Ÿè°ƒç”¨æ¥è·å–æƒé™ã€‚</p>
<p>æœ‰äº›å¤„ç†å™¨è¿˜å®ç°äº†ä¸€æ¬¡å‘ I/O ç«¯å£è¯»å†™å¤šä¸ªå­—èŠ‚çš„æŒ‡ä»¤ã€‚</p>
<p>I/O æŒ‡ä»¤ä¸å¤„ç†å™¨æ¶æ„ç´§å¯†ç›¸å…³ï¼Œæœ¬èŠ‚å‰©ä½™éƒ¨åˆ†æ¦‚è¿°äº† Linux æ”¯æŒçš„è¿™äº›æ¶æ„ã€‚</p>
<h3 id="io_2">ä¸€ä¸ª I/O ç«¯å£ä¾‹å­<a class="headerlink" href="#io_2" title="Permanent link">&para;</a></h3>
<p>å¤§å¤šæ•° I/O å¼•è„šæœ‰ä¸¤å¤„æ§åˆ¶ï¼š</p>
<ul>
<li>é€‰æ‹©é‚£äº›å¼•è„šç”¨äºè¾“å…¥/è¾“å‡º</li>
<li>è¯»å–æˆ–å†™å…¥é€»è¾‘ç”µå¹³</li>
</ul>
<p>A simple <strong>parallel port</strong> driver.</p>
<ul>
<li>
<p><strong>I/O Ports</strong>ï¼šTwo interface, begin at <code>0x378</code> and <code>0x278</code></p>
<p>Each interface consists of three ports:</p>
<div class="language-text highlight"><pre><span></span><code>- Port 1: Bidirectional data register
- Port 2: Read-only status register
- Port 3: Output-only control register
</code></pre></div>
</li>
<li>
<p><strong>Electrical Properties</strong>ï¼š</p>
<ul>
<li>Transistor-Transistor Logic (TTL), 0V and 5V.</li>
<li>25 Pins. Some of the pins are inverted.</li>
</ul>
</li>
</ul>
<p>The driver performs output operation as follows:</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="k">while</span><span class="p">(</span><span class="n">count</span><span class="o">--</span><span class="p">){</span>
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a><span class="w">    </span><span class="n">outb</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">ptr</span><span class="o">++</span><span class="p">),</span><span class="w"> </span><span class="n">port</span><span class="p">);</span>
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a><span class="w">    </span><span class="n">wmb</span><span class="p">();</span>
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="using-io-memory">Using I/O Memory<a class="headerlink" href="#using-io-memory" title="Permanent link">&para;</a></h3>
<p>I/O memory includes: memory-mapped <strong>registers</strong> and device memory.</p>
<p>Access through <strong>page tables</strong>? Depending on the arch and bus used:</p>
<ul>
<li>Through page table: call <code>ioremap</code> before doing I/O. Kernel arrange for physical address to be visible from driver.</li>
<li>Not through page table: like I/O ports.</li>
</ul>
<p>Steps before access I/O memory:</p>
<ul>
<li>
<p>Allocation:</p>
<div class="language-c highlight"><span class="filename">linux/ioport.h</span><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">resource</span><span class="w"> </span><span class="o">*</span><span class="n">request_mem_region</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">start</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">len</span><span class="p">,</span>
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="w">                            </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="p">);</span>
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a><span class="kt">void</span><span class="w"> </span><span class="nf">release_mem_region</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">start</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">len</span><span class="p">);</span>
</span></code></pre></div>
</li>
<li>
<p>Set up mapping: functions used to assign <strong>virtual addresses to I/O memory regions</strong></p>
<div class="language-c highlight"><span class="filename">asm/io.h</span><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="nf">ioremap</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">phys_addr</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">size</span><span class="p">);</span>
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="nf">ioremap_nocache</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">phys_addr</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">size</span><span class="p">);</span>
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="kt">void</span><span class="w"> </span><span class="nf">iounmap</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">addr</span><span class="p">);</span>
</span></code></pre></div>
</li>
<li>
<p>Accessor: in <code>asm/io.h</code></p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">ioread8</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">addr</span><span class="p">);</span>
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">ioread16</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">addr</span><span class="p">);</span>
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">ioread32</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">addr</span><span class="p">);</span>
</span><span id="__span-39-4"><a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a><span class="p">...</span>
</span><span id="__span-39-5"><a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a><span class="kt">void</span><span class="w"> </span><span class="n">iowrite8</span><span class="p">(</span><span class="n">u8</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">addr</span><span class="p">);</span>
</span><span id="__span-39-6"><a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a><span class="p">...</span>
</span><span id="__span-39-7"><a id="__codelineno-39-7" name="__codelineno-39-7" href="#__codelineno-39-7"></a><span class="c1">// repeat</span>
</span><span id="__span-39-8"><a id="__codelineno-39-8" name="__codelineno-39-8" href="#__codelineno-39-8"></a><span class="kt">void</span><span class="w"> </span><span class="n">ioread8_rep</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">addr</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">count</span><span class="p">);</span>
</span><span id="__span-39-9"><a id="__codelineno-39-9" name="__codelineno-39-9" href="#__codelineno-39-9"></a><span class="kt">void</span><span class="w"> </span><span class="nf">iowrite8_rep</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">addr</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">count</span><span class="p">);</span>
</span><span id="__span-39-10"><a id="__codelineno-39-10" name="__codelineno-39-10" href="#__codelineno-39-10"></a><span class="p">...</span>
</span><span id="__span-39-11"><a id="__codelineno-39-11" name="__codelineno-39-11" href="#__codelineno-39-11"></a><span class="c1">// block</span>
</span><span id="__span-39-12"><a id="__codelineno-39-12" name="__codelineno-39-12" href="#__codelineno-39-12"></a><span class="kt">void</span><span class="w"> </span><span class="n">memset_io</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">addr</span><span class="p">,</span><span class="w"> </span><span class="n">u8</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="p">);</span>
</span><span id="__span-39-13"><a id="__codelineno-39-13" name="__codelineno-39-13" href="#__codelineno-39-13"></a><span class="kt">void</span><span class="w"> </span><span class="nf">memcpy_fromio</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">dest</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="p">);</span>
</span><span id="__span-39-14"><a id="__codelineno-39-14" name="__codelineno-39-14" href="#__codelineno-39-14"></a><span class="kt">void</span><span class="w"> </span><span class="nf">memcpy_toio</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">dest</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">source</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="p">);</span>
</span></code></pre></div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="k">while</span><span class="p">(</span><span class="n">count</span><span class="o">--</span><span class="p">){</span>
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a><span class="w">    </span><span class="n">iowrite8</span><span class="p">(</span><span class="o">*</span><span class="n">prt</span><span class="o">++</span><span class="p">,</span><span class="w"> </span><span class="n">address</span><span class="p">);</span>
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a><span class="w">    </span><span class="n">wmb</span><span class="p">();</span>
</span><span id="__span-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a><span class="p">}</span>
</span></code></pre></div>
</div>
</li>
</ul>
<p>Ports as I/O memroy: makes I/O ports appear to be I/O memory</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="nf">ioport_map</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">port</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="p">);</span>
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a><span class="kt">void</span><span class="w"> </span><span class="nf">ioport_unmap</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">addr</span><span class="p">);</span>
</span></code></pre></div>
<div class="admonition note">
<p class="admonition-title">Industry Standard Architecture (ISA)</p>
<p>The term "ISA" used in this chapter does not refer to Instruction Set Architecture, but is a <strong>bus architecture</strong>.</p>
<p>See:</p>
<ul>
<li><a href="http://www.linux-tutorial.info/?page_id=267">Industry Standard Architecture ISA | The Linux Tutorial</a>.</li>
<li><a href="https://en.wikipedia.org/wiki/Industry_Standard_Architecture">Industry Standard Architecture - Wikipedia</a></li>
</ul>
</div>
<h2 id="_36">ç¬¬åç« ï¼šä¸­æ–­å¤„ç†<a class="headerlink" href="#_36" title="Permanent link">&para;</a></h2>
<h2 id="_37">ç¬¬åä¸€ç« ï¼šå†…æ ¸ä¸­çš„æ•°æ®ç±»å‹<a class="headerlink" href="#_37" title="Permanent link">&para;</a></h2>
<h2 id="pci">ç¬¬åäºŒç« ï¼šPCI é©±åŠ¨<a class="headerlink" href="#pci" title="Permanent link">&para;</a></h2>
<h2 id="usb">ç¬¬åä¸‰ç« ï¼šUSB é©±åŠ¨<a class="headerlink" href="#usb" title="Permanent link">&para;</a></h2>
<h2 id="linux">ç¬¬åå››ç« ï¼šLinux è®¾å¤‡æ¨¡å‹<a class="headerlink" href="#linux" title="Permanent link">&para;</a></h2>
<p>2.5 ç‰ˆæœ¬å†…æ ¸çš„å¼€å‘å·¥ä½œä¸»è¦é›†ä¸­åœ¨åˆ›å»ºç»Ÿä¸€çš„è®¾å¤‡æ¨¡å‹ä¸Šã€‚</p>
<p><a class="glightbox" href="../ldd3.assets/ldd_ch14_1.webp" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="ldd_ch14_1" src="../ldd3.assets/ldd_ch14_1.webp" /></a></p>
<p>ç»Ÿä¸€çš„è®¾å¤‡æ¨¡å‹ä¸ºä¸‹åˆ—åŠŸèƒ½æä¾›åŸºç¡€ï¼š</p>
<ul>
<li>ç”µæºç®¡ç†</li>
<li>ç”¨æˆ·ç©ºé—´ï¼š<code>sysfs</code> å¯ä»¥æŸ¥çœ‹å’Œä¿®æ”¹è®¾å¤‡çŠ¶æ€</li>
<li>çƒ­æ’æ‹”</li>
<li>è®¾å¤‡ç±»åˆ«ï¼ˆclassesï¼‰</li>
<li>å¯¹è±¡ç”Ÿå‘½å‘¨æœŸ</li>
</ul>
<h3 id="kobject-kset"><code>Kobject</code> å’Œ <code>Kset</code><a class="headerlink" href="#kobject-kset" title="Permanent link">&para;</a></h3>
<p>åœ¨äº†è§£å…·ä½“å®ç°å‰ï¼Œå…ˆçœ‹çœ‹ <code>kobject</code> æ˜¯å¦‚ä½•è¢«ä½¿ç”¨çš„ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ä¸ä¼šä½¿ç”¨ç‹¬ç«‹çš„ <code>kobject</code>ï¼Œè€Œæ˜¯å°†å…¶åµŒå…¥åˆ°å…¶ä»–ç»“æ„ä½“ä¸­ã€‚ç”¨é¢å‘å¯¹è±¡çš„æ€æƒ³ç†è§£ï¼Œå¯ä»¥è®¤ä¸º <code>kobject</code> æ˜¯ä¸€ä¸ªåŸºç±»ï¼Œå…¶ä»–ç»“æ„ä½“æ˜¯æ´¾ç”Ÿç±»ã€‚</p>
<ul>
<li>ä»å…¶ä»–ç»“æ„ä½“çš„ <code>.kobj</code> æˆå‘˜å¯ä»¥è®¿é—® <code>kobject</code>ï¼Œå¯¹ <code>kobject</code> ä½¿ç”¨ <code>container_of()</code> å®å¯ä»¥è·å–åˆ°å…¶ä»–ç»“æ„ä½“ã€‚</li>
<li><code>kobject</code> æä¾›ï¼šå¼•ç”¨è®¡æ•°ã€<code>sysfs</code> è¡¨ç¤ºã€æ•°æ®ç»“æ„èƒ¶æ°´å’Œçƒ­æ’æ‹”å¤„ç†ç­‰åŠŸèƒ½ã€‚</li>
<li>å¸¸è§ä½¿ç”¨æ­¥éª¤ï¼š<ul>
<li>å°† <code>kobject</code> ä½œä¸ºåµŒå…¥ç»“æ„ä½“çš„ä¸€éƒ¨åˆ†ï¼Œä½¿ç”¨ <code>memset()</code> åˆå§‹åŒ–ä¸º 0ã€‚</li>
<li><code>kobject_init()</code> å°†å¼•ç”¨è®¡æ•°ç½® 1ã€‚</li>
<li><code>kobject_set_name()</code> è®¾ç½®åå­—ï¼Œç”¨äº <code>sysfs</code>ã€‚</li>
<li>æ€»çš„æ¥è¯´ï¼Œåˆ›å»ºè€…éœ€è¦è®¾ç½®å…¶ <code>ktype</code>ã€<code>parent</code> å’Œ <code>kset</code> æˆå‘˜ã€‚</li>
</ul>
</li>
<li>
<p>å¼•ç”¨è®¡æ•°ï¼š</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">kobject</span><span class="w"> </span><span class="o">*</span><span class="n">kobject_get</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">kobject</span><span class="w"> </span><span class="o">*</span><span class="n">kobj</span><span class="p">);</span>
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a><span class="kt">void</span><span class="w"> </span><span class="nf">kobject_put</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">kobject</span><span class="w"> </span><span class="o">*</span><span class="n">kobj</span><span class="p">);</span>
</span></code></pre></div>
<p>åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œå¼•ç”¨è®¡æ•°å¹¶ä¸èƒ½å®Œå…¨è§£å†³é—®é¢˜ï¼Œæ¯”å¦‚ <code>kobject</code> ä½œä¸ºå†…æ ¸æ¨¡å—çš„ä¸€éƒ¨åˆ†ï¼Œå¦‚æœå®ƒåœ¨è¢«ä½¿ç”¨ï¼Œé‚£ä¹ˆå°±ä¸èƒ½å¸è½½å¯¹åº”çš„æ¨¡å—ã€‚å¾ˆå¤šç»“æ„ä½“åŒ…å« <code>struct module</code> æŒ‡é’ˆï¼Œåœ¨ç»´æŠ¤å¼•ç”¨è®¡æ•°æ—¶æ£€æŸ¥ï¼š</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">kobject</span><span class="w"> </span><span class="o">*</span><span class="n">cdev_get</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">cdev</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">)</span>
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a><span class="p">{</span>
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">module</span><span class="w"> </span><span class="o">*</span><span class="n">owner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="o">-&gt;</span><span class="n">owner</span><span class="p">;</span>
</span><span id="__span-43-4"><a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">kobject</span><span class="w"> </span><span class="o">*</span><span class="n">kobj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">kobj</span><span class="p">;</span>
</span><span id="__span-43-5"><a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">owner</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">try_module_get</span><span class="p">(</span><span class="n">owner</span><span class="p">))</span>
</span><span id="__span-43-6"><a id="__codelineno-43-6" name="__codelineno-43-6" href="#__codelineno-43-6"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
</span><span id="__span-43-7"><a id="__codelineno-43-7" name="__codelineno-43-7" href="#__codelineno-43-7"></a><span class="w">    </span><span class="n">kobj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kobject_get</span><span class="p">(</span><span class="o">&amp;</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">kobj</span><span class="p">);</span>
</span><span id="__span-43-8"><a id="__codelineno-43-8" name="__codelineno-43-8" href="#__codelineno-43-8"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">kobj</span><span class="p">)</span>
</span><span id="__span-43-9"><a id="__codelineno-43-9" name="__codelineno-43-9" href="#__codelineno-43-9"></a><span class="w">        </span><span class="n">module_put</span><span class="p">(</span><span class="n">owner</span><span class="p">);</span>
</span><span id="__span-43-10"><a id="__codelineno-43-10" name="__codelineno-43-10" href="#__codelineno-43-10"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">kobj</span><span class="p">;</span>
</span><span id="__span-43-11"><a id="__codelineno-43-11" name="__codelineno-43-11" href="#__codelineno-43-11"></a><span class="p">}</span>
</span></code></pre></div>
</li>
</ul>
<div class="language-c highlight"><span class="filename">linux/kobject.h</span><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">kobject</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="p">;</span>
</span><span id="__span-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">kobject</span><span class="w"> </span><span class="o">*</span><span class="n">parent</span><span class="p">;</span>
</span><span id="__span-44-4"><a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">kset</span><span class="w"> </span><span class="o">*</span><span class="n">kset</span><span class="p">;</span>
</span><span id="__span-44-5"><a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">kobj_type</span><span class="w"> </span><span class="o">*</span><span class="n">ktype</span><span class="p">;</span>
</span><span id="__span-44-6"><a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">sysfs_dirent</span><span class="w"> </span><span class="o">*</span><span class="n">sd</span><span class="p">;</span>
</span><span id="__span-44-7"><a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">kref</span><span class="w"> </span><span class="n">kref</span><span class="p">;</span>
</span><span id="__span-44-8"><a id="__codelineno-44-8" name="__codelineno-44-8" href="#__codelineno-44-8"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">list_head</span><span class="w"> </span><span class="n">entry</span><span class="p">;</span>
</span><span id="__span-44-9"><a id="__codelineno-44-9" name="__codelineno-44-9" href="#__codelineno-44-9"></a><span class="p">};</span>
</span></code></pre></div>
<h2 id="dma">ç¬¬åäº”ç« ï¼šå†…å­˜æ˜ å°„ä¸ DMA<a class="headerlink" href="#dma" title="Permanent link">&para;</a></h2>
<blockquote>
<p>å½“æˆ‘ä»¬è¿›å…¥å¤æ‚å’Œæ€§èƒ½å…³é”®çš„é¢†åŸŸæ—¶ï¼Œè™šæ‹Ÿå†…å­˜ç³»ç»Ÿæ˜¯ Linux å†…æ ¸ä¸­éå¸¸æœ‰è¶£çš„ä¸€éƒ¨åˆ†ã€‚</p>
<p>æœ¬èŠ‚è¦†ç›–ä¸‰ä¸ªéƒ¨åˆ†ï¼š</p>
<ul>
<li><code>mmap()</code> ç³»ç»Ÿè°ƒç”¨å¦‚ä½•å°†è®¾å¤‡çš„å†…å­˜æ˜ å°„åˆ°è¿›ç¨‹ç”¨æˆ·ç©ºé—´</li>
<li><code>get_user_pages()</code> å¦‚ä½•ç›´æ¥è®¿é—®ç”¨æˆ·ç©ºé—´é¡µé¢</li>
<li>DMA</li>
</ul>
</blockquote>
<h3 id="linux_1">Linux å†…å­˜ç®¡ç†<a class="headerlink" href="#linux_1" title="Permanent link">&para;</a></h3>
<p>åœ¨ Linux å†…æ ¸ä¸­ï¼Œåœ¨ä»€ä¹ˆæƒ…å†µä¸‹åº”è¯¥ä½¿ç”¨ä»€ä¹ˆç±»å‹çš„åœ°å€å¹¶ä¸æ€»æ˜¯æ˜¾è€Œæ˜“è§ã€‚</p>
<ul>
<li>ç”¨æˆ·è™šæ‹Ÿåœ°å€</li>
<li>ç‰©ç†åœ°å€</li>
<li>
<p>æ€»çº¿åœ°å€</p>
<p>æœ‰äº›ä½“ç³»ç»“æ„æä¾›äº† IOMMUï¼ˆInput/Output Memory Management Unitï¼‰æ¥å¤„ç†æ€»çº¿åœ°å€åˆ°ç‰©ç†åœ°å€çš„æ˜ å°„ã€‚IOMMU æä¾›è®¸å¤šä¾¿åˆ©ï¼Œæ¯”å¦‚é€šè¿‡åœ°å€é‡æ˜ å°„ï¼Œè®¾å¤‡çœ‹åˆ°çš„åœ°å€ç©ºé—´æ˜¯è¿ç»­çš„ï¼Œä½†æ“ä½œç³»ç»Ÿå¯èƒ½æ— æ³•æ‰¾åˆ°ä¸€å—è¶³å¤Ÿå¤§çš„è¿ç»­ç‰©ç†å†…å­˜ç©ºé—´æ¥æ»¡è¶³éœ€æ±‚ï¼ŒIOMMU å°†è¿™äº›è¿ç»­çš„è®¾å¤‡åœ°å€åŠ¨æ€æ˜ å°„åˆ°å®é™…ç‰©ç†å†…å­˜ä¸­åˆ†æ•£çš„ç¼“å†²åŒºã€‚</p>
<p>IOMMU ç®€åŒ–äº†è®¾å¤‡é©±åŠ¨ç¨‹åºçš„è®¾è®¡ã€‚</p>
</li>
<li>
<p>å†…æ ¸é€»è¾‘åœ°å€</p>
<p>æŸäº›ç‰©ç†åœ°å€æ˜ å°„ä¸ºå†…æ ¸é€»è¾‘åœ°å€ï¼Œå…·æœ‰<strong>å›ºå®šçš„åç§»é‡</strong>ã€‚<code>kmalloc()</code> è¿”å›è¿™ç±»åœ°ï¼Œé€šå¸¸å­˜å‚¨ä¸º <code>unsigned long</code> æˆ– <code>void *</code>ã€‚</p>
</li>
<li>
<p>å†…æ ¸è™šæ‹Ÿåœ°å€</p>
<p>ä¸å†…æ ¸é€»è¾‘åœ°å€ä¸åŒï¼Œä¸ä¸€å®šæ˜¯çº¿æ€§ã€ä¸€å¯¹ä¸€çš„æ˜ å°„ã€‚<code>vmalloc()</code> å’Œ <code>kmap()</code> è¿”å›è¿™ç±»åœ°å€ã€‚</p>
</li>
</ul>
<p><code>&lt;asm/page.h&gt;</code> ä¸€äº›å®ï¼š</p>
<ul>
<li><code>__pa()</code>ï¼šè¿”å›ç‰©ç†åœ°å€</li>
<li><code>__va()</code>ï¼šè¿”å›è™šæ‹Ÿåœ°å€ï¼Œä»…å¯¹ä½åœ°å€æœ‰æ•ˆ</li>
<li><code>PAGE_SIZE</code></li>
<li><code>PAGE_SHIFT</code></li>
</ul>
<div class="admonition info">
<p class="admonition-title">é«˜/ä½å†…å­˜</p>
<p>è§ <a href="https://www.kernel.org/doc/html/v5.18/translations/zh_CN/vm/highmem.html">é«˜å†…å­˜å¤„ç† â€” The Linux Kernel documentation</a>ã€‚</p>
<p>å½“ç‰©ç†å†…å­˜çš„å¤§å°æ¥è¿‘æˆ–è¶…è¿‡è™šæ‹Ÿå†…å­˜çš„æœ€å¤§å¤§å°æ—¶ï¼Œå†…æ ¸ä¸å¯èƒ½åœ¨ä»»ä½•æ—¶å€™éƒ½ä¿æŒæ‰€æœ‰å¯ç”¨çš„ç‰©ç†å†…å­˜çš„æ˜ å°„ã€‚ä¼ ç»Ÿåˆ†é…æ–¹å¼ä¸­ï¼Œè¾ƒä½çš„ä¸€æ®µåœ°å€ç©ºé—´è¢«æ°¸ä¹…æ˜ å°„ï¼Œè€Œè¾ƒé«˜çš„ä¸€æ®µåœ°å€ç©ºé—´åˆ™è¢«åŠ¨æ€æ˜ å°„ã€‚è¿™å°±æ˜¯é«˜ã€ä½å†…å­˜çš„ç”±æ¥ã€‚</p>
<p>æ¯”å¦‚ï¼Œ32 ä½ä½“ç³»ç»“æ„çš„è™šæ‹Ÿå†…å­˜ç©ºé—´ä¸º 4GBï¼Œå¦‚æœç‰©ç†å†…å­˜æœ‰ 8GBï¼Œé‚£ä¹ˆå†…æ ¸å°±æ— æ³•å°†æ‰€æœ‰ç‰©ç†å†…å­˜æ˜ å°„åˆ°è™šæ‹Ÿå†…å­˜ä¸­ã€‚</p>
<p>åœ¨ 64 ä½ä½“ç³»ç»“æ„ä¸Šï¼Œé«˜å†…å­˜ä¸å†æ˜¯é—®é¢˜ï¼Œå¯ç”¨çš„åœ°å€ç©ºé—´è¾¾åˆ°äº† 16EBã€‚</p>
</div>
<p>ä¸‹åˆ—å†…å®¹åœ¨ Linux Kernel Development ä¸­å·²å­¦ä¹ è¿‡ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ï¼š</p>
<ul>
<li>ç‰©ç†å†…å­˜é¡µé¢æ˜ å°„å’Œ <code>struct page</code></li>
<li>é¡µè¡¨</li>
<li>VMA å’Œ <code>struct vm_area_struct</code></li>
<li>è¿›ç¨‹å†…å­˜æ˜ å°„ <code>struct mm_struct</code>ï¼Œ<code>current-&gt;mm</code></li>
</ul>
<h3 id="mmap"><code>mmap()</code> è®¾å¤‡æ“ä½œ<a class="headerlink" href="#mmap" title="Permanent link">&para;</a></h3>
<ul>
<li><code>/proc/*/maps</code></li>
<li><code>/proc/iomem</code></li>
</ul>
<p>ä½¿ç”¨ <code>mmap()</code> çš„å®ä¾‹ï¼š</p>
<ul>
<li>X Server æ˜ å°„æ˜¾å¡çš„æ˜¾å­˜ï¼Œæ¯” <code>lseek()</code>/<code>write()</code> æ›´åŠ é«˜æ•ˆ</li>
<li>PCI è®¾å¤‡å°†æ§åˆ¶å¯„å­˜å™¨æ˜ å°„åˆ°å†…å­˜åœ°å€ï¼Œæ¯” <code>ioctl()</code> æ›´åŠ é«˜æ•ˆ</li>
</ul>
<p>ç³»ç»Ÿè°ƒç”¨ <code>mmap()</code> (2)</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="n">mmap</span><span class="w"> </span><span class="p">(</span><span class="n">caddr_t</span><span class="w"> </span><span class="n">addr</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">len</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">prot</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">flags</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">fd</span><span class="p">,</span><span class="w"> </span><span class="kt">off_t</span><span class="w"> </span><span class="n">offset</span><span class="p">)</span>
</span></code></pre></div>
<p>ä¼šè°ƒç”¨ä½œä¸º <code>file_operations</code> ç»“æ„çš„ä¸€éƒ¨åˆ†çš„ <code>mmap()</code></p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="kt">int</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">mmap</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">file</span><span class="w"> </span><span class="o">*</span><span class="n">filp</span><span class="p">,</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">vm_area_struct</span><span class="w"> </span><span class="o">*</span><span class="n">vma</span><span class="p">);</span>
</span></code></pre></div>
<p>ä½œä¸ºé©±åŠ¨ç¨‹åºçš„å®ç°è€…ï¼Œæˆ‘ä»¬æ”¶åˆ° <code>vma</code>ï¼Œä¸ºç›¸åº”åœ°å€èŒƒå›´æ„å»ºé¡µè¡¨ï¼Œå¹¶è§†æƒ…å†µæä¾› <code>vma-&gt;vm_ops</code> å³å¯ã€‚</p>
<p>æ„å»ºé¡µè¡¨æœ‰ä¸¤ç§æ–¹æ³•ï¼š</p>
<ul>
<li>
<p><code>remap_pfn_range()</code>ã€<code>io_remap_page_range()</code>ï¼šå®ƒä»¬æ¥æ”¶ <code>vma</code>ã€<code>virt_addr</code> å’Œ <code>pfn</code> ç­‰å‚æ•°ï¼Œå»ºç«‹å¯¹åº”çš„æ˜ å°„å…³ç³»ã€‚å‰è€…ç”¨äºå¤„ç†çœŸå®å†…å­˜çš„æ˜ å°„ï¼Œåè€…ç”¨äºå¤„ç†ç‰©ç†åœ°å€ä¸º I/O å†…å­˜çš„æ˜ å°„ã€‚</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">simple_remap_mmap</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">file</span><span class="w"> </span><span class="o">*</span><span class="n">filp</span><span class="p">,</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">vm_area_struct</span><span class="w"> </span><span class="o">*</span><span class="n">vma</span><span class="p">)</span>
</span><span id="__span-47-2"><a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a><span class="p">{</span>
</span><span id="__span-47-3"><a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">remap_pfn_range</span><span class="p">(</span><span class="n">vma</span><span class="p">,</span><span class="w"> </span><span class="n">vma</span><span class="o">-&gt;</span><span class="n">vm_start</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="o">-&gt;</span><span class="n">vm_pgoff</span><span class="p">,</span>
</span><span id="__span-47-4"><a id="__codelineno-47-4" name="__codelineno-47-4" href="#__codelineno-47-4"></a><span class="w">    </span><span class="n">vma</span><span class="o">-&gt;</span><span class="n">vm_end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">vma</span><span class="o">-&gt;</span><span class="n">vm_start</span><span class="p">,</span>
</span><span id="__span-47-5"><a id="__codelineno-47-5" name="__codelineno-47-5" href="#__codelineno-47-5"></a><span class="w">    </span><span class="n">vma</span><span class="o">-&gt;</span><span class="n">vm_page_prot</span><span class="p">))</span>
</span><span id="__span-47-6"><a id="__codelineno-47-6" name="__codelineno-47-6" href="#__codelineno-47-6"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="n">EAGAIN</span><span class="p">;</span>
</span><span id="__span-47-7"><a id="__codelineno-47-7" name="__codelineno-47-7" href="#__codelineno-47-7"></a><span class="w">    </span><span class="n">vma</span><span class="o">-&gt;</span><span class="n">vm_ops</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">simple_remap_vm_ops</span><span class="p">;</span>
</span><span id="__span-47-8"><a id="__codelineno-47-8" name="__codelineno-47-8" href="#__codelineno-47-8"></a><span class="w">    </span><span class="n">simple_vma_open</span><span class="p">(</span><span class="n">vma</span><span class="p">);</span>
</span><span id="__span-47-9"><a id="__codelineno-47-9" name="__codelineno-47-9" href="#__codelineno-47-9"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-47-10"><a id="__codelineno-47-10" name="__codelineno-47-10" href="#__codelineno-47-10"></a><span class="p">}</span>
</span></code></pre></div>
</li>
<li>
<p><code>nopage()</code> é€é¡µæ˜ å°„ï¼Œæ›´åŠ çµæ´»ï¼Œå¸¸ç”¨äºç³»ç»Ÿè°ƒç”¨ <code>mremap()</code>ã€‚å½“ç”¨æˆ·è¿›ç¨‹è®¿é—® VMA ä¸­ä¸å­˜åœ¨äºå†…å­˜ä¸­çš„é¡µé¢æ—¶ï¼Œå°†è°ƒç”¨ <code>nopage()</code>ã€‚</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">simple_nopage_mmap</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">file</span><span class="w"> </span><span class="o">*</span><span class="n">filp</span><span class="p">,</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">vm_area_struct</span><span class="w"> </span><span class="o">*</span><span class="n">vma</span><span class="p">)</span>
</span><span id="__span-48-2"><a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a><span class="p">{</span>
</span><span id="__span-48-3"><a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a><span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vma</span><span class="o">-&gt;</span><span class="n">vm_pgoff</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">PAGE_SHIFT</span><span class="p">;</span>
</span><span id="__span-48-4"><a id="__codelineno-48-4" name="__codelineno-48-4" href="#__codelineno-48-4"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">offset</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">__pa</span><span class="p">(</span><span class="n">high_memory</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="n">filp</span><span class="o">-&gt;</span><span class="n">f_flags</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">O_SYNC</span><span class="p">))</span>
</span><span id="__span-48-5"><a id="__codelineno-48-5" name="__codelineno-48-5" href="#__codelineno-48-5"></a><span class="w">    </span><span class="n">vma</span><span class="o">-&gt;</span><span class="n">vm_flags</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="n">VM_IO</span><span class="p">;</span>
</span><span id="__span-48-6"><a id="__codelineno-48-6" name="__codelineno-48-6" href="#__codelineno-48-6"></a><span class="w">    </span><span class="n">vma</span><span class="o">-&gt;</span><span class="n">vm_flags</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="n">VM_RESERVED</span><span class="p">;</span>
</span><span id="__span-48-7"><a id="__codelineno-48-7" name="__codelineno-48-7" href="#__codelineno-48-7"></a><span class="w">    </span><span class="n">vma</span><span class="o">-&gt;</span><span class="n">vm_ops</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">simple_nopage_vm_ops</span><span class="p">;</span>
</span><span id="__span-48-8"><a id="__codelineno-48-8" name="__codelineno-48-8" href="#__codelineno-48-8"></a><span class="w">    </span><span class="n">simple_vma_open</span><span class="p">(</span><span class="n">vma</span><span class="p">);</span>
</span><span id="__span-48-9"><a id="__codelineno-48-9" name="__codelineno-48-9" href="#__codelineno-48-9"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-48-10"><a id="__codelineno-48-10" name="__codelineno-48-10" href="#__codelineno-48-10"></a><span class="p">}</span>
</span></code></pre></div>
<p>ç›¸åº” <code>vm_operations_struct</code> ä¸­çš„ <code>nopage()</code> ç›´æ¥æ“ä½œå†…å­˜é¡µé¢è®¡æ•°ï¼š</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">page</span><span class="w"> </span><span class="o">*</span><span class="n">simple_vma_nopage</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">vm_area_struct</span><span class="w"> </span><span class="o">*</span><span class="n">vma</span><span class="p">,</span>
</span><span id="__span-49-2"><a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">address</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">type</span><span class="p">)</span>
</span><span id="__span-49-3"><a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a><span class="p">{</span>
</span><span id="__span-49-4"><a id="__codelineno-49-4" name="__codelineno-49-4" href="#__codelineno-49-4"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">page</span><span class="w"> </span><span class="o">*</span><span class="n">pageptr</span><span class="p">;</span>
</span><span id="__span-49-5"><a id="__codelineno-49-5" name="__codelineno-49-5" href="#__codelineno-49-5"></a><span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vma</span><span class="o">-&gt;</span><span class="n">vm_pgoff</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">PAGE_SHIFT</span><span class="p">;</span>
</span><span id="__span-49-6"><a id="__codelineno-49-6" name="__codelineno-49-6" href="#__codelineno-49-6"></a><span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">physaddr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">vma</span><span class="o">-&gt;</span><span class="n">vm_start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">offset</span><span class="p">;</span>
</span><span id="__span-49-7"><a id="__codelineno-49-7" name="__codelineno-49-7" href="#__codelineno-49-7"></a><span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">pageframe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">physaddr</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">PAGE_SHIFT</span><span class="p">;</span>
</span><span id="__span-49-8"><a id="__codelineno-49-8" name="__codelineno-49-8" href="#__codelineno-49-8"></a>
</span><span id="__span-49-9"><a id="__codelineno-49-9" name="__codelineno-49-9" href="#__codelineno-49-9"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">pfn_valid</span><span class="p">(</span><span class="n">pageframe</span><span class="p">))</span>
</span><span id="__span-49-10"><a id="__codelineno-49-10" name="__codelineno-49-10" href="#__codelineno-49-10"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">NOPAGE_SIGBUS</span><span class="p">;</span>
</span><span id="__span-49-11"><a id="__codelineno-49-11" name="__codelineno-49-11" href="#__codelineno-49-11"></a><span class="w">    </span><span class="n">pageptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pfn_to_page</span><span class="p">(</span><span class="n">pageframe</span><span class="p">);</span>
</span><span id="__span-49-12"><a id="__codelineno-49-12" name="__codelineno-49-12" href="#__codelineno-49-12"></a><span class="w">    </span><span class="n">get_page</span><span class="p">(</span><span class="n">pageptr</span><span class="p">);</span>
</span><span id="__span-49-13"><a id="__codelineno-49-13" name="__codelineno-49-13" href="#__codelineno-49-13"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="p">)</span>
</span><span id="__span-49-14"><a id="__codelineno-49-14" name="__codelineno-49-14" href="#__codelineno-49-14"></a><span class="w">        </span><span class="o">*</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VM_FAULT_MINOR</span><span class="p">;</span>
</span><span id="__span-49-15"><a id="__codelineno-49-15" name="__codelineno-49-15" href="#__codelineno-49-15"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">pageptr</span><span class="p">;</span>
</span><span id="__span-49-16"><a id="__codelineno-49-16" name="__codelineno-49-16" href="#__codelineno-49-16"></a><span class="p">}</span>
</span></code></pre></div>
</li>
</ul>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œè®¾å¤‡å†…å­˜ä¸åº”è¯¥è¢« cacheï¼Œè§ <code>pgprot_noncached</code>ã€‚</p>
<div class="admonition todo">
<p class="admonition-title">é‡æ˜ å°„ç« èŠ‚</p>
</div>
<h3 id="io_3">æ‰§è¡Œç›´æ¥ I/O<a class="headerlink" href="#io_3" title="Permanent link">&para;</a></h3>
<p>å¤§å¤šæ•° I/O æ“ä½œéƒ½è¢«å†…æ ¸ç¼“å­˜ã€‚</p>
<p>å®ç°ç›´æ¥ I/O çš„å…³é”®åœ¨äº <code>get_user_pages()</code>ï¼š</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="kt">int</span><span class="w"> </span><span class="nf">get_user_pages</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">task_struct</span><span class="w"> </span><span class="o">*</span><span class="n">tsk</span><span class="p">,</span>
</span><span id="__span-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">mm_struct</span><span class="w"> </span><span class="o">*</span><span class="n">mm</span><span class="p">,</span>
</span><span id="__span-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a><span class="w">    </span><span class="c1">// ç”¨æˆ·ç©ºé—´ç¼“å†²åŒºèµ·å§‹åœ°å€å’Œé•¿åº¦ï¼ˆæŒ‰é¡µå¯¹é½ï¼‰</span>
</span><span id="__span-50-4"><a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a><span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">start</span><span class="p">,</span>
</span><span id="__span-50-5"><a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">len</span><span class="p">,</span>
</span><span id="__span-50-6"><a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a><span class="w">    </span><span class="c1">// æƒé™</span>
</span><span id="__span-50-7"><a id="__codelineno-50-7" name="__codelineno-50-7" href="#__codelineno-50-7"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">write</span><span class="p">,</span>
</span><span id="__span-50-8"><a id="__codelineno-50-8" name="__codelineno-50-8" href="#__codelineno-50-8"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">force</span><span class="p">,</span>
</span><span id="__span-50-9"><a id="__codelineno-50-9" name="__codelineno-50-9" href="#__codelineno-50-9"></a><span class="w">    </span><span class="c1">// è¿”å› pin åœ¨å†…å­˜ä¸­çš„é¡µé¢</span>
</span><span id="__span-50-10"><a id="__codelineno-50-10" name="__codelineno-50-10" href="#__codelineno-50-10"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">page</span><span class="w"> </span><span class="o">**</span><span class="n">pages</span><span class="p">,</span>
</span><span id="__span-50-11"><a id="__codelineno-50-11" name="__codelineno-50-11" href="#__codelineno-50-11"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">vm_area_struct</span><span class="w"> </span><span class="o">**</span><span class="n">vmas</span><span class="p">);</span>
</span></code></pre></div>
<p>2.6 å¼•å…¥äº†å¼‚æ­¥ I/Oï¼Œç”¨æˆ·ç©ºé—´å¯ä»¥å‘èµ· I/O è€Œæ— éœ€ç­‰å¾…ã€‚é©±åŠ¨ç¨‹åºå¯ä»¥é€‰æ‹©æ˜¯å¦æ”¯æŒå¼‚æ­¥ I/Oã€‚å…¶ä¸­ï¼Œå—è®¾å¤‡å’Œç½‘ç»œè®¾å¤‡çš„ I/O æ€»æ˜¯å¼‚æ­¥çš„ï¼Œç”±å†…æ ¸ä¸­æ›´é«˜å±‚æ¬¡çš„ä»£ç æä¾›æ”¯æŒï¼ˆè®¾ç½®ç¼“å†²åŒºç­‰ï¼‰ï¼Œé©±åŠ¨ç¨‹åºä¸éœ€è¦ç®¡ã€‚è§ <code>linux/aio.h</code>ã€‚</p>
<h3 id="dma_1">DMA<a class="headerlink" href="#dma_1" title="Permanent link">&para;</a></h3>
<p>å¤–å›´è®¾å¤‡å¯ä»¥é€šè¿‡ DMA å‘å†…å­˜ä¼ è¾“æ•°æ®ï¼Œå¤„ç†å™¨æ— éœ€å‚ä¸ã€‚</p>
<p>ä¸¤ç§è¾“å…¥æ–¹å¼ï¼š</p>
<ul>
<li>
<p>ç¨‹åºè¯·æ±‚ï¼š</p>
<ol>
<li><code>read()</code> è°ƒç”¨ï¼Œé©±åŠ¨ç¨‹åºåˆ†é… DMA ç¼“å†²ï¼Œä»¤ç¡¬ä»¶å‘ç¼“å†²åŒºå†™å…¥ï¼Œè¿›ç¨‹ä¼‘çœ ã€‚</li>
<li>ç¡¬ä»¶å‘ç¼“å†²åŒºå†™å…¥ï¼Œå®Œæˆæ—¶å‘èµ·ä¸­æ–­ã€‚</li>
<li>ä¸­æ–­å¤„ç†ç¨‹åºè·å¾—æ•°æ®ï¼Œå”¤é†’è¿›ç¨‹ã€‚</li>
</ol>
</li>
<li>
<p>ç¡¬ä»¶å¼‚æ­¥æ¨é€ï¼ˆå¼‚æ­¥ä½¿ç”¨ DMAï¼‰ï¼š</p>
<ol>
<li>ç¡¬ä»¶å‘èµ·ä¸­æ–­ï¼Œå‘ŠçŸ¥æ–°æ•°æ®åˆ°è¾¾ã€‚</li>
<li>ä¸­æ–­å¤„ç†ç¨‹åºåˆ†é…ç¼“å†²åŒºï¼Œå‘ŠçŸ¥ç¡¬ä»¶ä¼ è¾“æ•°æ®ã€‚</li>
<li>ç¡¬ä»¶å‘ç¼“å†²åŒºå†™å…¥ï¼Œå®Œæˆæ—¶å‘èµ·ä¸­æ–­ã€‚</li>
<li>ä¸­æ–­å¤„ç†ç¨‹åºè·å¾—æ•°æ®ï¼Œå”¤é†’è¿›ç¨‹ï¼Œç®¡ç†ç°¿è®°ã€‚</li>
</ol>
</li>
</ul>
<p>ä»¥ç½‘å¡ä¸ºä¾‹ï¼šç½‘å¡ä½¿ç”¨ DMA ring bufferï¼Œæ”¶åˆ°çš„åŒ…æ”¾åœ¨ä¸‹ä¸€ä¸ªå¯ç”¨çš„ buffer ä¸­ï¼Œå¹¶å‘èµ·ä¸­æ–­ï¼Œç”±é©±åŠ¨ç¨‹åºå°†åŒ…ä¼ é€’ç»™å†…æ ¸å…¶ä»–éƒ¨åˆ†ï¼Œå¹¶æ”¾ç½®æ–°çš„ DMA bufferã€‚</p>
<h4 id="dma_2">åˆ†é… DMA ç¼“å†²åŒº<a class="headerlink" href="#dma_2" title="Permanent link">&para;</a></h4>
<p>éœ€è¦è€ƒè™‘è®¾å¤‡èƒ½å¤„ç†çš„åœ°å€èŒƒå›´ï¼Œä½¿ç”¨ <code>GFP_DMA</code> ä» <code>kmalloc()</code> æˆ– <code>get_free_pages()</code> è°ƒç”¨ä¸­è·å¾— DMA åŒºåŸŸçš„é¡µé¢ã€‚</p>
<p>è¦æ±‚ä¸ºè¿ç»­ç‰©ç†é¡µï¼Œå› ä¸ºè®¾å¤‡åœ¨æ€»çº¿ä¸Šä½¿ç”¨ç‰©ç†åœ°å€ä¼ è¾“ã€‚ç„¶è€Œéšç€ç³»ç»Ÿè¿è¡Œï¼Œå†…å­˜é€æ¸ç¢ç‰‡åŒ–ã€‚æœ‰å‡ ç§æ–¹æ³•ï¼š</p>
<ul>
<li>å¯åŠ¨æ—¶ä½¿ç”¨ <code>mem=</code> å†…æ ¸å‚æ•°é™åˆ¶å†…æ ¸ä½¿ç”¨çš„å†…å­˜èŒƒå›´ï¼Œå‰©ä½™çš„é«˜å†…å­˜å³å¯è¢«é©±åŠ¨ç¨‹åºä½œä¸ºç¼“å†²åŒºã€‚</li>
<li>ä½¿ç”¨ <code>GFP_NOFAIL</code> é€‰é¡¹åˆ†é…å†…å­˜ï¼Œä½†ä¼šç»™ç³»ç»Ÿå¸¦æ¥å‹åŠ›ï¼Œå¯èƒ½å¯¼è‡´ç³»ç»Ÿé”æ­»ã€‚</li>
<li>å¦‚æœè®¾å¤‡æ”¯æŒ<strong>æ•£å°„/èšé›†ï¼ˆscatter/gatherï¼‰I/O</strong>ï¼Œåˆ™å¯ä»¥å°†ç¼“å†²åŒºåˆ†ä¸ºå¤šä¸ªéƒ¨åˆ†ã€‚</li>
</ul>
<h4 id="dma_3">é€šç”¨ DMA å±‚<a class="headerlink" href="#dma_3" title="Permanent link">&para;</a></h4>
<p>ä¸¥æ ¼æ¥è¯´ï¼Œè®¾å¤‡ä½¿ç”¨çš„æ˜¯æ€»çº¿åœ°å€è€Œéç‰©ç†åœ°å€ï¼Œåœ¨æŸäº›å¹³å°ä¸Šè¿™ä¸¤ä¸ªåœ°å€é—´æœ‰æ˜ å°„å…³ç³»ã€‚è¦ç¼–å†™ä¸€ä¸ªé€šç”¨çš„é©±åŠ¨ç¨‹åºæ˜¯ä¸€ä»¶å¤æ‚çš„äº‹æƒ…ï¼Œå› æ­¤ Linux æä¾›äº†é€šç”¨ DMA å±‚ï¼Œä¸æ€»çº¿å’Œæ¶æ„æ— å…³ã€‚</p>
<div class="admonition todo">
<p class="admonition-title">æœªå®Œæˆ</p>
</div>
<h2 id="_38">ç¬¬åä¸ƒç« ï¼šç½‘ç»œé©±åŠ¨<a class="headerlink" href="#_38" title="Permanent link">&para;</a></h2>
<p>ä¸ä¸Šä¸€èŠ‚çš„å—è®¾å¤‡ç›¸æ¯”ï¼Œç½‘ç»œè®¾å¤‡æœ‰å‡ ä¸ªä¸åŒï¼š</p>
<ul>
<li>
<p>åœ¨ <code>/dev</code> ä¸‹æ²¡æœ‰å¯¹åº”çš„æ–‡ä»¶ã€‚å¯¹äºç½‘ç»œè®¾å¤‡æ¥è¯´ï¼Œæ–‡ä»¶æ“ä½œæ²¡æœ‰æ„ä¹‰ã€‚</p>
<p>å°½ç®¡ Socket ä»ç„¶ä½¿ç”¨ <code>read/write</code> æ“ä½œï¼Œä½† Socket æ˜¯è½¯ä»¶å±‚é¢çš„å¯¹è±¡ã€‚</p>
<p>å› æ­¤ï¼Œç½‘ç»œè®¾å¤‡å­˜åœ¨è‡ªå·±çš„å‘½åç©ºé—´ï¼Œæä¾›å¦ä¸€å¥—æ“ä½œã€‚</p>
</li>
<li>
<p>å—è®¾å¤‡<strong>è¢«åŠ¨åœ°</strong>æ¥å—å†…æ ¸çš„è¯·æ±‚ï¼Œè€Œç½‘ç»œè®¾å¤‡<strong>ä¸»åŠ¨åœ°</strong>å‘å†…æ ¸å‘é€æ•°æ®ã€‚</p>
</li>
</ul>
<p>Linux ç½‘ç»œå­ç³»ç»Ÿè¢«è®¾è®¡ä¸ºä¸åè®®æ— å…³ã€‚</p>
<h3 id="snull"><code>snull</code> çš„è®¾è®¡<a class="headerlink" href="#snull" title="Permanent link">&para;</a></h3>
<p>ç•¥</p>
<h3 id="_39">è¿æ¥åˆ°å†…æ ¸<a class="headerlink" href="#_39" title="Permanent link">&para;</a></h3>
<p>ä½œè€…å»ºè®®é˜…è¯»å†…æ ¸æºç çš„é¡ºåºï¼š</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a>loopback.c
</span><span id="__span-51-2"><a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a>plip.c
</span><span id="__span-51-3"><a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a>e100.c
</span></code></pre></div>
<h4 id="_40">è®¾å¤‡æ³¨å†Œ<a class="headerlink" href="#_40" title="Permanent link">&para;</a></h4>
<p>ä¸å—è®¾å¤‡å’Œå­—ç¬¦è®¾å¤‡ä¸åŒï¼Œç½‘ç»œè®¾å¤‡<strong>ä¸éœ€è¦è®¾å¤‡å·ï¼Œè€Œæ˜¯å‘å…¨å±€ç½‘ç»œè®¾å¤‡åˆ—è¡¨ä¸­æ’å…¥æ–°çš„æ¥å£</strong>ã€‚æ¯ä¸ªæ¥å£ç”¨ <code>struct net_device</code> ç»“æ„è¡¨ç¤ºï¼Œä¸å…¶ä»–å†…æ ¸å¯¹è±¡ä¸€æ ·ä½¿ç”¨å¼•ç”¨è®¡æ•°æ¥ç®¡ç†ã€‚è¯¥ç»“æ„é€šè¿‡ <code>netdev_alloc()</code> åˆ†é…ã€‚</p>
<div class="language-c highlight"><span class="filename">linux/netdevice.h</span><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">net_device</span><span class="w"> </span><span class="o">*</span><span class="n">alloc_netdev</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">sizeof_priv</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="p">,</span>
</span><span id="__span-52-2"><a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">setup</span><span class="p">)(</span><span class="k">struct</span><span class="w"> </span><span class="nc">net_device</span><span class="w"> </span><span class="o">*</span><span class="p">));</span>
</span></code></pre></div>
<p>å…¶ä¸­ <code>sizeof_priv</code> æ˜¯ç§æœ‰æ•°æ®çš„å¤§å°ã€‚</p>
<p>å®Œæˆè®¾å¤‡åˆ›å»ºå’Œåˆå§‹åŒ–åï¼Œå°†å…¶ä¼ é€’ç»™ <code>register_netdev()</code> å³å¯ã€‚</p>
<h4 id="_41">è®¾å¤‡åˆå§‹åŒ–<a class="headerlink" href="#_41" title="Permanent link">&para;</a></h4>
<p><code>ether_setup()</code> åˆå§‹åŒ–ä»¥å¤ªç½‘è®¾å¤‡çš„é»˜è®¤å€¼ï¼Œä¸€èˆ¬å…ˆç”¨å®ƒåˆå§‹åŒ–ï¼š</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="n">ether_setup</span><span class="p">(</span><span class="n">dev</span><span class="p">);</span>
</span><span id="__span-53-2"><a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a><span class="n">dev</span><span class="o">-&gt;</span><span class="n">open</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snull_open</span><span class="p">;</span>
</span><span id="__span-53-3"><a id="__codelineno-53-3" name="__codelineno-53-3" href="#__codelineno-53-3"></a><span class="n">dev</span><span class="o">-&gt;</span><span class="n">flags</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="n">IFF_NOARP</span><span class="p">;</span>
</span></code></pre></div>
<p>è®¿é—®ç§æœ‰æ•°æ®ä½¿ç”¨ <code>netdev_priv()</code>ï¼š</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">snull_priv</span><span class="w"> </span><span class="o">*</span><span class="n">priv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">netdev_priv</span><span class="p">(</span><span class="n">dev</span><span class="p">);</span>
</span></code></pre></div>
<h4 id="_42">æ¨¡å—å¸è½½<a class="headerlink" href="#_42" title="Permanent link">&para;</a></h4>
<p>å–æ¶ˆæ³¨å†Œï¼Œé‡Šæ”¾è®¾å¤‡ç»“æ„ï¼š</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a><span class="n">unregister_netdev</span><span class="p">(</span><span class="n">dev</span><span class="p">);</span>
</span><span id="__span-55-2"><a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a><span class="n">snull_teardown_pool</span><span class="p">(</span><span class="n">dev</span><span class="p">);</span>
</span><span id="__span-55-3"><a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a><span class="n">free_netdev</span><span class="p">(</span><span class="n">dev</span><span class="p">);</span>
</span></code></pre></div>
<p><code>free_netdev()</code> åå¯èƒ½ä»ç„¶å­˜åœ¨ï¼ˆå¼•ç”¨è®¡æ•°ï¼‰ï¼Œä½†é©±åŠ¨ä¸å…³å¿ƒã€‚</p>
<h3 id="net_device"><code>net_device</code> ç»“æ„è¯¦è§£<a class="headerlink" href="#net_device" title="Permanent link">&para;</a></h3>
<p>ç•¥</p>
<h4 id="_43">è®¾å¤‡æ–¹æ³•<a class="headerlink" href="#_43" title="Permanent link">&para;</a></h4>
<p>åŸºç¡€æ–¹æ³•ï¼š</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-56-1"><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a><span class="n">open</span><span class="p">(</span><span class="n">dev</span><span class="p">);</span>
</span><span id="__span-56-2"><a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a><span class="n">stop</span><span class="p">(</span><span class="n">dev</span><span class="p">);</span>
</span><span id="__span-56-3"><a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a><span class="n">hard_start_xmit</span><span class="p">(</span><span class="n">skb</span><span class="p">,</span><span class="w"> </span><span class="n">dev</span><span class="p">);</span><span class="w"> </span><span class="c1">// å‘èµ·åŒ…ä¼ è¾“</span>
</span><span id="__span-56-4"><a id="__codelineno-56-4" name="__codelineno-56-4" href="#__codelineno-56-4"></a><span class="n">hard_header</span><span class="p">(</span><span class="n">skb</span><span class="p">,</span><span class="w"> </span><span class="n">dev</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">saddr</span><span class="p">,</span><span class="w"> </span><span class="n">len</span><span class="p">);</span>
</span><span id="__span-56-5"><a id="__codelineno-56-5" name="__codelineno-56-5" href="#__codelineno-56-5"></a><span class="n">rebuild_header</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>
</span><span id="__span-56-6"><a id="__codelineno-56-6" name="__codelineno-56-6" href="#__codelineno-56-6"></a><span class="n">tx_timeout</span><span class="p">(</span><span class="n">dev</span><span class="p">);</span>
</span><span id="__span-56-7"><a id="__codelineno-56-7" name="__codelineno-56-7" href="#__codelineno-56-7"></a><span class="n">get_stats</span><span class="p">(</span><span class="n">dev</span><span class="p">);</span>
</span><span id="__span-56-8"><a id="__codelineno-56-8" name="__codelineno-56-8" href="#__codelineno-56-8"></a><span class="n">set_config</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span><span class="w"> </span><span class="n">map</span><span class="p">);</span>
</span></code></pre></div>
<ul>
<li><code>skb</code> æ˜¯ Socket buffer</li>
</ul>
<p>å¯é€‰æ–¹æ³•ï¼š</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-57-1"><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a><span class="n">weight</span><span class="p">;</span>
</span><span id="__span-57-2"><a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a><span class="n">poll</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span><span class="w"> </span><span class="n">quota</span><span class="p">);</span>
</span><span id="__span-57-3"><a id="__codelineno-57-3" name="__codelineno-57-3" href="#__codelineno-57-3"></a><span class="n">poll_controller</span><span class="p">(</span><span class="n">dev</span><span class="p">);</span>
</span><span id="__span-57-4"><a id="__codelineno-57-4" name="__codelineno-57-4" href="#__codelineno-57-4"></a><span class="n">do_ioctl</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span><span class="w"> </span><span class="n">ifr</span><span class="p">,</span><span class="w"> </span><span class="n">cmd</span><span class="p">);</span>
</span><span id="__span-57-5"><a id="__codelineno-57-5" name="__codelineno-57-5" href="#__codelineno-57-5"></a><span class="n">set_multicast_list</span><span class="p">(</span><span class="n">dev</span><span class="p">);</span>
</span><span id="__span-57-6"><a id="__codelineno-57-6" name="__codelineno-57-6" href="#__codelineno-57-6"></a><span class="n">set_mac_address</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span><span class="w"> </span><span class="n">addr</span><span class="p">);</span>
</span><span id="__span-57-7"><a id="__codelineno-57-7" name="__codelineno-57-7" href="#__codelineno-57-7"></a><span class="n">change_mtu</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span><span class="w"> </span><span class="n">new_mtu</span><span class="p">);</span>
</span><span id="__span-57-8"><a id="__codelineno-57-8" name="__codelineno-57-8" href="#__codelineno-57-8"></a><span class="n">header_cache</span><span class="p">(</span><span class="n">neigh</span><span class="p">,</span><span class="w"> </span><span class="n">hh</span><span class="p">);</span>
</span><span id="__span-57-9"><a id="__codelineno-57-9" name="__codelineno-57-9" href="#__codelineno-57-9"></a><span class="n">header_cache_update</span><span class="p">(</span><span class="n">hh</span><span class="p">,</span><span class="w"> </span><span class="n">dev</span><span class="p">,</span><span class="w"> </span><span class="n">haddr</span><span class="p">);</span>
</span><span id="__span-57-10"><a id="__codelineno-57-10" name="__codelineno-57-10" href="#__codelineno-57-10"></a><span class="n">hard_header_parse</span><span class="p">(</span><span class="n">skb</span><span class="p">,</span><span class="w"> </span><span class="n">haddr</span><span class="p">);</span>
</span></code></pre></div>
<h4 id="_44">è¾…åŠ©å­—æ®µ<a class="headerlink" href="#_44" title="Permanent link">&para;</a></h4>
<p>ç•¥</p>
<h3 id="_45">æ‰“å¼€ä¸å…³é—­<a class="headerlink" href="#_45" title="Permanent link">&para;</a></h3>
<p>ä½¿ç”¨ <code>ifconfig</code> ä¸ºç½‘ç»œæ¥å£è®¾ç½®åœ°å€æ—¶ï¼Œæœ‰ä¸¤é¡¹ä»»åŠ¡ï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>ioctl(SIOCSIFADDR)</code> è®¾ç½®åœ°å€ï¼šæ²¡æœ‰é©±åŠ¨ç¨‹åºçš„å‚ä¸ï¼Œç”±å†…æ ¸æ‰§è¡Œã€‚</li>
<li>ä½¿ç”¨ <code>ioctl(SIOCSIFFLAGS)</code> è®¾ç½®æ ‡å¿— <code>IFF_UP</code>ï¼šé©±åŠ¨ç¨‹åºå‚ä¸ï¼Œè°ƒç”¨ <code>open()</code>ã€‚<ul>
<li>å’Œå…¶ä»–è®¾å¤‡ä¸€æ ·ï¼Œè¯·æ±‚å„ç±»èµ„æºï¼ˆ<code>requiest_region()</code> ç­‰ï¼‰ã€‚</li>
<li>ä»è®¾å¤‡æ‹·è´ç¡¬ä»¶åœ°å€ï¼ˆMACï¼‰åˆ° <code>dev-&gt;dev_addr</code>ã€‚</li>
<li>å¯åŠ¨æ¥å£çš„ä¼ è¾“é˜Ÿåˆ—ï¼Œé€šè¿‡ <code>netif_start_queue()</code> å®ç°ã€‚</li>
</ul>
</li>
</ul>
<p>å…³é—­ç«¯å£æ—¶ï¼Œè°ƒç”¨ <code>stop()</code>ã€‚</p>
<h3 id="_46">åŒ…ä¼ è¾“<a class="headerlink" href="#_46" title="Permanent link">&para;</a></h3>
<div class="admonition todo">
<p class="admonition-title">æœªå®Œæˆ</p>
</div>
<h3 id="_47">æ›´æ”¹é“¾è·¯çŠ¶æ€<a class="headerlink" href="#_47" title="Permanent link">&para;</a></h3>
<p>ç‰©ç†ä¸Šçš„è¿æ¥æä¾› carrier çŠ¶æ€ï¼Œè¡¨æ˜ç¡¬ä»¶å­˜åœ¨ã€‚</p>
<p>é©±åŠ¨ç¨‹åºæ£€æµ‹åˆ° carrier çŠ¶æ€å˜åŒ–æ—¶ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„æ¥å£æ”¹å˜é“¾è·¯çŠ¶æ€ï¼š</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-58-1"><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a><span class="kt">void</span><span class="w"> </span><span class="nf">netif_carrier_on</span><span class="p">(</span><span class="n">dev</span><span class="p">);</span>
</span><span id="__span-58-2"><a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a><span class="kt">void</span><span class="w"> </span><span class="nf">netif_carrier_off</span><span class="p">(</span><span class="n">dev</span><span class="p">);</span>
</span><span id="__span-58-3"><a id="__codelineno-58-3" name="__codelineno-58-3" href="#__codelineno-58-3"></a><span class="kt">int</span><span class="w"> </span><span class="nf">netif_carrier_ok</span><span class="p">(</span><span class="n">dev</span><span class="p">);</span><span class="w"> </span><span class="c1">// test</span>
</span></code></pre></div>
<h4 id="rtnl">è¡¥å……å†…å®¹ï¼šRTNL<a class="headerlink" href="#rtnl" title="Permanent link">&para;</a></h4>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<ul>
<li><a href="https://netdevconf.info/2.2/papers/westphal-rtnlmutex-talk.pdf">RTNL mutex, the network stack big kernel lock - RedHat</a></li>
</ul>
</div>
<p>rtnetlink æ˜¯ netlink å­ç³»ç»Ÿä¹‹ä¸€ï¼Œè‡ª Linux 2.2 åŠ å…¥å†…æ ¸ï¼Œç”¨äºå¤„ç†ç½‘ç»œç›¸å…³çš„é…ç½®ã€‚</p>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="June 27, 2025 08:26:17 UTC">June 27, 2025</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../%E5%90%AF%E5%8A%A8%E8%BF%87%E7%A8%8B/" class="md-footer__link md-footer__link--prev" aria-label="Previous: å¯åŠ¨è¿‡ç¨‹">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                å¯åŠ¨è¿‡ç¨‹
              </div>
            </div>
          </a>
        
        
          
          <a href="../%F0%9F%93%96%20Linux%20Kernel%20Development%20%283rd%29/" class="md-footer__link md-footer__link--next" aria-label="Next: ğŸ“– Linux Kernel Development (3rd)">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                ğŸ“– Linux Kernel Development (3rd)
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      <a href="https://beian.miit.gov.cn/" target="_blank">æµ™ICPå¤‡2022036274å·-1</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://bowling233.com" target="_blank" rel="noopener" title="bowling233.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19.07 4.93C17.22 3 14.66 1.96 12 2c-2.66-.04-5.21 1-7.06 2.93C3 6.78 1.96 9.34 2 12c-.04 2.66 1 5.21 2.93 7.06C6.78 21 9.34 22.04 12 22c2.66.04 5.21-1 7.06-2.93C21 17.22 22.04 14.66 22 12c.04-2.66-1-5.22-2.93-7.07M17 12v6h-3.5v-5h-3v5H7v-6H5l7-7 7.5 7H17Z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "content.code.select", "content.code.annotate", "navigation.footer", "navigation.tabs", "navigation.sections", "navigation.expand", "navigation.indexes", "navigation.tracking", "navigation.path", "navigation.top", "toc.follow", "content.action.edit", "search.suggest", "search.highlight", "search.share"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.1e8ae164.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.alicdn.com/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://unpkg.com/tablesort/dist/tablesort.min.js"></script>
      
        <script src="../../../javascripts/tablesort.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>